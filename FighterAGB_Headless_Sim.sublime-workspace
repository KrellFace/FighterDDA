{
	"auto_complete":
	{
		"selected_items":
		[
		]
	},
	"buffers":
	[
		{
			"file": "fighterAGB_headless_sim.js",
			"settings":
			{
				"buffer_size": 3499,
				"encoding": "UTF-8",
				"line_ending": "Windows"
			},
			"undo_stack":
			[
				[
					64,
					1,
					"insert",
					{
						"characters": "MULTI_"
					},
					"BgAAAG8LAQAAAAAAcAsBAAAAAAAAAAAAcAsBAAAAAABxCwEAAAAAAAAAAABxCwEAAAAAAHILAQAAAAAAAAAAAHILAQAAAAAAcwsBAAAAAAAAAAAAcwsBAAAAAAB0CwEAAAAAAAAAAAB0CwEAAAAAAHULAQAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbwsBAAAAAABvCwEAAAAAAAAAAAAAAPC/"
				],
				[
					67,
					1,
					"left_delete",
					null,
					"CgAAAMALAQAAAAAAwAsBAAAAAAABAAAALr8LAQAAAAAAvwsBAAAAAAABAAAAc74LAQAAAAAAvgsBAAAAAAABAAAAdL0LAQAAAAAAvQsBAAAAAAABAAAAbrwLAQAAAAAAvAsBAAAAAAABAAAAYbsLAQAAAAAAuwsBAAAAAAABAAAAdLoLAQAAAAAAugsBAAAAAAABAAAAc7kLAQAAAAAAuQsBAAAAAAABAAAAbrgLAQAAAAAAuAsBAAAAAAABAAAAb7cLAQAAAAAAtwsBAAAAAAABAAAAQw",
					"AQAAAAAAAAABAAAAwQsBAAAAAADBCwEAAAAAAAAAAAAAAPC/"
				],
				[
					72,
					1,
					"left_delete",
					null,
					"CgAAAAIMAQAAAAAAAgwBAAAAAAABAAAALgEMAQAAAAAAAQwBAAAAAAABAAAAcwAMAQAAAAAAAAwBAAAAAAABAAAAdP8LAQAAAAAA/wsBAAAAAAABAAAAbv4LAQAAAAAA/gsBAAAAAAABAAAAYf0LAQAAAAAA/QsBAAAAAAABAAAAdPwLAQAAAAAA/AsBAAAAAAABAAAAc/sLAQAAAAAA+wsBAAAAAAABAAAAbvoLAQAAAAAA+gsBAAAAAAABAAAAb/kLAQAAAAAA+QsBAAAAAAABAAAAQw",
					"AQAAAAAAAAABAAAAAwwBAAAAAAADDAEAAAAAAAAAAAAAAPC/"
				],
				[
					82,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BgAAAAsBAAAAAAAADAEAAAAAAAAAAAAADAEAAAAAAAANAQAAAAAAAAAAAAANAQAAAAAAAA4BAAAAAAAAAAAAAA4BAAAAAAAADwEAAAAAAAAAAAAADwEAAAAAAAAQAQAAAAAAAAAAAAAQAQAAAAAAABEBAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAACwEAAAAAAAALAQAAAAAAAAAAAAAAAPC/"
				],
				[
					83,
					1,
					"insert",
					{
						"characters": " AIPlayer"
					},
					"CQAAABEBAAAAAAAAEgEAAAAAAAAAAAAAEgEAAAAAAAATAQAAAAAAAAAAAAATAQAAAAAAABQBAAAAAAAAAAAAABQBAAAAAAAAFQEAAAAAAAAAAAAAFQEAAAAAAAAWAQAAAAAAAAAAAAAWAQAAAAAAABcBAAAAAAAAAAAAABcBAAAAAAAAGAEAAAAAAAAAAAAAGAEAAAAAAAAZAQAAAAAAAAAAAAAZAQAAAAAAABoBAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAEQEAAAAAAAARAQAAAAAAAAAAAAAAAPC/"
				],
				[
					84,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAABoBAAAAAAAAGwEAAAAAAAAAAAAAGwEAAAAAAAAcAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGgEAAAAAAAAaAQAAAAAAAAAAAAAAAPC/"
				],
				[
					85,
					1,
					"insert",
					{
						"characters": " require"
					},
					"CAAAABwBAAAAAAAAHQEAAAAAAAAAAAAAHQEAAAAAAAAeAQAAAAAAAAAAAAAeAQAAAAAAAB8BAAAAAAAAAAAAAB8BAAAAAAAAIAEAAAAAAAAAAAAAIAEAAAAAAAAhAQAAAAAAAAAAAAAhAQAAAAAAACIBAAAAAAAAAAAAACIBAAAAAAAAIwEAAAAAAAAAAAAAIwEAAAAAAAAkAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHAEAAAAAAAAcAQAAAAAAAAAAAAAAAPC/"
				],
				[
					86,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAACQBAAAAAAAAJgEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJAEAAAAAAAAkAQAAAAAAAAAAAAAAAPC/"
				],
				[
					87,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAACUBAAAAAAAAJwEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJQEAAAAAAAAlAQAAAAAAAAAAAAAAAPC/"
				],
				[
					88,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAACYBAAAAAAAAJwEAAAAAAAAAAAAAJwEAAAAAAAAoAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJgEAAAAAAAAmAQAAAAAAAAAAAAAAAPC/"
				],
				[
					89,
					1,
					"insert",
					{
						"characters": "agents/AIPl"
					},
					"CwAAACgBAAAAAAAAKQEAAAAAAAAAAAAAKQEAAAAAAAAqAQAAAAAAAAAAAAAqAQAAAAAAACsBAAAAAAAAAAAAACsBAAAAAAAALAEAAAAAAAAAAAAALAEAAAAAAAAtAQAAAAAAAAAAAAAtAQAAAAAAAC4BAAAAAAAAAAAAAC4BAAAAAAAALwEAAAAAAAAAAAAALwEAAAAAAAAwAQAAAAAAAAAAAAAwAQAAAAAAADEBAAAAAAAAAAAAADEBAAAAAAAAMgEAAAAAAAAAAAAAMgEAAAAAAAAzAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAKAEAAAAAAAAoAQAAAAAAAAAAAAAAAPC/"
				],
				[
					90,
					1,
					"insert",
					{
						"characters": "ayer"
					},
					"BAAAADMBAAAAAAAANAEAAAAAAAAAAAAANAEAAAAAAAA1AQAAAAAAAAAAAAA1AQAAAAAAADYBAAAAAAAAAAAAADYBAAAAAAAANwEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMwEAAAAAAAAzAQAAAAAAAAAAAAAAAPC/"
				],
				[
					92,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAADkBAAAAAAAAOgEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAOQEAAAAAAAA5AQAAAAAAAAAAAAAAAPC/"
				],
				[
					99,
					1,
					"left_delete",
					null,
					"AQAAAD4BAAAAAAAAPgEAAAAAAAAmHwAAY2xhc3MgQUlQbGF5ZXIgewogICAgY29uc3RydWN0b3IocGxheWVyTnVtYmVyLCBjaGFyYWN0ZXJzLCBtb2RlID0gJ29wdGltYWwnLCBsb3dIZWFsdGhUaHJlc2hvbGQgPSAwLjMpIHsKICAgICAgICB0aGlzLnBsYXllck51bWJlciA9IHBsYXllck51bWJlcjsKICAgICAgICB0aGlzLmNoYXJhY3RlcnMgPSBjaGFyYWN0ZXJzOwogICAgICAgIHRoaXMubG93SGVhbHRoVGhyZXNob2xkID0gbG93SGVhbHRoVGhyZXNob2xkOyAvLyAzMCUgSFAgb3IgbGVzcyBpcyBjb25zaWRlcmVkIGxvdyBoZWFsdGgKICAgICAgICB0aGlzLm1vZGUgPSBtb2RlOyAvLyAnb3B0aW1hbCcsICdzdWJvcHRpbWFsJywgb3IgJ3JhbmRvbScKICAgIH0KCiAgICBjaG9vc2VBY3Rpb24oY2hhcmFjdGVyLCBvcHBvbmVudHMpIHsKICAgICAgICBzd2l0Y2ggKHRoaXMubW9kZSkgewogICAgICAgICAgICBjYXNlICdvcHRpbWFsJzoKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNob29zZU9wdGltYWxBY3Rpb24oY2hhcmFjdGVyLCBvcHBvbmVudHMpOwogICAgICAgICAgICBjYXNlICdzdWJvcHRpbWFsJzoKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNob29zZVN1Ym9wdGltYWxBY3Rpb24oY2hhcmFjdGVyLCBvcHBvbmVudHMpOwogICAgICAgICAgICBjYXNlICdyYW5kb20nOgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hvb3NlUmFuZG9tQWN0aW9uKGNoYXJhY3Rlcik7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYEludmFsaWQgQUkgbW9kZTogJHt0aGlzLm1vZGV9LiBEZWZhdWx0aW5nIHRvIHJhbmRvbS5gKTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNob29zZVJhbmRvbUFjdGlvbihjaGFyYWN0ZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBjaG9vc2VPcHRpbWFsQWN0aW9uKGNoYXJhY3Rlciwgb3Bwb25lbnRzKSB7CiAgICAgICAgY29uc3QgYWN0aW9uVmFsdWVzID0ge307CgogICAgICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIGNoYXJhY3Rlci5hY3Rpb25zKSB7CiAgICAgICAgICAgIGFjdGlvblZhbHVlc1thY3Rpb24udHlwZV0gPSB0aGlzLmV2YWx1YXRlQWN0aW9uKGNoYXJhY3RlciwgYWN0aW9uLCBvcHBvbmVudHMsIHRoaXMuY2hhcmFjdGVycywgY2hhcmFjdGVyKTsKICAgICAgICB9CgogICAgICAgIGxldCB0b3RhbFZhbHVlID0gMDsKICAgICAgICBmb3IgKGNvbnN0IGFjdGlvbiBvZiBjaGFyYWN0ZXIuYWN0aW9ucykgewogICAgICAgICAgICB0b3RhbFZhbHVlICs9IGFjdGlvblZhbHVlc1thY3Rpb24udHlwZV07CiAgICAgICAgfQoKICAgICAgICBsZXQgcmFuZG9tTnVtYmVyID0gTWF0aC5yYW5kb20oKSAqIHRvdGFsVmFsdWU7CiAgICAgICAgbGV0IGN1bXVsYXRpdmVWYWx1ZSA9IDA7CgogICAgICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIGNoYXJhY3Rlci5hY3Rpb25zKSB7CiAgICAgICAgICAgIGN1bXVsYXRpdmVWYWx1ZSArPSBhY3Rpb25WYWx1ZXNbYWN0aW9uLnR5cGVdOwogICAgICAgICAgICBpZiAocmFuZG9tTnVtYmVyIDw9IGN1bXVsYXRpdmVWYWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFyYWN0ZXIuYWN0aW9ucy5sZW5ndGgpOwogICAgICAgIGxldCBiZXN0QWN0aW9uID0gY2hhcmFjdGVyLmFjdGlvbnNbcmFuZG9tSW5kZXhdOwogICAgICAgIHJldHVybiBiZXN0QWN0aW9uOwogICAgfQoKICAgIGNob29zZVN1Ym9wdGltYWxBY3Rpb24oY2hhcmFjdGVyLCBvcHBvbmVudHMpIHsKICAgICAgICBjb25zdCBhY3Rpb25WYWx1ZXMgPSB7fTsKICAgICAgICBsZXQgdG90YWxWYWx1ZSA9IDA7CgogICAgICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIGNoYXJhY3Rlci5hY3Rpb25zKSB7CiAgICAgICAgICAgIGFjdGlvblZhbHVlc1thY3Rpb24udHlwZV0gPSB0aGlzLmV2YWx1YXRlQWN0aW9uKGNoYXJhY3RlciwgYWN0aW9uLCBvcHBvbmVudHMsIHRoaXMuY2hhcmFjdGVycywgY2hhcmFjdGVyKTsKICAgICAgICB9CgogICAgICAgIC8vIEludmVydCB0aGUgYWN0aW9uIHZhbHVlcyB0byBwcmlvcml0aXplIHN1Ym9wdGltYWwgYWN0aW9ucy4gRXZlcnkgdmFsdWUgaXMgZ3VhcmFudGVlZCB0byBiZSBiZXR3ZWVuIDAtMQogICAgICAgIGNvbnN0IGludmVydGVkQWN0aW9uVmFsdWVzID0ge307CiAgICAgICAgbGV0IHRvdGFsSW52ZXJ0ZWRWYWx1ZSA9IDA7CiAgICAgICAgZm9yIChjb25zdCBhY3Rpb24gb2YgY2hhcmFjdGVyLmFjdGlvbnMpIHsKICAgICAgICAgICAgaW52ZXJ0ZWRBY3Rpb25WYWx1ZXNbYWN0aW9uLnR5cGVdID0gMSAtIGFjdGlvblZhbHVlc1thY3Rpb24udHlwZV07IC8vIEludmVydCB2YWx1ZXMKICAgICAgICAgICAgdG90YWxJbnZlcnRlZFZhbHVlICs9IGludmVydGVkQWN0aW9uVmFsdWVzW2FjdGlvbi50eXBlXTsKICAgICAgICB9CgogICAgICAgIGxldCByYW5kb21OdW1iZXIgPSBNYXRoLnJhbmRvbSgpICogdG90YWxJbnZlcnRlZFZhbHVlOwogICAgICAgIGxldCBjdW11bGF0aXZlVmFsdWUgPSAwOwoKICAgICAgICBmb3IgKGNvbnN0IGFjdGlvbiBvZiBjaGFyYWN0ZXIuYWN0aW9ucykgewogICAgICAgICAgICBjdW11bGF0aXZlVmFsdWUgKz0gaW52ZXJ0ZWRBY3Rpb25WYWx1ZXNbYWN0aW9uLnR5cGVdOwogICAgICAgICAgICBpZiAocmFuZG9tTnVtYmVyIDw9IGN1bXVsYXRpdmVWYWx1ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU2hvdWxkIG5vdCByZWFjaCBoZXJlLCBidXQgcmV0dXJuIGEgcmFuZG9tIGFjdGlvbiBhcyBhIGZhbGxiYWNrCiAgICAgICAgY29uc3QgcmFuZG9tSW5kZXggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjaGFyYWN0ZXIuYWN0aW9ucy5sZW5ndGgpOwogICAgICAgIHJldHVybiBjaGFyYWN0ZXIuYWN0aW9uc1tyYW5kb21JbmRleF07CiAgICB9CgogICAgY2hvb3NlUmFuZG9tQWN0aW9uKGNoYXJhY3RlcikgewogICAgICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY2hhcmFjdGVyLmFjdGlvbnMubGVuZ3RoKTsKICAgICAgICByZXR1cm4gY2hhcmFjdGVyLmFjdGlvbnNbcmFuZG9tSW5kZXhdOwogICAgfQoKICAgIGV2YWx1YXRlQWN0aW9uKGNoYXJhY3RlciwgYWN0aW9uLCBvcHBvbmVudHMsIGFsbGllcywgYWN0aW5nQ2hhcmFjdGVyKSB7CiAgICAgICAgbGV0IHZhbHVlID0gMDsKICAgICAgICBsZXQgdGFyZ2V0ID0gdGhpcy5jaG9vc2VUYXJnZXQoYWN0aW9uLCBhY3RpbmdDaGFyYWN0ZXIsIG9wcG9uZW50cywgYWxsaWVzKTsKCiAgICAgICAgbGV0IG1pbkNsYW1wID0gMDsKICAgICAgICBsZXQgbWF4Q2xhbXAgPSAwOwogICAgICAgIC8vICAgIG1hcCh2YWx1ZSwgc291cmNlTWluLCBzb3VyY2VNYXgsIHRhcmdldE1pbiwgdGFyZ2V0TWF4KSB7CiAgICAgICAgc3dpdGNoIChhY3Rpb24udHlwZSkgewogICAgICAgICAgICBjYXNlICdhdHRhY2snOgogICAgICAgICAgICAgICAgLy9WYWx1ZSBhdHRhY2tpbmcgd2Vha2VzdCBvcHBvbmVudAogICAgICAgICAgICAgICAgaWYgKHRhcmdldCkgewogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gKGNoYXJhY3Rlci5zdGF0cy5BdHRhY2sgLSB0YXJnZXQuc3RhdHMuRGVmZW5zZSk7CiAgICAgICAgICAgICAgICAgICAgbWluQ2xhbXAgPSAtOTA7CiAgICAgICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSA5MDsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFV0aWxzLm1hcCh2YWx1ZSwgbWluQ2xhbXAsIG1heENsYW1wLCAwLCAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdtdWx0aV9hdHRhY2snOgogICAgICAgICAgICAgICAgLy9WYWx1ZSBtdWx0aWF0dGFjayBiYXNlZCBvbiBhdmVyYWdlIGRlZmVuc2UKICAgICAgICAgICAgICAgIGNvbnN0IGFsaXZlT3Bwb25lbnRzID0gb3Bwb25lbnRzLmZpbHRlcihjID0+IGMuaXNBbGl2ZSgpKTsKICAgICAgICAgICAgICAgIGxldCBhdmVyYWdlRGVmZW5zZSA9IGFsaXZlT3Bwb25lbnRzLmxlbmd0aCA+IDAgPyBhbGl2ZU9wcG9uZW50cy5yZWR1Y2UoKHN1bSwgY2hhcikgPT4gc3VtICsgY2hhci5zdGF0cy5EZWZlbnNlLCAwKSAvIGFsaXZlT3Bwb25lbnRzLmxlbmd0aCA6IDA7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IChjaGFyYWN0ZXIuc3RhdHMuQXR0YWNrIC0gYXZlcmFnZURlZmVuc2UpICogYWxpdmVPcHBvbmVudHMubGVuZ3RoOwogICAgICAgICAgICAgICAgbWluQ2xhbXAgPSAtOTAgKiBhbGl2ZU9wcG9uZW50cy5sZW5ndGg7CiAgICAgICAgICAgICAgICBtYXhDbGFtcCA9IDkwICogYWxpdmVPcHBvbmVudHMubGVuZ3RoOwogICAgICAgICAgICAgICAgdmFsdWUgPSBVdGlscy5tYXAodmFsdWUsIG1pbkNsYW1wLCBtYXhDbGFtcCwgMCwgMSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnbWFnaWNfYXR0YWNrJzoKICAgICAgICAgICAgICAgIC8vVmFsdWUgYXR0YWNraW5nIHdlYWtlc3Qgb3Bwb25lbnQKICAgICAgICAgICAgICAgIGlmICh0YXJnZXQpIHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IChjaGFyYWN0ZXIuc3RhdHMuTWFnaWNBdHRhY2sgLSB0YXJnZXQuc3RhdHMuTWFnaWNEZWZlbnNlKTsKICAgICAgICAgICAgICAgICAgICBtaW5DbGFtcCA9IC05MDsKICAgICAgICAgICAgICAgICAgICBtYXhDbGFtcCA9IDkwOwogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gVXRpbHMubWFwKHZhbHVlLCBtaW5DbGFtcCwgbWF4Q2xhbXAsIDAsIDEpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ211bHRpX21hZ2ljX2F0dGFjayc6CiAgICAgICAgICAgICAgICAvL1ZhbHVlIG11bHRpYXR0YWNrIGJhc2VkIG9uIGF2ZXJhZ2UgbWFnaWMgZGVmZW5zZQogICAgICAgICAgICAgICAgY29uc3QgYWxpdmVNYWdpY09wcG9uZW50cyA9IG9wcG9uZW50cy5maWx0ZXIoYyA9PiBjLmlzQWxpdmUoKSk7CiAgICAgICAgICAgICAgICBsZXQgYXZlcmFnZU1hZ2ljRGVmZW5zZSA9IGFsaXZlTWFnaWNPcHBvbmVudHMubGVuZ3RoID4gMCA/IGFsaXZlTWFnaWNPcHBvbmVudHMucmVkdWNlKChzdW0sIGNoYXIpID0+IHN1bSArIGNoYXIuc3RhdHMuTWFnaWNEZWZlbnNlLCAwKSAvIGFsaXZlTWFnaWNPcHBvbmVudHMubGVuZ3RoIDogMDsKICAgICAgICAgICAgICAgIHZhbHVlID0gKGNoYXJhY3Rlci5zdGF0cy5NYWdpY0F0dGFjayAtIGF2ZXJhZ2VNYWdpY0RlZmVuc2UpICogYWxpdmVNYWdpY09wcG9uZW50cy5sZW5ndGg7CiAgICAgICAgICAgICAgICBtaW5DbGFtcCA9IC05MCAqIGFsaXZlTWFnaWNPcHBvbmVudHMubGVuZ3RoOwogICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSA5MCAqIGFsaXZlTWFnaWNPcHBvbmVudHMubGVuZ3RoOwogICAgICAgICAgICAgICAgdmFsdWUgPSBVdGlscy5tYXAodmFsdWUsIG1pbkNsYW1wLCBtYXhDbGFtcCwgMCwgMSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnaGVhbCc6CiAgICAgICAgICAgICAgICAvL1ZhbHVlIGhlYWxpbmcgd2Vha2VzdCBhbGx5CiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgICAgICAgICAgICAgbWluQ2xhbXAgPSAxOwogICAgICAgICAgICAgICAgICAgIG1heENsYW1wID0gdGFyZ2V0LnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgIHZhbHVlID0gVXRpbHMubWFwKHRhcmdldC5zdGF0cy5jdXJyZW50SFAsIG1pbkNsYW1wLCBtYXhDbGFtcCwgMCwgMSk7CiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSAxIC0gdmFsdWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnbXVsdGlfaGVhbCc6CiAgICAgICAgICAgICAgICAvL1ZhbHVlIGJhc2VkIG9uIGxvdyBoZWFsdGggYWNyb3NzIHRlYW0KICAgICAgICAgICAgICAgIGNvbnN0IGFsaXZlQWxsaWVzID0gYWxsaWVzLmZpbHRlcihjID0+IGMuaXNBbGl2ZSgpKTsKICAgICAgICAgICAgICAgIGxldCB0b3RhbE1heEhlYWx0aCA9IDA7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGFsbHkgb2YgYWxpdmVBbGxpZXMpIHsKICAgICAgICAgICAgICAgICAgICB0b3RhbE1heEhlYWx0aCArPSBhbGx5LnN0YXRzLkhQOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbWluQ2xhbXAgPSAxOwogICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSB0b3RhbE1heEhlYWx0aDsKCiAgICAgICAgICAgICAgICBsZXQgdG90YWxDdXJyZW50SGVhbHRoID0gYWxpdmVBbGxpZXMubGVuZ3RoID4gMCA/IGFsaXZlQWxsaWVzLnJlZHVjZSgoc3VtLCBjaGFyKSA9PiBzdW0gKyAoY2hhci5zdGF0cy5jdXJyZW50SFApLCAwKSA6IDA7CgogICAgICAgICAgICAgICAgdmFsdWUgPSBVdGlscy5tYXAodG90YWxDdXJyZW50SGVhbHRoLCBtaW5DbGFtcCwgbWF4Q2xhbXAsIDAsIDEpOwogICAgICAgICAgICAgICAgdmFsdWUgPSAxIC0gdmFsdWU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnZGVmZW5kJzoKICAgICAgICAgICAgICAgIC8vIFZhbHVlIGRlZmVuZCBiYXNlZCBvbiBtaXNzaW5nIGhlYWx0aCwgYnV0IGtlZXAgaXQgaW4gYSByZWFzb25hYmxlIHJhbmdlCiAgICAgICAgICAgICAgICBjb25zdCBoZWFsdGhSYXRpbyA9IDEgLSAoY2hhcmFjdGVyLnN0YXRzLmN1cnJlbnRIUCAvIGNoYXJhY3Rlci5zdGF0cy5IUCk7CiAgICAgICAgICAgICAgICB2YWx1ZSA9IChoZWFsdGhSYXRpbyAqKiAyKSAvIDEuMjU7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgfQoKICAgIGZpbmRXZWFrZXN0VGFyZ2V0KHRhcmdldHMsIHN0YXQpIHsKICAgICAgICBsZXQgd2Vha2VzdCA9IG51bGw7CiAgICAgICAgbGV0IGxvd2VzdFN0YXQgPSBJbmZpbml0eTsKCiAgICAgICAgZm9yIChjb25zdCB0YXJnZXQgb2YgdGFyZ2V0cykgewogICAgICAgICAgICBpZiAodGFyZ2V0LmlzQWxpdmUoKSAmJiB0YXJnZXQuc3RhdHNbc3RhdF0gPCBsb3dlc3RTdGF0KSB7CiAgICAgICAgICAgICAgICB3ZWFrZXN0ID0gdGFyZ2V0OwogICAgICAgICAgICAgICAgbG93ZXN0U3RhdCA9IHRhcmdldC5zdGF0c1tzdGF0XTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gd2Vha2VzdDsKICAgIH0KCiAgICBjaG9vc2VUYXJnZXQoYWN0aW9uLCBjaGFyYWN0ZXIsIG9wcG9uZW50cywgYWxsaWVzKSB7CiAgICAgICAgc3dpdGNoIChhY3Rpb24udHlwZSkgewogICAgICAgICAgICBjYXNlICdhdHRhY2snOgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZFdlYWtlc3RUYXJnZXQob3Bwb25lbnRzLCAnRGVmZW5zZScpOwogICAgICAgICAgICBjYXNlICdtYWdpY19hdHRhY2snOgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZFdlYWtlc3RUYXJnZXQob3Bwb25lbnRzLCAnTWFnaWNEZWZlbnNlJyk7CiAgICAgICAgICAgIGNhc2UgJ2hlYWwnOgogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmluZFdlYWtlc3RUYXJnZXQoYWxsaWVzLCAnY3VycmVudEhQJyk7IC8vSGVhbCB3ZWFrZXN0IGFsbHkgb3Igc2VsZgogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8vIE5vIHRhcmdldCBuZWVkZWQgZm9yIG90aGVyIGFjdGlvbnMKICAgICAgICB9CiAgICB9CgogICAgbWFwKHZhbHVlLCBzb3VyY2VNaW4sIHNvdXJjZU1heCwgdGFyZ2V0TWluLCB0YXJnZXRNYXgpIHsKICAgICAgICByZXR1cm4gKHZhbHVlIC0gc291cmNlTWluKSAqICh0YXJnZXRNYXggLSB0YXJnZXRNaW4pIC8gKHNvdXJjZU1heCAtIHNvdXJjZU1pbikgKyB0YXJnZXRNaW47CiAgICB9Cn0K",
					"AQAAAAAAAAABAAAAPgEAAAAAAABkIAAAAAAAAAAAAAAAAPC/"
				],
				[
					100,
					1,
					"left_delete",
					null,
					"AwAAAD0BAAAAAAAAPQEAAAAAAAABAAAACjwBAAAAAAAAPAEAAAAAAAABAAAACjsBAAAAAAAAOwEAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAPgEAAAAAAAA+AQAAAAAAAAAAAAAAAPC/"
				],
				[
					134,
					1,
					"cut",
					null,
					"AQAAADwBAAAAAAAAPAEAAAAAAACZTQAAY2xhc3MgQUlfRGlyZWN0b3IgewogICAgY29uc3RydWN0b3IobW9kZSA9ICdpbmNsdXNpb24nLCB0YXJnZXRBY3Rpb25zID0gNjAsIGRpZmZpY3VsdHlBZGp1c3RtZW50U2NhbGFyID0gLjAwMiwgYWN0aW9uVGhyZXNob2xkID0gMCwgdGhyZXNob2xkQWRqdXN0bWVudCA9IDIwKSB7CiAgICAgICAgdGhpcy5tYXhCdWZmQW1vdW50ID0gNjA7CiAgICAgICAgdGhpcy5tYXhOZXJmQW1vdW50ID0gNjA7CiAgICAgICAgdGhpcy5nYW1lU3RhdGUgPSB7fTsKICAgICAgICB0aGlzLm1vZGUgPSBtb2RlOwoKICAgICAgICB0aGlzLmJhbGFuY2VNYWduaXR1ZGUgPSAwOwogICAgICAgIHRoaXMudGFyZ2V0QWN0aW9ucyA9IHRhcmdldEFjdGlvbnM7CiAgICAgICAgdGhpcy5kaWZmaWN1bHR5QWRqdXN0bWVudFNjYWxhciA9IGRpZmZpY3VsdHlBZGp1c3RtZW50U2NhbGFyOwogICAgfQoKICAgIGdldFJhbmRvbUJ1ZmZBbW91bnQoKSB7CiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMubWF4QnVmZkFtb3VudCk7CiAgICB9CgogICAgZ2V0UmFuZG9tTmVyZkFtb3VudCgpIHsKICAgICAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy5tYXhOZXJmQW1vdW50KTsKICAgIH0KCiAgICBiYWxhbmNlR2FtZShwbGF5ZXJzLCBsb2csIHRpbWVTdGVwLCBhY3Rpb25RdWV1ZSkgewogICAgICAgIGNvbnNvbGUubG9nKGBbVGltZSBTdGVwOiAke3RpbWVTdGVwfV0gQUkgRGlyZWN0b3IgaXMgYmFsYW5jaW5nIHRoZSBnYW1lLi4uYCk7CgogICAgICAgIGNvbnN0IHBsYXllcjEgPSBwbGF5ZXJzWzBdOwogICAgICAgIGNvbnN0IHBsYXllcjIgPSBwbGF5ZXJzWzFdOwoKICAgICAgICBjb25zdCBwbGF5ZXIxTGl2aW5nID0gcGxheWVyMS5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKS5sZW5ndGg7CiAgICAgICAgY29uc3QgcGxheWVyMkxpdmluZyA9IHBsYXllcjIuY2hhcmFjdGVycy5maWx0ZXIoY2hhciA9PiBjaGFyLmlzQWxpdmUoKSkubGVuZ3RoOwoKICAgICAgICBsZXQgYmFsYW5jZUFjdGlvbnMgPSB7fTsKCiAgICAgICAgLy9iYWxhbmNlIGZvciBib3RoIHBsYXllcnMgaW4gc2FtZSBkaXJlY3Rpb24gaWYgdGhyZXNob2xkIGhhcyBiZWVuIHBhc3NlZCBhbmQgbW9kZSBpcyBkaWZmaWN1bHR5CiAgICAgICAgaWYgKHRoaXMubW9kZSA9PSAnZGlmZmljdWx0eScpIHsKCiAgICAgICAgICAgIGlmICh0aGlzLmdhbWVTdGF0ZS5hY3Rpb25DdXJySFBEYXRhLmxlbmd0aCA+PSAyKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zID49IHRoaXMudGFyZ2V0QWN0aW9ucykgewogICAgICAgICAgICAgICAgICAvLyAgdGhpcy50YXJnZXRBY3Rpb25zID0gdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKzE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvL29uY2Ugd2UgaGF2ZSB0d28gcG9pbnRzLCBzdGFydCBnZXR0aW5nIGxpbmUgb2YgYmVzdCBmaXQgZm9yIHByaW9yIHBvaW50cyB2aWEgbGluZWFyIHJlZ3Jlc3Npb24KICAgICAgICAgICAgICAgIGNvbnN0IHJlZ3Jlc3Npb24gPSBzcy5saW5lYXJSZWdyZXNzaW9uKHRoaXMuZ2FtZVN0YXRlLmFjdGlvbkN1cnJIUERhdGEpOwogICAgICAgICAgICAgICAgLy9jYWxjdWxhdGUgZGVzaXJlZCBsaW5lIGJldHdlZW4gbW9zdCByZWNlbnQgcG9pbnQgYW5kIHRhcmdldCBwb2ludAogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRvdGFsSFAgPSB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jdXJyZW50SFAgKyB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jdXJyZW50SFA7CiAgICAgICAgICAgICAgICBjb25zdCBzbG9wZSA9IFV0aWxzLnNhZmVEaXZpZGUoKHRoaXMudGFyZ2V0QWN0aW9ucyAtIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyQWN0aW9ucyApLCAoMCAtIGN1cnJlbnRUb3RhbEhQKSk7CiAgICAgICAgICAgICAgICBjb25zdCB5SW50ZXJjZXB0ID0gLTEgKiAoc2xvcGUgKiB0aGlzLnRhcmdldEFjdGlvbnMpOwoKICAgICAgICAgICAgICAgIC8vY2FsY3VsYXRlIHRoZSBuZXh0IHBvaW50IGZvciBib3RoIGxpbmVzCiAgICAgICAgICAgICAgICAvL2NvbnN0IGJlc3RGaXRYID0gdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zICsgMTsKICAgICAgICAgICAgICAgIGNvbnN0IGJlc3RGaXRYID0gdGhpcy50YXJnZXRBY3Rpb25zOwogICAgICAgICAgICAgICAgY29uc3QgYmVzdEZpdFkgPSAocmVncmVzc2lvbi5tICogYmVzdEZpdFgpICsgcmVncmVzc2lvbi5iOwoKICAgICAgICAgICAgICAgIC8vY29uc3QgdGFyZ2V0Rml0WCA9IHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyQWN0aW9ucyArIDE7CiAgICAgICAgICAgICAgICBjb25zdCB0YXJnZXRGaXRYID0gdGhpcy50YXJnZXRBY3Rpb25zOwogICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Rml0WSA9IChzbG9wZSAqIHRhcmdldEZpdFgpICsgeUludGVyY2VwdDsKCiAgICAgICAgICAgICAgICAvL2NhbGN1bGF0ZSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB5IHBvaW50cwogICAgICAgICAgICAgICAgY29uc3QgeURpc3RhbmNlID0gKHRhcmdldEZpdFkgLSBiZXN0Rml0WSk7CgogICAgICAgICAgICAgICAgLy8gZm9yKGxldCBpID0gMDsgaSA8IHRoaXMuZ2FtZVN0YXRlLmFjdGlvbkN1cnJIUERhdGEubGVuZ3RoOyBpKyspewogICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKCJQT0lOVCAiICsgaSArICI6IFggLSAiICsgdGhpcy5nYW1lU3RhdGUuYWN0aW9uQ3VyckhQRGF0YVtpXVswXSArICIsIFkgLSAiICsgdGhpcy5nYW1lU3RhdGUuYWN0aW9uQ3VyckhQRGF0YVtpXVsxXSk7CiAgICAgICAgICAgICAgICAvLyB9CgogICAgICAgICAgICAgICAgLy9tdWx0aXBseSB5RGlzdGFuY2UgYnkgMiB0byBnZXQgc2NhbGFyIHRvIHVzZSBpbiBiYWxhbmNpbmcgbWFnbml0dWRlLCBhcyB3ZSB3YW50IHRvIG1ha2UgbmV3IHBvaW50cyBvbiBvcHBvc2l0ZSBzaWRlIG9mIGJlc3QgZml0CiAgICAgICAgICAgICAgICB0aGlzLmJhbGFuY2VNYWduaXR1ZGUgPSB5RGlzdGFuY2U7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiKioqKioqKiogQkFMQU5DRSBNQUdOSVRVREUgKioqKioqKioqICIgKyB0aGlzLmJhbGFuY2VNYWduaXR1ZGUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coIk5vdCBlbm91Z2ggYWN0aW9uIGRhdGEgdG8gY2FsY3VsYXRlIGJhbGFuY2UgYWRqdXN0bWVudC4iKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9yb2xsIGV2ZW5seSBiZXR3ZWVuIGx1Y2sgb3IgYXRrL2RlZiB0byBzdGFydAogICAgICAgICAgICBsZXQgcmFuZG9tTnVtYmVyID0gTWF0aC5yYW5kb20oKTsKICAgICAgICAgICAgbGV0IGN1bXVsYXRpdmVWYWx1ZSA9IHJhbmRvbU51bWJlcjsKCiAgICAgICAgICAgIC8vb25seSByb2xsIGZvciBIUCBjaGFuZ2UgaWYgcGxheWVycyBhcmUgZ29pbmcgdG9vIGZhc3QKICAgICAgICAgICAgLy9pZiBvdXIgbWFnbml0dWRlIGlzIHBvc2l0aXZlLCBuZWVkIHRvIG5lcmYuIE90aGVyd2lzZSwgYnVmZgogICAgICAgICAgICBpZiAodGhpcy5iYWxhbmNlTWFnbml0dWRlID49IDApIHsKICAgICAgICAgICAgICAgIC8vY2FwIGJhbGFuY2VNYWduaXR1ZGUgdG8gcHJldmVudCBsb2NrIHN0YXRlcyBmcm9tIGxpbmUgb2YgYmVzdCBmaXQgZHJpZnRpbmcKICAgICAgICAgICAgICAgIHRoaXMuYmFsYW5jZU1hZ25pdHVkZSA9IE1hdGgubWluKHRoaXMuYmFsYW5jZU1hZ25pdHVkZSwgNTApOwogICAgICAgICAgICAgICAgaWYgKGN1bXVsYXRpdmVWYWx1ZSA8PSAuNSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2VDdXJySFAocGxheWVyMSwgcGxheWVyMiwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChjdW11bGF0aXZlVmFsdWUgPD0gLjY2KSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMuYmFsYW5jZUx1Y2socGxheWVyMSwgcGxheWVyMiwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2VEYW1hZ2UocGxheWVyMSwgcGxheWVyMiwgbG9nLCBhY3Rpb25RdWV1ZSk7CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5iYWxhbmNlTWFnbml0dWRlID0gTWF0aC5tYXgodGhpcy5iYWxhbmNlTWFnbml0dWRlLCAtNTApOwogICAgICAgICAgICAgICAgLy8gaWYgKGN1bXVsYXRpdmVWYWx1ZSA8PSAuMzMpIHsKICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLmJhbGFuY2VMdWNrKHBsYXllcjEsIHBsYXllcjIsIGxvZywgYWN0aW9uUXVldWUpOwogICAgICAgICAgICAgICAgLy8gfSBlbHNlIAogICAgICAgICAgICAgICAgaWYgKGN1bXVsYXRpdmVWYWx1ZSA8PSAuNSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2VDdXJySFAocGxheWVyMSwgcGxheWVyMiwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJhbGFuY2VEYW1hZ2UocGxheWVyMSwgcGxheWVyMiwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5tb2RlID09ICdpbmNsdXNpb24nKSB7CiAgICAgICAgICAgIGxldCBsb3NpbmdQbGF5ZXIgPSBudWxsOwogICAgICAgICAgICBsZXQgd2lubmluZ1BsYXllciA9IG51bGw7CgogICAgICAgICAgICBjb25zdCBwbGF5ZXIxTGl2aW5nUmF0aW8gPSBwbGF5ZXIxTGl2aW5nIC8gcGxheWVyMS5jaGFyYWN0ZXJzLmxlbmd0aDsKICAgICAgICAgICAgY29uc3QgcGxheWVyMkxpdmluZ1JhdGlvID0gcGxheWVyMkxpdmluZyAvIHBsYXllcjIuY2hhcmFjdGVycy5sZW5ndGg7CgogICAgICAgICAgICBsZXQgcGxheWVyMVdpblZhbHVlID0gVXRpbHMubWFwKHBsYXllcjFMaXZpbmdSYXRpbyArIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmhwUmF0aW8sIDAsIDIsIDAsIDEpOwogICAgICAgICAgICBsZXQgcGxheWVyMldpblZhbHVlID0gVXRpbHMubWFwKHBsYXllcjJMaXZpbmdSYXRpbyArIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmhwUmF0aW8sIDAsIDIsIDAsIDEpOwoKICAgICAgICAgICAgaWYgKHBsYXllcjFXaW5WYWx1ZSA+IHBsYXllcjJXaW5WYWx1ZSkgewogICAgICAgICAgICAgICAgbG9zaW5nUGxheWVyID0gcGxheWVyMjsKICAgICAgICAgICAgICAgIHdpbm5pbmdQbGF5ZXIgPSBwbGF5ZXIxOwogICAgICAgICAgICB9IGVsc2UgaWYgKHBsYXllcjFXaW5WYWx1ZSA8IHBsYXllcjJXaW5WYWx1ZSkgewogICAgICAgICAgICAgICAgbG9zaW5nUGxheWVyID0gcGxheWVyMTsKICAgICAgICAgICAgICAgIHdpbm5pbmdQbGF5ZXIgPSBwbGF5ZXIyOwogICAgICAgICAgICB9CgogICAgICAgICAgICBiYWxhbmNlQWN0aW9uc1snaHAnXSA9IE1hdGguYWJzKHBsYXllcjFXaW5WYWx1ZSAtIHBsYXllcjJXaW5WYWx1ZSk7CgogICAgICAgICAgICBsZXQgc2xvd1BsYXllciA9IG51bGw7CiAgICAgICAgICAgIGxldCBmYXN0UGxheWVyID0gbnVsbDsKCiAgICAgICAgICAgIGxldCBwbGF5ZXIxU3BlZWRWYWx1ZSA9IFV0aWxzLnNhZmVEaXZpZGUodGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuYWN0aW9ucywgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKTsKICAgICAgICAgICAgbGV0IHBsYXllcjJTcGVlZFZhbHVlID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5hY3Rpb25zLCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMpOwoKICAgICAgICAgICAgaWYgKHBsYXllcjFTcGVlZFZhbHVlID4gcGxheWVyMlNwZWVkVmFsdWUpIHsKICAgICAgICAgICAgICAgIHNsb3dQbGF5ZXIgPSBwbGF5ZXIyOwogICAgICAgICAgICAgICAgZmFzdFBsYXllciA9IHBsYXllcjE7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocGxheWVyMVNwZWVkVmFsdWUgPCBwbGF5ZXIyU3BlZWRWYWx1ZSkgewogICAgICAgICAgICAgICAgc2xvd1BsYXllciA9IHBsYXllcjE7CiAgICAgICAgICAgICAgICBmYXN0UGxheWVyID0gcGxheWVyMjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgYmFsYW5jZUFjdGlvbnNbJ3NwZWVkJ10gPSBNYXRoLmFicyhwbGF5ZXIxU3BlZWRWYWx1ZSAtIHBsYXllcjJTcGVlZFZhbHVlKTsKCiAgICAgICAgICAgIGxldCB1bmx1Y2t5UGxheWVyID0gbnVsbDsKICAgICAgICAgICAgbGV0IGx1Y2t5UGxheWVyID0gbnVsbDsKCiAgICAgICAgICAgIGxldCBwbGF5ZXIxTHVja1ZhbHVlID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5kYW1hZ2VPdXQsIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyRGFtYWdlT3V0KTsKICAgICAgICAgICAgbGV0IHBsYXllcjJMdWNrVmFsdWUgPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmRhbWFnZU91dCwgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJEYW1hZ2VPdXQpOwoKICAgICAgICAgICAgaWYgKHBsYXllcjFMdWNrVmFsdWUgPiBwbGF5ZXIyTHVja1ZhbHVlKSB7CiAgICAgICAgICAgICAgICB1bmx1Y2t5UGxheWVyID0gcGxheWVyMjsKICAgICAgICAgICAgICAgIGx1Y2t5UGxheWVyID0gcGxheWVyMTsKICAgICAgICAgICAgfSBlbHNlIGlmIChwbGF5ZXIxTHVja1ZhbHVlIDwgcGxheWVyMkx1Y2tWYWx1ZSkgewogICAgICAgICAgICAgICAgdW5sdWNreVBsYXllciA9IHBsYXllcjE7CiAgICAgICAgICAgICAgICBsdWNreVBsYXllciA9IHBsYXllcjI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGJhbGFuY2VBY3Rpb25zWydsdWNrJ10gPSBNYXRoLmFicyhwbGF5ZXIxTHVja1ZhbHVlIC0gcGxheWVyMkx1Y2tWYWx1ZSk7CgogICAgICAgICAgICBsZXQgdmFsdWVTdW0gPSBiYWxhbmNlQWN0aW9uc1snaHAnXSArIGJhbGFuY2VBY3Rpb25zWydsdWNrJ10gKyBiYWxhbmNlQWN0aW9uc1snc3BlZWQnXTsKCiAgICAgICAgICAgIGlmICh2YWx1ZVN1bSA9PSAwKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiQUkgRGlyZWN0b3IgLSBubyBpbWJhbGFuY2VkIHN0YXRlIGZvdW5kISBOb3QgYWRkaW5nIGFjdGlvbnMgdG8gdGhlIHF1ZXVlLiIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL3VwZGF0ZSB2YWx1ZXMgdG8gc2NhbGUgdG8gYSAwLTEgZGlzdHJpYnV0aW9uCiAgICAgICAgICAgIGJhbGFuY2VBY3Rpb25zWydocCddID0gVXRpbHMubWFwKGJhbGFuY2VBY3Rpb25zWydocCddLCAwLCB2YWx1ZVN1bSwgMCwgMSk7CiAgICAgICAgICAgIGJhbGFuY2VBY3Rpb25zWydsdWNrJ10gPSBVdGlscy5tYXAoYmFsYW5jZUFjdGlvbnNbJ2x1Y2snXSwgMCwgdmFsdWVTdW0sIDAsIDEpOwogICAgICAgICAgICBiYWxhbmNlQWN0aW9uc1snc3BlZWQnXSA9IFV0aWxzLm1hcChiYWxhbmNlQWN0aW9uc1snc3BlZWQnXSwgMCwgdmFsdWVTdW0sIDAsIDEpOwoKICAgICAgICAgICAgbGV0IHJhbmRvbU51bWJlciA9IE1hdGgucmFuZG9tKCk7CiAgICAgICAgICAgIGxldCBjdW11bGF0aXZlVmFsdWUgPSAwOwoKICAgICAgICAgICAgY3VtdWxhdGl2ZVZhbHVlICs9IGJhbGFuY2VBY3Rpb25zWydocCddOwogICAgICAgICAgICBpZiAocmFuZG9tTnVtYmVyIDwgY3VtdWxhdGl2ZVZhbHVlKSB7CiAgICAgICAgICAgICAgICB0aGlzLmJhbGFuY2VIUCh3aW5uaW5nUGxheWVyLCBsb3NpbmdQbGF5ZXIsIGxvZywgYWN0aW9uUXVldWUpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdW11bGF0aXZlVmFsdWUgKz0gYmFsYW5jZUFjdGlvbnNbJ2x1Y2snXTsKICAgICAgICAgICAgaWYgKHJhbmRvbU51bWJlciA8IGN1bXVsYXRpdmVWYWx1ZSkgewogICAgICAgICAgICAgICAgdGhpcy5iYWxhbmNlTHVjayhsdWNreVBsYXllciwgdW5sdWNreVBsYXllciwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGN1bXVsYXRpdmVWYWx1ZSArPSBiYWxhbmNlQWN0aW9uc1snc3BlZWQnXTsKICAgICAgICAgICAgaWYgKHJhbmRvbU51bWJlciA8IGN1bXVsYXRpdmVWYWx1ZSkgewogICAgICAgICAgICAgICAgdGhpcy5iYWxhbmNlU3BlZWQoZmFzdFBsYXllciwgc2xvd1BsYXllciwgbG9nLCBhY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgYmFsYW5jZURhbWFnZShwbGF5ZXIxLCBwbGF5ZXIyLCBsb2csIGFjdGlvblF1ZXVlKSB7CiAgICAgICAgLy9jaGVjayBmb3IgbGl2aW5nIGNoYXJhY3RlcnMKICAgICAgICBjb25zdCBwbGF5ZXIxTGl2aW5nQ2hhcmFjdGVycyA9IHBsYXllcjEuY2hhcmFjdGVycy5maWx0ZXIoY2hhciA9PiBjaGFyLmlzQWxpdmUoKSk7CiAgICAgICAgY29uc3QgcGxheWVyMkxpdmluZ0NoYXJhY3RlcnMgPSBwbGF5ZXIyLmNoYXJhY3RlcnMuZmlsdGVyKGNoYXIgPT4gY2hhci5pc0FsaXZlKCkpOwoKICAgICAgICBpZiAocGxheWVyMUxpdmluZ0NoYXJhY3RlcnMubGVuZ3RoID09PSAwIHx8IHBsYXllcjJMaXZpbmdDaGFyYWN0ZXJzID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBSSBEaXJlY3RvcjogT25lIHRlYW0gaXMgZGVmZWF0ZWQsIG5vIG5lZWQgdG8gYmFsYW5jZS4iKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCgogICAgICAgIC8vZ2V0IHJhdyBhbW91bnQgdG8gYmFsYW5jZQogICAgICAgIGNvbnN0IHJhd1N0YXRDaGFuZ2VBbW91bnQgPSB0aGlzLmdldFJhbmRvbUJ1ZmZBbW91bnQoKTsKICAgICAgICAvL2J1ZmZlciBhZ2FpbnN0IHRoZSBtYWduaXR1ZGUgb2YgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0YXJnZXQgYW5kIGRlc2lyZWQKICAgICAgICBjb25zdCBzdGF0Q2hhbmdlID0gcmF3U3RhdENoYW5nZUFtb3VudCAqIE1hdGguYWJzKHRoaXMuYmFsYW5jZU1hZ25pdHVkZSkgKiB0aGlzLmRpZmZpY3VsdHlBZGp1c3RtZW50U2NhbGFyOwogICAgICAgIC8vQ29uY2F0ZW5hdGUgY2hhcmFjdGVyIGFycmF5cyBhcyB3ZSBhcmUgdGFyZ2V0aW5nIGFsbCBjaGFyYWN0ZXJzCiAgICAgICAgY29uc3QgdGFyZ2V0cyA9IHBsYXllcjFMaXZpbmdDaGFyYWN0ZXJzLmNvbmNhdChwbGF5ZXIyTGl2aW5nQ2hhcmFjdGVycyk7CiAgICAgICAgLy9BZGQgcGxheWVyIHN0cmluZ3MgdG9nZXRoZXIKICAgICAgICBjb25zdCBwbGF5ZXJOdW0gPSBwbGF5ZXIxTGl2aW5nQ2hhcmFjdGVyc1swXS5wbGF5ZXIgKyAiLCAiICsgcGxheWVyMkxpdmluZ0NoYXJhY3RlcnNbMF0ucGxheWVyOwoKICAgICAgICBsZXQgcmFuZG9tTnVtYmVyID0gTWF0aC5yYW5kb20oKTsKICAgICAgICBsZXQgY3VtdWxhdGl2ZVZhbHVlID0gMDsKICAgICAgICAvL2lmIGFjdGlvbkNoYW5nZURpZmZlcmVuY2UgcG9zaXRpdmUsIG5lcmYKICAgICAgICBpZiAodGhpcy5iYWxhbmNlTWFnbml0dWRlIDw9IDApIHsKICAgICAgICAgICAgbGV0IGJ1ZmZBY3Rpb24gPSB7fTsKICAgICAgICAgICAgaWYgKHJhbmRvbU51bWJlciA8PSAuNikgewogICAgICAgICAgICAgICAgY29uc3QgYnVmZkFjdGlvbiA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnYnVmZicsCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0czogdGFyZ2V0cywKICAgICAgICAgICAgICAgICAgICBzdGF0czogWydBdHRhY2snXSwKICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IHN0YXRDaGFuZ2UsCiAgICAgICAgICAgICAgICAgICAgcGxheWVyTnVtOiBwbGF5ZXJOdW0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBidWZmQWN0aW9uOwogICAgICAgICAgICAgICAgLy9hY3Rpb25RdWV1ZS5wdXNoKGJ1ZmZBY3Rpb24pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc3QgYnVmZkFjdGlvbiA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbmVyZicsCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0czogdGFyZ2V0cywKICAgICAgICAgICAgICAgICAgICBzdGF0czogWydEZWZlbnNlJ10sCiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBzdGF0Q2hhbmdlLAogICAgICAgICAgICAgICAgICAgIHBsYXllck51bTogcGxheWVyTnVtCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gYnVmZkFjdGlvbjsKICAgICAgICAgICAgICAgIC8vYWN0aW9uUXVldWUucHVzaChidWZmQWN0aW9uKTsKICAgICAgICAgICAgfQoKICAgICAgICB9IGVsc2UgeyAvL25lZ2F0aXZlLCBidWZmCiAgICAgICAgICAgIGlmIChyYW5kb21OdW1iZXIgPD0gLjQpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG5lcmZBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ25lcmYnLAogICAgICAgICAgICAgICAgICAgIHRhcmdldHM6IHRhcmdldHMsCiAgICAgICAgICAgICAgICAgICAgc3RhdHM6IFsnQXR0YWNrJ10sCiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBzdGF0Q2hhbmdlLAogICAgICAgICAgICAgICAgICAgIHBsYXllck51bTogcGxheWVyTnVtCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gbmVyZkFjdGlvbjsKICAgICAgICAgICAgICAgIC8vYWN0aW9uUXVldWUucHVzaChuZXJmQWN0aW9uKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnN0IG5lcmZBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1ZmYnLAogICAgICAgICAgICAgICAgICAgIHRhcmdldHM6IHRhcmdldHMsCiAgICAgICAgICAgICAgICAgICAgc3RhdHM6IFsnRGVmZW5zZSddLAogICAgICAgICAgICAgICAgICAgIGFtb3VudDogc3RhdENoYW5nZSwKICAgICAgICAgICAgICAgICAgICBwbGF5ZXJOdW06IHBsYXllck51bQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIG5lcmZBY3Rpb247CiAgICAgICAgICAgICAgICAvL2FjdGlvblF1ZXVlLnB1c2gobmVyZkFjdGlvbik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CiAgICBiYWxhbmNlQ3VyckhQKHBsYXllcjEsIHBsYXllcjIsIGxvZywgYWN0aW9uUXVldWUpIHsKICAgICAgICAvL2NoZWNrIGZvciBsaXZpbmcgY2hhcmFjdGVycwogICAgICAgIGNvbnN0IHBsYXllcjFMaXZpbmdDaGFyYWN0ZXJzID0gcGxheWVyMS5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKICAgICAgICBjb25zdCBwbGF5ZXIyTGl2aW5nQ2hhcmFjdGVycyA9IHBsYXllcjIuY2hhcmFjdGVycy5maWx0ZXIoY2hhciA9PiBjaGFyLmlzQWxpdmUoKSk7CgogICAgICAgIGlmIChwbGF5ZXIxTGl2aW5nQ2hhcmFjdGVycy5sZW5ndGggPT09IDAgfHwgcGxheWVyMkxpdmluZ0NoYXJhY3RlcnMgPT09IDApIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkFJIERpcmVjdG9yOiBPbmUgdGVhbSBpcyBkZWZlYXRlZCwgbm8gbmVlZCB0byBiYWxhbmNlLiIpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKCiAgICAgICAgLy9nZXQgcmF3IGFtb3VudCB0byBiYWxhbmNlCiAgICAgICAgY29uc3QgcmF3U3RhdENoYW5nZUFtb3VudCA9IHRoaXMuZ2V0UmFuZG9tQnVmZkFtb3VudCgpOwogICAgICAgIC8vYnVmZmVyIGFnYWluc3QgdGhlIG1hZ25pdHVkZSBvZiB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRhcmdldCBhbmQgZGVzaXJlZAogICAgICAgIGNvbnN0IHN0YXRDaGFuZ2UgPSByYXdTdGF0Q2hhbmdlQW1vdW50ICogTWF0aC5hYnModGhpcy5iYWxhbmNlTWFnbml0dWRlKSAqIHRoaXMuZGlmZmljdWx0eUFkanVzdG1lbnRTY2FsYXI7CiAgICAgICAgLy9Db25jYXRlbmF0ZSBjaGFyYWN0ZXIgYXJyYXlzIGFzIHdlIGFyZSB0YXJnZXRpbmcgYWxsIGNoYXJhY3RlcnMKICAgICAgICBjb25zdCB0YXJnZXRzID0gcGxheWVyMS5jaGFyYWN0ZXJzLmNvbmNhdChwbGF5ZXIyLmNoYXJhY3RlcnMpOwogICAgICAgIC8vQWRkIHBsYXllciBzdHJpbmdzIHRvZ2V0aGVyCiAgICAgICAgY29uc3QgcGxheWVyTnVtID0gcGxheWVyMUxpdmluZ0NoYXJhY3RlcnNbMF0ucGxheWVyICsgIiwgIiArIHBsYXllcjJMaXZpbmdDaGFyYWN0ZXJzWzBdLnBsYXllcjsKCiAgICAgICAgaWYgKHRoaXMuYmFsYW5jZU1hZ25pdHVkZSA8PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IGhlYWxBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnaGVhbCcsCiAgICAgICAgICAgICAgICB0YXJnZXRzOiB0YXJnZXRzLAogICAgICAgICAgICAgICAgc3RhdHM6IFsnY3VycmVudEhQJ10sCiAgICAgICAgICAgICAgICBhbW91bnQ6IHN0YXRDaGFuZ2UsCiAgICAgICAgICAgICAgICBwbGF5ZXJOdW06IHBsYXllck51bQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBoZWFsQWN0aW9uOwogICAgICAgICAgICAvL2FjdGlvblF1ZXVlLnB1c2goaGVhbEFjdGlvbik7CiAgICAgICAgfQoKICAgICAgICBlbHNlIHsgLy9uZWdhdGl2ZSwgYnVmZgogICAgICAgICAgICBjb25zdCBkYW1hZ2VBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnZGFtYWdlJywKICAgICAgICAgICAgICAgIHRhcmdldHM6IHRhcmdldHMsCiAgICAgICAgICAgICAgICBzdGF0czogWydjdXJyZW50SFAnXSwKICAgICAgICAgICAgICAgIGFtb3VudDogc3RhdENoYW5nZSwKICAgICAgICAgICAgICAgIHBsYXllck51bTogcGxheWVyTnVtCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGRhbWFnZUFjdGlvbjsKICAgICAgICAgICAgLy9hY3Rpb25RdWV1ZS5wdXNoKGRhbWFnZUFjdGlvbik7CiAgICAgICAgfQoKICAgIH0KCiAgICBiYWxhbmNlSFAod2lubmluZ1BsYXllciwgbG9zaW5nUGxheWVyLCBsb2csIGFjdGlvblF1ZXVlKSB7CiAgICAgICAgLy9jaGVjayBmb3IgbHZpaW5nIGNoYXJhY3RlcnMKICAgICAgICBjb25zdCBhbGl2ZVdpbm5pbmdDaGFyYWN0ZXJzID0gd2lubmluZ1BsYXllci5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKICAgICAgICBjb25zdCBhbGl2ZUxvc2luZ0NoYXJhY3RlcnMgPSBsb3NpbmdQbGF5ZXIuY2hhcmFjdGVycy5maWx0ZXIoY2hhciA9PiBjaGFyLmlzQWxpdmUoKSk7CgogICAgICAgIGlmIChhbGl2ZUxvc2luZ0NoYXJhY3RlcnMubGVuZ3RoID09PSAwIHx8IGFsaXZlV2lubmluZ0NoYXJhY3RlcnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBSSBEaXJlY3RvcjogT25lIHRlYW0gaXMgZGVmZWF0ZWQsIG5vIG5lZWQgdG8gYmFsYW5jZS4iKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3Qgd2lubmluZ1BsYXllck51bSA9IGFsaXZlV2lubmluZ0NoYXJhY3RlcnNbMF0ucGxheWVyOwogICAgICAgIGNvbnN0IGxvc2luZ1BsYXllck51bSA9IGFsaXZlTG9zaW5nQ2hhcmFjdGVyc1swXS5wbGF5ZXI7CgogICAgICAgIC8vc3BlY2lmeSBzdGF0cyB0byBidWZmIGFuZCB2YWx1ZXMgb2YgYnVmZgogICAgICAgIGNvbnN0IHN0YXRzVG9CdWZmID0gWydBdHRhY2snLCAnRGVmZW5zZSddOwogICAgICAgIGNvbnN0IHN0YXRzVG9OZXJmID0gWydBdHRhY2snLCAnRGVmZW5zZSddOwogICAgICAgIGNvbnN0IGJ1ZmZBbW91bnQgPSB0aGlzLmdldFJhbmRvbUJ1ZmZBbW91bnQoKTsKICAgICAgICBjb25zdCBuZXJmQW1vdW50ID0gdGhpcy5nZXRSYW5kb21OZXJmQW1vdW50KCk7CgogICAgICAgIC8vZm9ybWF0IGFjdGlvbnMKICAgICAgICBjb25zdCBidWZmQWN0aW9uID0gewogICAgICAgICAgICB0eXBlOiAnYnVmZicsCiAgICAgICAgICAgIHRhcmdldHM6IGFsaXZlTG9zaW5nQ2hhcmFjdGVycywKICAgICAgICAgICAgc3RhdHM6IHN0YXRzVG9CdWZmLAogICAgICAgICAgICBhbW91bnQ6IGJ1ZmZBbW91bnQsCiAgICAgICAgICAgIHBsYXllck51bTogbG9zaW5nUGxheWVyTnVtCiAgICAgICAgfTsKICAgICAgICBjb25zdCBuZXJmQWN0aW9uID0gewogICAgICAgICAgICB0eXBlOiAnbmVyZicsCiAgICAgICAgICAgIHRhcmdldHM6IGFsaXZlV2lubmluZ0NoYXJhY3RlcnMsCiAgICAgICAgICAgIHN0YXRzOiBzdGF0c1RvTmVyZiwKICAgICAgICAgICAgYW1vdW50OiBuZXJmQW1vdW50LAogICAgICAgICAgICBwbGF5ZXJOdW06IHdpbm5pbmdQbGF5ZXJOdW0KICAgICAgICB9OwoKICAgICAgICBjb25zdCByYW5kb21OdW1iZXIgPSBNYXRoLnJhbmRvbSgpOwoKICAgICAgICAvL3JhbmRvbWx5IGNob29zZSB0byBidWZmLCBuZXJmLCBvciBib3RoCiAgICAgICAgaWYgKHJhbmRvbU51bWJlciA8PSAuMzMpIHsgLy9idWZmCiAgICAgICAgICAgIGFjdGlvblF1ZXVlLnB1c2goYnVmZkFjdGlvbik7CiAgICAgICAgfSBlbHNlIGlmIChyYW5kb21OdW1iZXIgPD0gLjY2KSB7IC8vbmVyZgogICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKG5lcmZBY3Rpb24pOwogICAgICAgIH0gZWxzZSB7IC8vYm90aAogICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKGJ1ZmZBY3Rpb24pOwogICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKG5lcmZBY3Rpb24pOwogICAgICAgIH0KICAgIH0KICAgIGJhbGFuY2VTcGVlZChmYXN0UGxheWVyLCBzbG93UGxheWVyLCBsb2csIGFjdGlvblF1ZXVlKSB7CiAgICAgICAgLy9jaGVjayBmb3IgbHZpaW5nIGNoYXJhY3RlcnMKICAgICAgICBjb25zdCBhbGl2ZUZhc3RDaGFyYWN0ZXJzID0gZmFzdFBsYXllci5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKICAgICAgICBjb25zdCBhbGl2ZVNsb3dDaGFyYWN0ZXJzID0gc2xvd1BsYXllci5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKCiAgICAgICAgaWYgKGFsaXZlRmFzdENoYXJhY3RlcnMubGVuZ3RoID09PSAwIHx8IGFsaXZlU2xvd0NoYXJhY3RlcnMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJBSSBEaXJlY3RvcjogT25lIHRlYW0gaXMgZGVmZWF0ZWQsIG5vIG5lZWQgdG8gYmFsYW5jZS4iKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgZmFzdFBsYXllck51bSA9IGFsaXZlRmFzdENoYXJhY3RlcnNbMF0ucGxheWVyOwogICAgICAgIGNvbnN0IHNsb3dQbGF5ZXJOdW0gPSBhbGl2ZVNsb3dDaGFyYWN0ZXJzWzBdLnBsYXllcjsKCiAgICAgICAgLy9zcGVjaWZ5IHN0YXRzIHRvIGJ1ZmYgYW5kIHZhbHVlcyBvZiBidWZmCiAgICAgICAgY29uc3Qgc3RhdHNUb0J1ZmYgPSBbJ1NwZWVkJ107CiAgICAgICAgY29uc3Qgc3RhdHNUb05lcmYgPSBbJ1NwZWVkJ107CiAgICAgICAgY29uc3QgYnVmZkFtb3VudCA9IHRoaXMuZ2V0UmFuZG9tQnVmZkFtb3VudCgpOwogICAgICAgIGNvbnN0IG5lcmZBbW91bnQgPSB0aGlzLmdldFJhbmRvbU5lcmZBbW91bnQoKTsKCiAgICAgICAgLy9mb3JtYXQgYWN0aW9ucwogICAgICAgIGNvbnN0IGJ1ZmZBY3Rpb24gPSB7CiAgICAgICAgICAgIHR5cGU6ICdidWZmJywKICAgICAgICAgICAgdGFyZ2V0czogYWxpdmVTbG93Q2hhcmFjdGVycywKICAgICAgICAgICAgc3RhdHM6IHN0YXRzVG9CdWZmLAogICAgICAgICAgICBhbW91bnQ6IGJ1ZmZBbW91bnQsCiAgICAgICAgICAgIHBsYXllck51bTogc2xvd1BsYXllck51bQogICAgICAgIH07CiAgICAgICAgY29uc3QgbmVyZkFjdGlvbiA9IHsKICAgICAgICAgICAgdHlwZTogJ25lcmYnLAogICAgICAgICAgICB0YXJnZXRzOiBhbGl2ZUZhc3RDaGFyYWN0ZXJzLAogICAgICAgICAgICBzdGF0czogc3RhdHNUb05lcmYsCiAgICAgICAgICAgIGFtb3VudDogbmVyZkFtb3VudCwKICAgICAgICAgICAgcGxheWVyTnVtOiBmYXN0UGxheWVyTnVtCiAgICAgICAgfTsKCiAgICAgICAgY29uc3QgcmFuZG9tTnVtYmVyID0gTWF0aC5yYW5kb20oKTsKCiAgICAgICAgLy9yYW5kb21seSBjaG9vc2UgdG8gYnVmZiwgbmVyZiwgb3IgYm90aAogICAgICAgIGlmIChyYW5kb21OdW1iZXIgPD0gLjMzKSB7IC8vYnVmZgogICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKGJ1ZmZBY3Rpb24pOwogICAgICAgIH0gZWxzZSBpZiAocmFuZG9tTnVtYmVyIDw9IC42NikgeyAvL25lcmYKICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChuZXJmQWN0aW9uKTsKICAgICAgICB9IGVsc2UgeyAvL2JvdGgKICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChidWZmQWN0aW9uKTsKICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChuZXJmQWN0aW9uKTsKICAgICAgICB9CiAgICB9CiAgICBiYWxhbmNlTHVjayhsdWNreVBsYXllciwgdW5sdWNreVBsYXllciwgbG9nLCBhY3Rpb25RdWV1ZSkgewogICAgICAgIC8vY2hlY2sgZm9yIGx2aWluZyBjaGFyYWN0ZXJzCiAgICAgICAgY29uc3QgYWxpdmVMdWNreUNoYXJhY3RlcnMgPSBsdWNreVBsYXllci5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKICAgICAgICBjb25zdCBhbGl2ZVVubHVja3lDaGFyYWN0ZXJzID0gdW5sdWNreVBsYXllci5jaGFyYWN0ZXJzLmZpbHRlcihjaGFyID0+IGNoYXIuaXNBbGl2ZSgpKTsKCiAgICAgICAgaWYgKGFsaXZlTHVja3lDaGFyYWN0ZXJzLmxlbmd0aCA9PT0gMCB8fCBhbGl2ZVVubHVja3lDaGFyYWN0ZXJzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjb25zb2xlLmxvZygiQUkgRGlyZWN0b3I6IE9uZSB0ZWFtIGlzIGRlZmVhdGVkLCBubyBuZWVkIHRvIGJhbGFuY2UuIik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICh0aGlzLm1vZGUgPT0gJ2luY2x1c2lvbicpIHsKCiAgICAgICAgICAgIGNvbnN0IGx1Y2t5UGxheWVyTnVtID0gYWxpdmVMdWNreUNoYXJhY3RlcnNbMF0ucGxheWVyOwogICAgICAgICAgICBjb25zdCB1bmx1Y2t5UGxheWVyTnVtID0gYWxpdmVVbmx1Y2t5Q2hhcmFjdGVyc1swXS5wbGF5ZXI7CgogICAgICAgICAgICAvL3NwZWNpZnkgc3RhdHMgdG8gYnVmZiBhbmQgdmFsdWVzIG9mIGJ1ZmYKICAgICAgICAgICAgY29uc3Qgc3RhdHNUb0J1ZmYgPSBbJ0x1Y2snXTsKICAgICAgICAgICAgY29uc3Qgc3RhdHNUb05lcmYgPSBbJ0x1Y2snXTsKICAgICAgICAgICAgY29uc3QgYnVmZkFtb3VudCA9IHRoaXMuZ2V0UmFuZG9tQnVmZkFtb3VudCgpOwogICAgICAgICAgICBjb25zdCBuZXJmQW1vdW50ID0gdGhpcy5nZXRSYW5kb21OZXJmQW1vdW50KCk7CgogICAgICAgICAgICAvL2Zvcm1hdCBhY3Rpb25zCiAgICAgICAgICAgIGNvbnN0IGJ1ZmZBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnYnVmZicsCiAgICAgICAgICAgICAgICB0YXJnZXRzOiBhbGl2ZVVubHVja3lDaGFyYWN0ZXJzLAogICAgICAgICAgICAgICAgc3RhdHM6IHN0YXRzVG9CdWZmLAogICAgICAgICAgICAgICAgYW1vdW50OiBidWZmQW1vdW50LAogICAgICAgICAgICAgICAgcGxheWVyTnVtOiB1bmx1Y2t5UGxheWVyTnVtCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNvbnN0IG5lcmZBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICB0eXBlOiAnbmVyZicsCiAgICAgICAgICAgICAgICB0YXJnZXRzOiBhbGl2ZUx1Y2t5Q2hhcmFjdGVycywKICAgICAgICAgICAgICAgIHN0YXRzOiBzdGF0c1RvTmVyZiwKICAgICAgICAgICAgICAgIGFtb3VudDogbmVyZkFtb3VudCwKICAgICAgICAgICAgICAgIHBsYXllck51bTogbHVja3lQbGF5ZXJOdW0KICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGNvbnN0IHJhbmRvbU51bWJlciA9IE1hdGgucmFuZG9tKCk7CgogICAgICAgICAgICAvL3JhbmRvbWx5IGNob29zZSB0byBidWZmLCBuZXJmLCBvciBib3RoCiAgICAgICAgICAgIGlmIChyYW5kb21OdW1iZXIgPD0gLjMzKSB7IC8vYnVmZgogICAgICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChidWZmQWN0aW9uKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChyYW5kb21OdW1iZXIgPD0gLjY2KSB7IC8vbmVyZgogICAgICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChuZXJmQWN0aW9uKTsKICAgICAgICAgICAgfSBlbHNlIHsgLy9ib3RoCiAgICAgICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKGJ1ZmZBY3Rpb24pOwogICAgICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChuZXJmQWN0aW9uKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb2RlID09ICdkaWZmaWN1bHR5JykgewogICAgICAgICAgICBjb25zdCBzdGF0c1RvQmFsYW5jZSA9IFsnTHVjayddOwogICAgICAgICAgICAvL2dldCByYXcgYW1vdW50IHRvIGJhbGFuY2UKICAgICAgICAgICAgY29uc3QgcmF3U3RhdENoYW5nZUFtb3VudCA9IHRoaXMuZ2V0UmFuZG9tQnVmZkFtb3VudCgpOwogICAgICAgICAgICAvL2J1ZmZlciBhZ2FpbnN0IHRoZSBtYWduaXR1ZGUgb2YgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0YXJnZXQgYW5kIGRlc2lyZWQKICAgICAgICAgICAgY29uc3Qgc3RhdENoYW5nZSA9IHJhd1N0YXRDaGFuZ2VBbW91bnQgKiBNYXRoLmFicyh0aGlzLmJhbGFuY2VNYWduaXR1ZGUpICogdGhpcy5kaWZmaWN1bHR5QWRqdXN0bWVudFNjYWxhcjsKICAgICAgICAgICAgLy9Db25jYXRlbmF0ZSBjaGFyYWN0ZXIgYXJyYXlzIGFzIHdlIGFyZSB0YXJnZXRpbmcgYWxsIGNoYXJhY3RlcnMKICAgICAgICAgICAgY29uc3QgdGFyZ2V0cyA9IGFsaXZlTHVja3lDaGFyYWN0ZXJzLmNvbmNhdChhbGl2ZVVubHVja3lDaGFyYWN0ZXJzKTsKICAgICAgICAgICAgLy9BZGQgcGxheWVyIHN0cmluZ3MgdG9nZXRoZXIKICAgICAgICAgICAgY29uc3QgcGxheWVyTnVtID0gYWxpdmVMdWNreUNoYXJhY3RlcnNbMF0ucGxheWVyICsgIiwgIiArIGFsaXZlVW5sdWNreUNoYXJhY3RlcnNbMF0ucGxheWVyOwoKCiAgICAgICAgICAgIC8vaWYgYWN0aW9uQ2hhbmdlRGlmZmVyZW5jZSBwb3NpdGl2ZSwgbmVyZgogICAgICAgICAgICBpZiAodGhpcy5iYWxhbmNlTWFnbml0dWRlIDw9IDApIHsKICAgICAgICAgICAgICAgIGNvbnN0IGJ1ZmZBY3Rpb24gPSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2J1ZmYnLAogICAgICAgICAgICAgICAgICAgIHRhcmdldHM6IHRhcmdldHMsCiAgICAgICAgICAgICAgICAgICAgc3RhdHM6IHN0YXRzVG9CYWxhbmNlLAogICAgICAgICAgICAgICAgICAgIGFtb3VudDogc3RhdENoYW5nZSwKICAgICAgICAgICAgICAgICAgICBwbGF5ZXJOdW06IHBsYXllck51bQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYWN0aW9uUXVldWUucHVzaChidWZmQWN0aW9uKTsKICAgICAgICAgICAgfSBlbHNlIHsgLy9uZWdhdGl2ZSwgYnVmZgogICAgICAgICAgICAgICAgY29uc3QgbmVyZkFjdGlvbiA9IHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnbmVyZicsCiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0czogdGFyZ2V0cywKICAgICAgICAgICAgICAgICAgICBzdGF0czogc3RhdHNUb0JhbGFuY2UsCiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBzdGF0Q2hhbmdlLAogICAgICAgICAgICAgICAgICAgIHBsYXllck51bTogcGxheWVyTnVtCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBhY3Rpb25RdWV1ZS5wdXNoKG5lcmZBY3Rpb24pOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIk5vIHZhbGlkIGJhbGFuY2luZyBtb2RlIHNwZWNpZmllZCEiKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgIH0KCn0",
					"AQAAAAAAAAABAAAAPAEAAAAAAADVTgAAAAAAAAAAAAAAAPC/"
				],
				[
					148,
					1,
					"",
					null,
					"BAAAALjQAAAAAAAAwtAAAAAAAAALAAAAQUlfRGlyZWN0b3I40AAAAAAAAELQAAAAAAAACwAAAEFJX0RpcmVjdG9yvs8AAAAAAADIzwAAAAAAAAsAAABBSV9EaXJlY3RvcvW5AAAAAAAA/7kAAAAAAAALAAAAQUlfRGlyZWN0b3I",
					"AQAAAAAAAAABAAAA9bkAAAAAAAAAugAAAAAAAAAAAAAAAPC/"
				],
				[
					151,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BgAAADoBAAAAAAAAOwEAAAAAAAAAAAAAOwEAAAAAAAA8AQAAAAAAAAAAAAA8AQAAAAAAAD0BAAAAAAAAAAAAAD0BAAAAAAAAPgEAAAAAAAAAAAAAPgEAAAAAAAA/AQAAAAAAAAAAAAA/AQAAAAAAAEABAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAOgEAAAAAAAA6AQAAAAAAAAAAAAAAAPC/"
				],
				[
					152,
					1,
					"insert",
					{
						"characters": " AIDirector"
					},
					"CwAAAEABAAAAAAAAQQEAAAAAAAAAAAAAQQEAAAAAAABCAQAAAAAAAAAAAABCAQAAAAAAAEMBAAAAAAAAAAAAAEMBAAAAAAAARAEAAAAAAAAAAAAARAEAAAAAAABFAQAAAAAAAAAAAABFAQAAAAAAAEYBAAAAAAAAAAAAAEYBAAAAAAAARwEAAAAAAAAAAAAARwEAAAAAAABIAQAAAAAAAAAAAABIAQAAAAAAAEkBAAAAAAAAAAAAAEkBAAAAAAAASgEAAAAAAAAAAAAASgEAAAAAAABLAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAQAEAAAAAAABAAQAAAAAAAAAAAAAAAPC/"
				],
				[
					153,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAEsBAAAAAAAATAEAAAAAAAAAAAAATAEAAAAAAABNAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAASwEAAAAAAABLAQAAAAAAAAAAAAAAAPC/"
				],
				[
					154,
					1,
					"insert",
					{
						"characters": " require"
					},
					"CAAAAE0BAAAAAAAATgEAAAAAAAAAAAAATgEAAAAAAABPAQAAAAAAAAAAAABPAQAAAAAAAFABAAAAAAAAAAAAAFABAAAAAAAAUQEAAAAAAAAAAAAAUQEAAAAAAABSAQAAAAAAAAAAAABSAQAAAAAAAFMBAAAAAAAAAAAAAFMBAAAAAAAAVAEAAAAAAAAAAAAAVAEAAAAAAABVAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATQEAAAAAAABNAQAAAAAAAAAAAAAAAPC/"
				],
				[
					155,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFUBAAAAAAAAVwEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAVQEAAAAAAABVAQAAAAAAAAAAAAAAAPC/"
				],
				[
					156,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAAFYBAAAAAAAAWAEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAVgEAAAAAAABWAQAAAAAAAAAAAAAAAPC/"
				],
				[
					157,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAAFcBAAAAAAAAWAEAAAAAAAAAAAAAWAEAAAAAAABZAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAVwEAAAAAAABXAQAAAAAAAAAAAAAAAPC/"
				],
				[
					158,
					1,
					"left_delete",
					null,
					"AQAAAFgBAAAAAAAAWAEAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAWQEAAAAAAABZAQAAAAAAAAAAAAAAAPC/"
				],
				[
					159,
					1,
					"insert",
					{
						"characters": "/agents/AID"
					},
					"CwAAAFgBAAAAAAAAWQEAAAAAAAAAAAAAWQEAAAAAAABaAQAAAAAAAAAAAABaAQAAAAAAAFsBAAAAAAAAAAAAAFsBAAAAAAAAXAEAAAAAAAAAAAAAXAEAAAAAAABdAQAAAAAAAAAAAABdAQAAAAAAAF4BAAAAAAAAAAAAAF4BAAAAAAAAXwEAAAAAAAAAAAAAXwEAAAAAAABgAQAAAAAAAAAAAABgAQAAAAAAAGEBAAAAAAAAAAAAAGEBAAAAAAAAYgEAAAAAAAAAAAAAYgEAAAAAAABjAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWAEAAAAAAABYAQAAAAAAAAAAAAAAAPC/"
				],
				[
					160,
					1,
					"insert",
					{
						"characters": "irector"
					},
					"BwAAAGMBAAAAAAAAZAEAAAAAAAAAAAAAZAEAAAAAAABlAQAAAAAAAAAAAABlAQAAAAAAAGYBAAAAAAAAAAAAAGYBAAAAAAAAZwEAAAAAAAAAAAAAZwEAAAAAAABoAQAAAAAAAAAAAABoAQAAAAAAAGkBAAAAAAAAAAAAAGkBAAAAAAAAagEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAYwEAAAAAAABjAQAAAAAAAAAAAAAAAPC/"
				],
				[
					162,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAGwBAAAAAAAAbQEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbAEAAAAAAABsAQAAAAAAAAAAAAAAAPC/"
				],
				[
					165,
					1,
					"left_delete",
					null,
					"AQAAADcAAAAAAAAANwAAAAAAAAApAAAACmNvbnN0IHNzID0gcmVxdWlyZSgnc2ltcGxlLXN0YXRpc3RpY3MnKTs",
					"AQAAAAAAAAABAAAAYAAAAAAAAAA3AAAAAAAAAAAAAAAAAPC/"
				],
				[
					170,
					1,
					"cut",
					null,
					"AQAAAEgBAAAAAAAASAEAAAAAAABEuAAAY2xhc3MgR2FtZSB7CiAgICBjb25zdHJ1Y3RvcihwbGF5ZXJzLCBhaURpcmVjdG9yLCBzZWVkLCBkaXJlY3RvckFjdGlvbkludGVydmFsID0gOSwgYWN0aW9uRXhlY3V0aW9uSW50ZXJ2YWwgPSAzKSB7CiAgICAgICAgdGhpcy5wbGF5ZXJzID0gcGxheWVyczsKICAgICAgICB0aGlzLmFpRGlyZWN0b3IgPSBhaURpcmVjdG9yOwogICAgICAgIHRoaXMuYWN0aW9uUXVldWUgPSBbXTsKICAgICAgICB0aGlzLnRpbWVTdGVwID0gMDsKICAgICAgICB0aGlzLnJuZyA9IG5ldyBSTkcoc2VlZCk7IC8vIEluaXRpYWxpemUgdGhlIFJORyB3aXRoIHRoZSBzZWVkCiAgICAgICAgdGhpcy5sb2cgPSBbXTsgLy8gSW5pdGlhbGl6ZSBhbiBlbXB0eSBsb2cgYXJyYXkgdG8gaG9sZCB0aW1lIHN0ZXAgZGV0YWlscwogICAgICAgIHRoaXMuZGlyZWN0b3JBY3Rpb25JbnRlcnZhbCA9IGRpcmVjdG9yQWN0aW9uSW50ZXJ2YWw7IC8vIEhvdyBvZnRlbiB0aGUgZGlyZWN0b3IgYWN0cwogICAgICAgIHRoaXMuYWN0aW9uRXhlY3V0aW9uSW50ZXJ2YWwgPSBhY3Rpb25FeGVjdXRpb25JbnRlcnZhbDsgLy8gSG93IG9mdGVuIGFjdGlvbnMgYXJlIGV4ZWN1dGVkIGZyb20gdGhlIHF1ZXVlCiAgICAgICAgdGhpcy5nYW1lU3RhdGUgPSB7CgogICAgICAgICAgICBwcmV2VG90YWxQbGF5ZXJBY3Rpb25zOiAwLAogICAgICAgICAgICB0b3RhbFBsYXllckFjdGlvbnM6IDAsCiAgICAgICAgICAgIHRvdGFsUGxheWVyRGFtYWdlT3V0OiAwLAogICAgICAgICAgICBhY3Rpb25DdXJySFBEYXRhOiBbXSwKCiAgICAgICAgICAgIHBsYXllcjFEYXRhOiB7CiAgICAgICAgICAgICAgICB0b3RhbEhQOiAwLAogICAgICAgICAgICAgICAgY3VycmVudEhQOiAwLAogICAgICAgICAgICAgICAgcHJldkN1cnJlbnRIUDogMCwgLy91c2VkIHRvIGNhbGN1bGF0ZSBsYXN0IHR1cm4ncyBIUCBjaGFuZ2UKICAgICAgICAgICAgICAgIGhwUmF0aW86IDAsCiAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgY2hhcmFjdGVyRGF0YTogewogICAgICAgICAgICAgICAgICAgIG1hZ2U6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHdhcnJpb3I6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHByaWVzdDogewogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VPdXQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVJhdGlvOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25SYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgaHBSYXRpbzogMAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgcm9ndWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHBsYXllcjJEYXRhOiB7CiAgICAgICAgICAgICAgICB0b3RhbEhQOiAwLAogICAgICAgICAgICAgICAgY3VycmVudEhQOiAwLAogICAgICAgICAgICAgICAgcHJldkN1cnJlbnRIUDogMCwKICAgICAgICAgICAgICAgIGhwUmF0aW86IDAsCiAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgY2hhcmFjdGVyRGF0YTogewogICAgICAgICAgICAgICAgICAgIG1hZ2U6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHdhcnJpb3I6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHByaWVzdDogewogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VPdXQ6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZVJhdGlvOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25SYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgaHBSYXRpbzogMAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgcm9ndWU6IHsKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlT3V0OiAwLAogICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25zOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2VSYXRpbzogMCwKICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uUmF0aW86IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGhwUmF0aW86IDAKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgICAgIGlmICh0aGlzLmFpRGlyZWN0b3IpIHsKICAgICAgICAgICAgdGhpcy5haURpcmVjdG9yLmdhbWVTdGF0ZSA9IHRoaXMuZ2FtZVN0YXRlOwogICAgICAgIH0KICAgIH0KCiAgICBjaGVja0dhbWVPdmVyKCkgewogICAgICAgIGZvciAobGV0IHBsYXllciBvZiB0aGlzLnBsYXllcnMpIHsKICAgICAgICAgICAgaWYgKHBsYXllci5jaGFyYWN0ZXJzLmV2ZXJ5KGMgPT4gIWMuaXNBbGl2ZSgpKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHBsYXllci5wbGF5ZXJOdW1iZXI7IC8vIFJldHVybiB0aGUgcGxheWVyIG51bWJlciB3aG8gbG9zdAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBudWxsOyAvLyBObyBwbGF5ZXIgaGFzIGxvc3QgeWV0CiAgICB9CgoKICAgIGVucXVldWVBY3Rpb24ocGxheWVyLCBjaGFyYWN0ZXIpIHsKICAgICAgICBpZiAoIWNoYXJhY3Rlci5pc0FsaXZlKCkpIHsKICAgICAgICAgICAgcmV0dXJuOyAvLyBTa2lwIGVucXVldWluZyB0aGUgYWN0aW9uIGlmIHRoZSBjaGFyYWN0ZXIgaXMgZGVhZAogICAgICAgIH0KCiAgICAgICAgY29uc3Qgb3Bwb25lbnQgPSB0aGlzLnBsYXllcnMuZmluZChwID0+IHAgIT09IHBsYXllcik7CiAgICAgICAgY29uc3QgY2hvc2VuQWN0aW9uID0gcGxheWVyLmNob29zZUFjdGlvbihjaGFyYWN0ZXIsIG9wcG9uZW50LmNoYXJhY3RlcnMpOwogICAgICAgIGlmICghY2hvc2VuQWN0aW9uKSByZXR1cm47CgogICAgICAgIGNvbnN0IHRhcmdldHMgPSB0aGlzLmdldFRhcmdldHMoY2hhcmFjdGVyLCBjaG9zZW5BY3Rpb24sIG9wcG9uZW50LmNoYXJhY3RlcnMsIHBsYXllci5jaGFyYWN0ZXJzKTsKICAgICAgICB0aGlzLmFjdGlvblF1ZXVlLnB1c2goewogICAgICAgICAgICBjaGFyYWN0ZXIsCiAgICAgICAgICAgIGNob3NlbkFjdGlvbiwKICAgICAgICAgICAgdGFyZ2V0cywKICAgICAgICAgICAgY2hvc2VuQWN0aW9uCiAgICAgICAgfSk7CiAgICB9CgogICAgcHJvY2Vzc1R1cm4oKSB7CiAgICAgICAgdGhpcy50aW1lU3RlcCsrOwoKICAgICAgICAvLyBSZW1vdmUgZGVhZCBjaGFyYWN0ZXJzIGZyb20gYWN0aW9uIHF1ZXVlIC0gYnV0IG9ubHkgZm9yIGNoYXJhY3RlciBhY3Rpb25zCiAgICAgICAgdGhpcy5hY3Rpb25RdWV1ZSA9IHRoaXMuYWN0aW9uUXVldWUuZmlsdGVyKGFjdGlvbiA9PiB7CiAgICAgICAgICAgIHJldHVybiBhY3Rpb24uY2hhcmFjdGVyID8gYWN0aW9uLmNoYXJhY3Rlci5pc0FsaXZlKCkgOiB0cnVlOyAvLyBLZWVwIEFJIERpcmVjdG9yIGFjdGlvbnMKICAgICAgICB9KTsKCiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYWN0aW9uc0V4ZWN1dGVkIGFycmF5CiAgICAgICAgbGV0IGFjdGlvbnNFeGVjdXRlZFRoaXNUdXJuID0gW107CgogICAgICAgIC8vIENhcHR1cmUgdGhlIGdhbWUgc3RhdGUgYXQgdGhpcyB0aW1lIHN0ZXAKICAgICAgICBsZXQgc3RlcExvZyA9IHsKICAgICAgICAgICAgdGltZVN0ZXA6IHRoaXMudGltZVN0ZXAsCiAgICAgICAgICAgIGFjdGlvbnNJblF1ZXVlOiB0aGlzLmFjdGlvblF1ZXVlLm1hcChhY3Rpb24gPT4gewogICAgICAgICAgICAgICAgbGV0IGFjdGlvbkRldGFpbHMgPSB7CiAgICAgICAgICAgICAgICAgICAgcGxheWVyOiBhY3Rpb24uY2hhcmFjdGVyID8gYWN0aW9uLmNoYXJhY3Rlci5wbGF5ZXJOdW1iZXIgOiAnQUkgRGlyZWN0b3InLAogICAgICAgICAgICAgICAgICAgIGNoYXJhY3RlcjogYWN0aW9uLmNoYXJhY3RlciA/IGFjdGlvbi5jaGFyYWN0ZXIubmFtZSA6ICdBSSBEaXJlY3RvcicsCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uVHlwZTogYWN0aW9uLmNob3NlbkFjdGlvbiA/IGFjdGlvbi5jaG9zZW5BY3Rpb24udHlwZSA6IGFjdGlvbi50eXBlLAogICAgICAgICAgICAgICAgICAgIHRhcmdldERldGFpbHM6IGFjdGlvbi50YXJnZXRzID8gYWN0aW9uLnRhcmdldHMubWFwKHRhcmdldCA9PiAoewogICAgICAgICAgICAgICAgICAgICAgICBwbGF5ZXJOdW1iZXI6IHRhcmdldC5wbGF5ZXJOdW1iZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHRhcmdldC5uYW1lCiAgICAgICAgICAgICAgICAgICAgfSkpIDogW10sCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIC8vIEFkZCBBSSBEaXJlY3RvciBzcGVjaWZpYyBkZXRhaWxzIGlmIGl0J3MgYW4gQUkgRGlyZWN0b3IgYWN0aW9uCiAgICAgICAgICAgICAgICBpZiAoYWN0aW9uLnR5cGUgPT09ICdidWZmJyB8fCBhY3Rpb24udHlwZSA9PT0gJ25lcmYnKSB7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uRGV0YWlscy50YXJnZXRQbGF5ZXIgPSBhY3Rpb24ucGxheWVyTnVtOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbkRldGFpbHMudGFyZ2V0Q2hhcmFjdGVyID0gYWN0aW9uLnRhcmdldHM7CiAgICAgICAgICAgICAgICAgICAgYWN0aW9uRGV0YWlscy5zdGF0Q2hhbmdlZCA9IGFjdGlvbi5zdGF0czsKICAgICAgICAgICAgICAgICAgICBhY3Rpb25EZXRhaWxzLmFtb3VudENoYW5nZWQgPSBhY3Rpb24uYW1vdW50OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGFjdGlvbkRldGFpbHM7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICBhY3Rpb25zRXhlY3V0ZWQ6IGFjdGlvbnNFeGVjdXRlZFRoaXNUdXJuLAogICAgICAgICAgICBjaGFyYWN0ZXJzOiB0aGlzLnBsYXllcnMuZmxhdE1hcChwbGF5ZXIgPT4gcGxheWVyLmNoYXJhY3RlcnMubWFwKGNoYXJhY3RlciA9PiAoewogICAgICAgICAgICAgICAgcGxheWVyOiBjaGFyYWN0ZXIucGxheWVyTnVtYmVyLAogICAgICAgICAgICAgICAgbmFtZTogY2hhcmFjdGVyLm5hbWUsCiAgICAgICAgICAgICAgICBjdXJyZW50SFA6IGNoYXJhY3Rlci5zdGF0cy5jdXJyZW50SFAsCiAgICAgICAgICAgICAgICBzdGF0czogey4uLmNoYXJhY3Rlci5zdGF0cwogICAgICAgICAgICAgICAgfSwgLy8gQ2FwdHVyZSBhbGwgc3RhdHMKICAgICAgICAgICAgICAgIGJhc2VTdGF0czogey4uLmNoYXJhY3Rlci5iYXNlU3RhdHMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkpKSwKICAgICAgICAgICAgcXVldWVMZW5ndGg6IHRoaXMuYWN0aW9uUXVldWUubGVuZ3RoLAogICAgICAgICAgICBnYW1lU3RhdGU6IHt9CiAgICAgICAgfTsKCiAgICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2gocGxheWVyID0+IHsKICAgICAgICAgICAgcGxheWVyLmNoYXJhY3RlcnMuZm9yRWFjaChjaGFyYWN0ZXIgPT4gewogICAgICAgICAgICAgICAgaWYgKGNoYXJhY3Rlci5pc0FsaXZlKCkpIHsKICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIuYWRkQWN0aW9uUG9pbnRzKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJhY3Rlci5hY3Rpb25CYXIgPj0gMTAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZW5xdWV1ZUFjdGlvbihwbGF5ZXIsIGNoYXJhY3Rlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5yZXNldEFjdGlvbkJhcigpOwogICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXIucmVzZXREZWZlbnNlKCk7IC8vIFJlc2V0IGRlZmVuc2UgYWZ0ZXIgdGhlIHR1cm4sIGJ1dCBub3QgQUkgYnVmZnMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICAvLyBCYWxhbmNlIHRoZSBnYW1lIGV2ZXJ5IG49ZGlyZWN0b3JBY3Rpb25JbnRlcnZhbCBzdGVwcwogICAgICAgIGlmICh0aGlzLnRpbWVTdGVwICUgdGhpcy5kaXJlY3RvckFjdGlvbkludGVydmFsID09PSAwICYmIHRoaXMuYWlEaXJlY3RvcikgewogICAgICAgICAgICBsZXQgZGlyZWN0b3JBY3Rpb24gPSB0aGlzLmFpRGlyZWN0b3IuYmFsYW5jZUdhbWUodGhpcy5wbGF5ZXJzLCB0aGlzLmxvZywgdGhpcy50aW1lU3RlcCwgdGhpcy5hY3Rpb25RdWV1ZSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSRUFDSEVEIEJBTEFOQ0lORyBPUEVSQVRJT04iKTsKICAgICAgICAgICAgaWYoZGlyZWN0b3JBY3Rpb24pewogICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQUlEaXJlY3RvckFjdGlvbihkaXJlY3RvckFjdGlvbiwgc3RlcExvZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vYmVmb3JlIGV4ZWN1dGluZyBhY3Rpb25zLCBzYXZlIHByZXZpb3VzIHR1cm4ncyBudW1iZXIgb2YgYWN0aW9ucwogICAgICAgIHRoaXMuZ2FtZVN0YXRlLnByZXZUb3RhbFBsYXllckFjdGlvbnMgPSB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnM7CgogICAgICAgIC8vIEV4ZWN1dGUgQWN0aW9ucyBmb3IgdHVybgogICAgICAgIGlmICh0aGlzLnRpbWVTdGVwICUgdGhpcy5hY3Rpb25FeGVjdXRpb25JbnRlcnZhbCA9PT0gMCAmJiB0aGlzLmFjdGlvblF1ZXVlLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgbGV0IGFjdGlvbiA9IHRoaXMuYWN0aW9uUXVldWUuc2hpZnQoKTsKCiAgICAgICAgICAgIGlmIChhY3Rpb24udHlwZSA9PT0gJ2J1ZmYnIHx8IGFjdGlvbi50eXBlID09PSAnbmVyZicgfHwgYWN0aW9uLnR5cGUgPT09ICdoZWFsJyB8fCBhY3Rpb24udHlwZSA9PT0gJ2RhbWFnZScpIHsKICAgICAgICAgICAgLy8gICAgdGhpcy5leGVjdXRlQUlEaXJlY3RvckFjdGlvbihhY3Rpb24sIHN0ZXBMb2cpOyAvLyBIYW5kbGUgQUkgRGlyZWN0b3IgYWN0aW9ucwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy5leGVjdXRlQWN0aW9uKGFjdGlvbiwgc3RlcExvZyk7IC8vIEhhbmRsZSBjaGFyYWN0ZXIgYWN0aW9ucwogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRvdGFsSFAgPSB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jdXJyZW50SFAgKyB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jdXJyZW50SFA7CiAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5hY3Rpb25DdXJySFBEYXRhLnB1c2goW3RoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyQWN0aW9ucywgY3VycmVudFRvdGFsSFBdKTsgLy91cGRhdGUgYmFzZWQgb24gYXJyYXkKICAgICAgICAgICAgfQogICAgICAgIH0KCgoKICAgICAgICAvL3VwZGF0ZSB1c2VmdWwgcGxheWVyIGRhdGEgc3RhdHMKCiAgICAgICAgLy9TZXQgSFAgUmF0aW9zCiAgICAgICAgLy92YXJpYWJsZXMgZm9yIHBsYXllciBIUCByYXRpbwogICAgICAgIGxldCB0b3RhbFBsYXllcjFIUCA9IDA7CiAgICAgICAgbGV0IGN1cnJlbnRQbGF5ZXIxSFAgPSAwOwogICAgICAgIGxldCB0b3RhbFBsYXllcjJIUCA9IDA7CiAgICAgICAgbGV0IGN1cnJlbnRQbGF5ZXIySFAgPSAwOwoKICAgICAgICAvL1VwZGF0ZSBwcmV2Q3VycmVudEhQIGJlZm9yZSB1cGRhdGluZyBjdXJyZW50SFAKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5wcmV2Q3VycmVudEhQID0gdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY3VycmVudEhQOwogICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLnByZXZDdXJyZW50SFAgPSB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jdXJyZW50SFA7CgogICAgICAgIC8vVE9ETzogRml4IHRoaXMgZGF0YSBhY2Nlc3MsIGxvZ2dpbmcgaW1wbGVtZW50YXRpb24gd2FzIGJhZC4uLgogICAgICAgIGlmIChzdGVwTG9nLmNoYXJhY3RlcnMpIHsKICAgICAgICAgICAgZm9yIChsZXQgY2hhcmFjdGVyIG9mIHN0ZXBMb2cuY2hhcmFjdGVycykgewogICAgICAgICAgICAgICAgaWYgKGNoYXJhY3Rlci5wbGF5ZXIgPT0gMSkgewogICAgICAgICAgICAgICAgICAgIHRvdGFsUGxheWVyMUhQICs9IGNoYXJhY3Rlci5zdGF0cy5IUDsKICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGxheWVyMUhQICs9IGNoYXJhY3Rlci5jdXJyZW50SFA7CgogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcmFjdGVyLm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2Fycmlvcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2UnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5ocFJhdGlvID0gY2hhcmFjdGVyLmN1cnJlbnRIUCAvIGNoYXJhY3Rlci5zdGF0cy5IUDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmllc3QnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JvZ3VlJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0b3RhbFBsYXllcjJIUCArPSBjaGFyYWN0ZXIuc3RhdHMuSFA7CiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBsYXllcjJIUCArPSBjaGFyYWN0ZXIuY3VycmVudEhQOwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcmFjdGVyLm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2Fycmlvcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2UnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5ocFJhdGlvID0gY2hhcmFjdGVyLmN1cnJlbnRIUCAvIGNoYXJhY3Rlci5zdGF0cy5IUDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmllc3QnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JvZ3VlJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmhwUmF0aW8gPSBjaGFyYWN0ZXIuY3VycmVudEhQIC8gY2hhcmFjdGVyLnN0YXRzLkhQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEudG90YWxIUCA9IHRvdGFsUGxheWVyMUhQOwogICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY3VycmVudEhQID0gY3VycmVudFBsYXllcjFIUDsKICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLnRvdGFsSFAgPSB0b3RhbFBsYXllcjJIUDsKICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmN1cnJlbnRIUCA9IGN1cnJlbnRQbGF5ZXIySFA7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vUGxheWVyMSBSYXRpb3MKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuZGFtYWdlUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5kYW1hZ2VPdXQsIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyRGFtYWdlT3V0KTsKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuYWN0aW9uUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5hY3Rpb25zLCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMpOwoKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLndhcnJpb3IuZGFtYWdlUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5kYW1hZ2VPdXQsIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyRGFtYWdlT3V0KTsKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLndhcnJpb3IuYWN0aW9uUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5hY3Rpb25zLCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMpOwoKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5kYW1hZ2VSYXRpbyA9IFV0aWxzLnNhZmVEaXZpZGUodGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuZGFtYWdlT3V0LCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckRhbWFnZU91dCk7CiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuYWN0aW9uUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmFjdGlvbnMsIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyQWN0aW9ucyk7CgogICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucm9ndWUuZGFtYWdlUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucm9ndWUuZGFtYWdlT3V0LCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckRhbWFnZU91dCk7CiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5hY3Rpb25SYXRpbyA9IFV0aWxzLnNhZmVEaXZpZGUodGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5hY3Rpb25zLCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMpOwoKICAgICAgICAvL1BsYXllcjIgUmF0aW9zCiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmRhbWFnZVJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuZGFtYWdlT3V0LCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckRhbWFnZU91dCk7CiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmFjdGlvblJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuYWN0aW9ucywgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKTsKCiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmRhbWFnZVJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLndhcnJpb3IuZGFtYWdlT3V0LCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckRhbWFnZU91dCk7CiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmFjdGlvblJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLndhcnJpb3IuYWN0aW9ucywgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKTsKCiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuZGFtYWdlUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmRhbWFnZU91dCwgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJEYW1hZ2VPdXQpOwogICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmFjdGlvblJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5hY3Rpb25zLCB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMpOwoKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZVJhdGlvID0gVXRpbHMuc2FmZURpdmlkZSh0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZU91dCwgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJEYW1hZ2VPdXQpOwogICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEucm9ndWUuYWN0aW9uUmF0aW8gPSBVdGlscy5zYWZlRGl2aWRlKHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEucm9ndWUuYWN0aW9ucywgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKTsKCiAgICAgICAgLy9QbGF5ZXIgSFAgUmF0aW9zCiAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuaHBSYXRpbyA9IGN1cnJlbnRQbGF5ZXIxSFAgLyB0b3RhbFBsYXllcjFIUDsKICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5ocFJhdGlvID0gY3VycmVudFBsYXllcjJIUCAvIHRvdGFsUGxheWVyMkhQOwoKCgogICAgICAgIC8vdXBkYXRlIGdhbWVTdGF0ZSB3aXRoIG5ldyBjaGFuZ2VzIGZyb20gdHVybiBzaW11bGF0aW9uCiAgICAgICAgc3RlcExvZy5nYW1lU3RhdGUgPSBzdHJ1Y3R1cmVkQ2xvbmUodGhpcy5nYW1lU3RhdGUpOwoKICAgICAgICAvLyBQdXNoIHRoZSB0aW1lIHN0ZXAgbG9nIHRvIHRoZSBtYWluIGxvZyBhcnJheQogICAgICAgIHRoaXMubG9nLnB1c2goc3RlcExvZyk7CiAgICB9CgogICAgZXhlY3V0ZUFjdGlvbih7CiAgICAgICAgICAgIGNoYXJhY3RlciwKICAgICAgICAgICAgY2hvc2VuQWN0aW9uLAogICAgICAgICAgICB0YXJnZXRzCiAgICAgICAgfSwgc3RlcExvZykgewogICAgICAgICAgICAvLyBGaWx0ZXIgb3V0IGRlYWQgdGFyZ2V0cwogICAgICAgICAgICBjb25zdCBhbGl2ZVRhcmdldHMgPSB0YXJnZXRzLmZpbHRlcih0YXJnZXQgPT4gdGFyZ2V0LmlzQWxpdmUoKSk7CgogICAgICAgICAgICBpZiAoYWxpdmVUYXJnZXRzLmxlbmd0aCA9PT0gMCAmJiBjaG9zZW5BY3Rpb24udHlwZSAhPT0gJ2RlZmVuZCcpIHsKICAgICAgICAgICAgICAgIHJldHVybjsgLy8gSWYgdGhlcmUgYXJlIG5vIGFsaXZlIHRhcmdldHMsIHNraXAgdGhpcyBhY3Rpb24gZW50aXJlbHkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy91cGRhdGUgZGF0YSBmb3IgYWN0aW9ucyB0YWtlbgogICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckFjdGlvbnMrKzsKICAgICAgICAgICAgaWYgKGNoYXJhY3Rlci5wbGF5ZXJOdW1iZXIgPT09IDEpIHsKICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmFjdGlvbnMrKzsKICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcmFjdGVyLm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmFjdGlvbnMrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWdlJzoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmFjdGlvbnMrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmllc3QnOgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5hY3Rpb25zKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAncm9ndWUnOgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmFjdGlvbnMrKzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5hY3Rpb25zKys7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoYXJhY3Rlci5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnd2Fycmlvcic6CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5hY3Rpb25zKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFnZSc6CiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5hY3Rpb25zKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJpZXN0JzoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuYWN0aW9ucysrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JvZ3VlJzoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5hY3Rpb25zKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgYWN0aW9uRGVzY3JpcHRpb24gPSBgW1RpbWUgU3RlcDogJHt0aGlzLnRpbWVTdGVwfV0gJHtjaGFyYWN0ZXIubmFtZX0gZnJvbSBwbGF5ZXIgJHtjaGFyYWN0ZXIucGxheWVyTnVtYmVyfSBpcyB1c2luZyAke2Nob3NlbkFjdGlvbi50eXBlfWA7CiAgICAgICAgICAgIGxldCB0YXJnZXRTdHJpbmcgPSBhbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQucGxheWVyTnVtYmVyfSAtICR7dGFyZ2V0Lm5hbWV9YCkuam9pbigiLCAiKTsKICAgICAgICAgICAgbGV0IGRhbWFnZSA9IDA7CiAgICAgICAgICAgIGxldCBoZWFsQW1vdW50ID0gMDsKICAgICAgICAgICAgbGV0IGF0dGFja2luZ1N0YXQgPSAwOwogICAgICAgICAgICBsZXQgZGVmZW5kaW5nU3RhdCA9IDA7CiAgICAgICAgICAgIGxldCBtaW5BdHRhY2sgPSAwOyAvLyBJbml0aWFsaXplCiAgICAgICAgICAgIGxldCBtaW5EZWZlbnNlID0gMDsgLy8gSW5pdGlhbGl6ZQogICAgICAgICAgICBsZXQgYXZnRGVmID0gMDsgLy8gSW5pdGlhbGl6ZQogICAgICAgICAgICBsZXQgbWluSGVhbCA9IDA7IC8vIEluaXRpYWxpemUKICAgICAgICAgICAgbGV0IGF2Z011bHRpRGVmID0gMDsgLy8gSW5pdGlhbGl6ZQogICAgICAgICAgICBsZXQgbWluTXVsdGlIZWFsID0gMDsgLy8gSW5pdGlhbGl6ZQogICAgICAgICAgICBsZXQgcmF3RGFtYWdlID0gMDsgLy8gSW5pdGlhbGl6ZQogICAgICAgICAgICBsZXQgcmF3SGVhbCA9IDA7CiAgICAgICAgICAgIGxldCBwcmVTY2FsYXJIZWFsID0gMDsKICAgICAgICAgICAgY29uc3QgZGVmZWF0ZWRDaGFyYWN0ZXJzID0gW107IC8vIEtlZXAgdHJhY2sgb2YgZGVmZWF0ZWQgY2hhcmFjdGVycyBpbiB0aGlzIGFjdGlvbgoKICAgICAgICAgICAgLy9UT0RPOiBDb252ZXJ0IHRvIGNvbnN0YW50cyBvciBwYXJhbWV0ZXJzIGRlZmluZWQgYnkgY2hhcmFjdGVyJ3MgaGlnaGVzdCBIUCB2YWx1ZS4KICAgICAgICAgICAgbGV0IG1pbkhQQ2hhbmdlID0gMTsKICAgICAgICAgICAgbGV0IG1heEhQQ2hhbmdlID0gNjU7CgogICAgICAgICAgICAvL1RPRE86IENhbGN1bGF0ZSBjb25zdGFudHMgZm9yIGNsYW1wIHZhbHVlcyBhaGVhZCBvZiB0aW1lIGluc3RlYWQgb2YgaGFyZGNvZGluZyBiZWxvdwogICAgICAgICAgICBsZXQgbWluQ2xhbXAgPSAwOwogICAgICAgICAgICBsZXQgbWF4Q2xhbXAgPSAwOwoKICAgICAgICAgICAgc3dpdGNoIChjaG9zZW5BY3Rpb24udHlwZSkgewogICAgICAgICAgICAgICAgY2FzZSAnYXR0YWNrJzoKICAgICAgICAgICAgICAgICAgICAvLyAxLiBEZXRlcm1pbmUgbWluaW11bSBwb3NzaWJsZSBhdHRhY2s6IHN0YXQgLSAoc3RhdCAqICgxLWx1Y2svMTAwKSkKICAgICAgICAgICAgICAgICAgICBtaW5BdHRhY2sgPSBjaGFyYWN0ZXIuc3RhdHMuQXR0YWNrIC0gKGNoYXJhY3Rlci5zdGF0cy5BdHRhY2sgKiAoMSAtIGNoYXJhY3Rlci5zdGF0cy5MdWNrIC8gMTAwKSk7CiAgICAgICAgICAgICAgICAgICAgLy8gMi4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgZGFtYWdlIGFuZCBiYXNlIHN0YXQKICAgICAgICAgICAgICAgICAgICBhdHRhY2tpbmdTdGF0ID0gbWluQXR0YWNrICsgdGhpcy5nZXRSYW5kb20oKSAqIChjaGFyYWN0ZXIuc3RhdHMuQXR0YWNrIC0gbWluQXR0YWNrKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIG1pbmltdW0gcG9zc2libGUgZGVmZW5zZTogc3RhdCAtIChzdGF0ICogKDEtbHVjay8xMDApKQogICAgICAgICAgICAgICAgICAgIG1pbkRlZmVuc2UgPSB0YXJnZXRzWzBdLnN0YXRzLkRlZmVuc2UgLSAodGFyZ2V0c1swXS5zdGF0cy5EZWZlbnNlICogKDEgLSB0YXJnZXRzWzBdLnN0YXRzLkx1Y2sgLyAxMDApKTsKICAgICAgICAgICAgICAgICAgICAvLyAyLiByYW5kb21seSBwaWNrIChiYXNlZCBvZmYgb2YgZ2FtZSBzZWVkKSBhIHZhbHVlIGJldHdlZW4gbWluaW11bSBwb3NzaWJsZSBkYW1hZ2UgYW5kIGJhc2Ugc3RhdAogICAgICAgICAgICAgICAgICAgIGRlZmVuZGluZ1N0YXQgPSBtaW5EZWZlbnNlICsgdGhpcy5nZXRSYW5kb20oKSAqICh0YXJnZXRzWzBdLnN0YXRzLkRlZmVuc2UgLSBtaW5EZWZlbnNlKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIHJhdyBkYW1hZ2UsIGNsYW1wLCBhbmQgbWFwIHRvIHRoZSAxLTY1IHJhbmdlCiAgICAgICAgICAgICAgICAgICAgcmF3RGFtYWdlID0gKGF0dGFja2luZ1N0YXQgLSBkZWZlbmRpbmdTdGF0KTsKCiAgICAgICAgICAgICAgICAgICAgLy9taW4gdmFsIC0gLTkwLCBpZiBhdGsgPSAxMCBhbmQgZGVmID0gMTAwOyBtYXggdmFsIC0gOTAsIGlmIGF0ayA9IDEwMCBhbmQgZGVmID0gMTAKICAgICAgICAgICAgICAgICAgICBtaW5DbGFtcCA9IC05MDsKICAgICAgICAgICAgICAgICAgICBtYXhDbGFtcCA9IDkwOwoKICAgICAgICAgICAgICAgICAgICByYXdEYW1hZ2UgPSBNYXRoLm1heChtaW5DbGFtcCwgTWF0aC5taW4obWF4Q2xhbXAsIHJhd0RhbWFnZSkpOyAvLyBDbGFtcCBiZXR3ZWVuIC05MCBhbmQgOTAKCiAgICAgICAgICAgICAgICAgICAgZGFtYWdlID0gKFV0aWxzLm1hcChyYXdEYW1hZ2UsIG1pbkNsYW1wLCBtYXhDbGFtcCwgbWluSFBDaGFuZ2UsIG1heEhQQ2hhbmdlKSkgKiBDb25zdGFudHMuU0lOR0xFX1RBUkdFVF9TQ0FMQVI7IC8vIE1hcCB0byAxLTY1CgogICAgICAgICAgICAgICAgICAgIHRhcmdldHNbMF0udGFrZURhbWFnZShNYXRoLmZsb29yKGRhbWFnZSkpOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbkRlc2NyaXB0aW9uICs9IGAgZGVhbGluZyAke01hdGguZmxvb3IoZGFtYWdlKX0gZGFtYWdlIHRvICR7dGFyZ2V0c1swXS5uYW1lfSBmcm9tIHBsYXllciAke3RhcmdldHNbMF0ucGxheWVyTnVtYmVyfWA7CgogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyRGFtYWdlT3V0ICs9IGRhbWFnZTsKICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcmFjdGVyLnBsYXllck51bWJlciA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5kYW1hZ2VPdXQgKz0gZGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoYXJhY3Rlci5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5kYW1hZ2VPdXQgKz0gZGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2UnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncHJpZXN0JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncm9ndWUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5kYW1hZ2VPdXQgKz0gZGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcmFjdGVyLm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3dhcnJpb3InOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbWFnZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuZGFtYWdlT3V0ICs9IGRhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmllc3QnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuZGFtYWdlT3V0ICs9IGRhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyb2d1ZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ211bHRpX2F0dGFjayc6CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYW1hZ2VkVGFyZ2V0TmFtZXMgPSBhbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQubmFtZX0gZnJvbSBwbGF5ZXIgJHt0YXJnZXQucGxheWVyTnVtYmVyfWApOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGFtYWdlRGV0YWlscyA9IFtdOyAvLyBBcnJheSB0byBob2xkIGRhbWFnZSBkZXRhaWxzIGZvciBlYWNoIHRhcmdldAogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG90YWxEYW1hZ2UgPSAwOyAvLyBJbml0aWFsaXplIHRvIHplcm8KCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIGFsaXZlVGFyZ2V0cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIG1pbmltdW0gcG9zc2libGUgYXR0YWNrOiBzdGF0IC0gKHN0YXQgKiAoMS1sdWNrLzEwMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWluQXR0YWNrID0gY2hhcmFjdGVyLnN0YXRzLkF0dGFjayAtIChjaGFyYWN0ZXIuc3RhdHMuQXR0YWNrICogKDEgLSBjaGFyYWN0ZXIuc3RhdHMuTHVjayAvIDEwMCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgZGFtYWdlIGFuZCBiYXNlIHN0YXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhdHRhY2tpbmdTdGF0ID0gbWluQXR0YWNrICsgdGhpcy5nZXRSYW5kb20oKSAqIChjaGFyYWN0ZXIuc3RhdHMuQXR0YWNrIC0gbWluQXR0YWNrKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBEZXRlcm1pbmUgbWluaW11bSBwb3NzaWJsZSBkZWZlbnNlOiBzdGF0IC0gKHN0YXQgKiAoMS1sdWNrLzEwMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWluRGVmZW5zZSA9IHRhcmdldC5zdGF0cy5EZWZlbnNlIC0gKHRhcmdldC5zdGF0cy5EZWZlbnNlICogKDEgLSB0YXJnZXQuc3RhdHMuTHVjayAvIDEwMCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgZGFtYWdlIGFuZCBiYXNlIHN0YXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkZWZlbmRpbmdTdGF0ID0gbWluRGVmZW5zZSArIHRoaXMuZ2V0UmFuZG9tKCkgKiAodGFyZ2V0LnN0YXRzLkRlZmVuc2UgLSBtaW5EZWZlbnNlKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcmF3IGRhbWFnZSwgY2xhbXAsIGFuZCBtYXAgdG8gdGhlIDEtNjUgcmFuZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCByYXdEYW1hZ2UgPSAoYXR0YWNraW5nU3RhdCAtIGRlZmVuZGluZ1N0YXQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9taW4gdmFsIC0gLTkwLCBpZiBhdGsgPSAxMCBhbmQgZGVmID0gMTAwOyBtYXggdmFsIC0gOTAsIGlmIGF0ayA9IDEwMCBhbmQgZGVmID0gMTAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkNsYW1wID0gLTkwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSA5MDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhd0RhbWFnZSA9IE1hdGgubWF4KG1pbkNsYW1wLCBNYXRoLm1pbihtYXhDbGFtcCwgcmF3RGFtYWdlKSk7IC8vIENsYW1wIGJldHdlZW4gLTkwIGFuZCA5MAoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYW1hZ2UgPSAoVXRpbHMubWFwKHJhd0RhbWFnZSwgbWluQ2xhbXAsIG1heENsYW1wLCAxLCA2NSkpOyAvLyBNYXAgdG8gMS02NQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkbWcgPSBNYXRoLmZsb29yKGRhbWFnZSkgKiBDb25zdGFudHMuTVVMVElfVEFSR0VUX1NDQUxBUjsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQudGFrZURhbWFnZShkbWcpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhbWFnZURldGFpbHMucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGRtZwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b3RhbERhbWFnZSArPSBkbWc7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnRvdGFsUGxheWVyRGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcmFjdGVyLnBsYXllck51bWJlciA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjaGFyYWN0ZXIubmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3dhcnJpb3InOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLndhcnJpb3IuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hZ2UnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLm1hZ2UuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3ByaWVzdCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucHJpZXN0LmRhbWFnZU91dCArPSB0b3RhbERhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdyb2d1ZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEucm9ndWUuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmRhbWFnZU91dCArPSB0b3RhbERhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoY2hhcmFjdGVyLm5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmRhbWFnZU91dCArPSB0b3RhbERhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdtYWdlJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmRhbWFnZU91dCArPSB0b3RhbERhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdwcmllc3QnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncm9ndWUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZU91dCArPSB0b3RhbERhbWFnZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkRlc2NyaXB0aW9uID0gYFtUaW1lIFN0ZXA6ICR7dGhpcy50aW1lU3RlcH1dICR7Y2hhcmFjdGVyLm5hbWV9IGZyb20gcGxheWVyICR7Y2hhcmFjdGVyLnBsYXllck51bWJlcn0gaXMgdXNpbmcgbXVsdGlfYXR0YWNrLCBkZWFsaW5nIGRhbWFnZSB0byAke2FsaXZlVGFyZ2V0cy5tYXAodGFyZ2V0ID0+IGAke3RhcmdldC5uYW1lfSAoJHtkYW1hZ2VEZXRhaWxzLmZpbmQoZCA9PiBkLnRhcmdldCA9PT0gdGFyZ2V0Lm5hbWUpLmRhbWFnZX0pYCkuam9pbignLCAnKX1gOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICBjYXNlICdtYWdpY19hdHRhY2snOgogICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIG1pbmltdW0gcG9zc2libGUgYXR0YWNrOiBzdGF0IC0gKHN0YXQgKiAoMS1sdWNrLzEwMCkpCiAgICAgICAgICAgICAgICBtaW5BdHRhY2sgPSBjaGFyYWN0ZXIuc3RhdHMuTWFnaWNBdHRhY2sgLSAoY2hhcmFjdGVyLnN0YXRzLk1hZ2ljQXR0YWNrICogKDEgLSBjaGFyYWN0ZXIuc3RhdHMuTHVjayAvIDEwMCkpOwogICAgICAgICAgICAgICAgLy8gMi4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgZGFtYWdlIGFuZCBiYXNlIHN0YXQKICAgICAgICAgICAgICAgIGF0dGFja2luZ1N0YXQgPSBtaW5BdHRhY2sgKyB0aGlzLmdldFJhbmRvbSgpICogKGNoYXJhY3Rlci5zdGF0cy5NYWdpY0F0dGFjayAtIG1pbkF0dGFjayk7CgogICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIG1pbmltdW0gcG9zc2libGUgZGVmZW5zZTogc3RhdCAtIChzdGF0ICogKDEtbHVjay8xMDApKQogICAgICAgICAgICAgICAgbWluRGVmZW5zZSA9IHRhcmdldHNbMF0uc3RhdHMuTWFnaWNEZWZlbnNlIC0gKHRhcmdldHNbMF0uc3RhdHMuTWFnaWNEZWZlbnNlICogKDEgLSB0YXJnZXRzWzBdLnN0YXRzLkx1Y2sgLyAxMDApKTsKICAgICAgICAgICAgICAgIC8vIDIuIHJhbmRvbWx5IHBpY2sgKGJhc2VkIG9mZiBvZiBnYW1lIHNlZWQpIGEgdmFsdWUgYmV0d2VlbiBtaW5pbXVtIHBvc3NpYmxlIGRhbWFnZSBhbmQgYmFzZSBzdGF0CiAgICAgICAgICAgICAgICBkZWZlbmRpbmdTdGF0ID0gbWluRGVmZW5zZSArIHRoaXMuZ2V0UmFuZG9tKCkgKiAodGFyZ2V0c1swXS5zdGF0cy5NYWdpY0RlZmVuc2UgLSBtaW5EZWZlbnNlKTsKCiAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcmF3IGRhbWFnZSwgY2xhbXAsIGFuZCBtYXAgdG8gdGhlIDEtNjUgcmFuZ2UKICAgICAgICAgICAgICAgIHJhd0RhbWFnZSA9IChhdHRhY2tpbmdTdGF0IC0gZGVmZW5kaW5nU3RhdCk7CgogICAgICAgICAgICAgICAgbWluQ2xhbXAgPSAtOTA7CiAgICAgICAgICAgICAgICBtYXhDbGFtcCA9IDkwOwoKICAgICAgICAgICAgICAgIHJhd0RhbWFnZSA9IE1hdGgubWF4KG1pbkNsYW1wLCBNYXRoLm1pbihtYXhDbGFtcCwgcmF3RGFtYWdlKSk7IC8vIENsYW1wIGJldHdlZW4gLTkwIGFuZCA5MAoKICAgICAgICAgICAgICAgIGRhbWFnZSA9IChVdGlscy5tYXAocmF3RGFtYWdlLCBtaW5DbGFtcCwgbWF4Q2xhbXAsIG1pbkhQQ2hhbmdlLCBtYXhIUENoYW5nZSkpICogQ29uc3RhbnRzLlNJTkdMRV9UQVJHRVRfU0NBTEFSOyAvLyBNYXAgdG8gMS02NQoKICAgICAgICAgICAgICAgIHRhcmdldHNbMF0udGFrZURhbWFnZShNYXRoLmZsb29yKGRhbWFnZSkpOwogICAgICAgICAgICAgICAgYWN0aW9uRGVzY3JpcHRpb24gKz0gYCBkZWFsaW5nICR7TWF0aC5mbG9vcihkYW1hZ2UpfSBkYW1hZ2UgdG8gJHt0YXJnZXRzWzBdLm5hbWV9IGZyb20gcGxheWVyICR7dGFyZ2V0c1swXS5wbGF5ZXJOdW1iZXJ9YDsKCiAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS50b3RhbFBsYXllckRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICBpZiAoY2hhcmFjdGVyLnBsYXllck51bWJlciA9PT0gMSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjaGFyYWN0ZXIubmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdtYWdlJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdwcmllc3QnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5kYW1hZ2VPdXQgKz0gZGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICAncm9ndWUnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIxRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChjaGFyYWN0ZXIubmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS53YXJyaW9yLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdtYWdlJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5tYWdlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdwcmllc3QnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnByaWVzdC5kYW1hZ2VPdXQgKz0gZGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICAncm9ndWUnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdhbWVTdGF0ZS5wbGF5ZXIyRGF0YS5jaGFyYWN0ZXJEYXRhLnJvZ3VlLmRhbWFnZU91dCArPSBkYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnbXVsdGlfbWFnaWNfYXR0YWNrJzoKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBkYW1hZ2VkVGFyZ2V0TmFtZXMgPSBhbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQubmFtZX0gZnJvbSBwbGF5ZXIgJHt0YXJnZXQucGxheWVyTnVtYmVyfWApOwogICAgICAgICAgICAgICAgICAgIGxldCBkYW1hZ2VEZXRhaWxzID0gW107IC8vIEFycmF5IHRvIGhvbGQgZGFtYWdlIGRldGFpbHMgZm9yIGVhY2ggdGFyZ2V0CiAgICAgICAgICAgICAgICAgICAgbGV0IHRvdGFsRGFtYWdlID0gMDsgLy8gSW5pdGlhbGl6ZSB0byB6ZXJvCgogICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgdGFyZ2V0IG9mIGFsaXZlVGFyZ2V0cykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiBEZXRlcm1pbmUgbWluaW11bSBwb3NzaWJsZSBhdHRhY2s6IHN0YXQgLSAoc3RhdCAqICgxLWx1Y2svMTAwKSkKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pbkF0dGFjayA9IGNoYXJhY3Rlci5zdGF0cy5NYWdpY0F0dGFjayAtIChjaGFyYWN0ZXIuc3RhdHMuTWFnaWNBdHRhY2sgKiAoMSAtIGNoYXJhY3Rlci5zdGF0cy5MdWNrIC8gMTAwKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDIuIHJhbmRvbWx5IHBpY2sgKGJhc2VkIG9mZiBvZiBnYW1lIHNlZWQpIGEgdmFsdWUgYmV0d2VlbiBtaW5pbXVtIHBvc3NpYmxlIGRhbWFnZSBhbmQgYmFzZSBzdGF0CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBhdHRhY2tpbmdTdGF0ID0gbWluQXR0YWNrICsgdGhpcy5nZXRSYW5kb20oKSAqIChjaGFyYWN0ZXIuc3RhdHMuTWFnaWNBdHRhY2sgLSBtaW5BdHRhY2spOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIG1pbmltdW0gcG9zc2libGUgZGVmZW5zZTogc3RhdCAtIChzdGF0ICogKDEtbHVjay8xMDApKQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgbWluRGVmZW5zZSA9IHRhcmdldC5zdGF0cy5NYWdpY0RlZmVuc2UgLSAodGFyZ2V0LnN0YXRzLk1hZ2ljRGVmZW5zZSAqICgxIC0gdGFyZ2V0LnN0YXRzLkx1Y2sgLyAxMDApKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgZGFtYWdlIGFuZCBiYXNlIHN0YXQKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRlZmVuZGluZ1N0YXQgPSBtaW5EZWZlbnNlICsgdGhpcy5nZXRSYW5kb20oKSAqICh0YXJnZXQuc3RhdHMuTWFnaWNEZWZlbnNlIC0gbWluRGVmZW5zZSk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWxjdWxhdGUgcmF3IGRhbWFnZSwgY2xhbXAsIGFuZCBtYXAgdG8gdGhlIDEtNjUgcmFuZ2UKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJhd0RhbWFnZSA9IChhdHRhY2tpbmdTdGF0IC0gZGVmZW5kaW5nU3RhdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vbWluIHZhbCAtIC05MCwgaWYgYXRrID0gMTAgYW5kIGRlZiA9IDEwMDsgbWF4IHZhbCAtIDkwLCBpZiBhdGsgPSAxMDAgYW5kIGRlZiA9IDEwCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbkNsYW1wID0gLTkwOwogICAgICAgICAgICAgICAgICAgICAgICBtYXhDbGFtcCA9IDkwOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmF3RGFtYWdlID0gTWF0aC5tYXgobWluQ2xhbXAsIE1hdGgubWluKG1heENsYW1wLCByYXdEYW1hZ2UpKTsgLy8gQ2xhbXAgYmV0d2VlbiAtOTAgYW5kIDkwCgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGFtYWdlID0gKFV0aWxzLm1hcChyYXdEYW1hZ2UsIG1pbkNsYW1wLCBtYXhDbGFtcCwgMSwgNjUpKTsgLy8gTWFwIHRvIDEtNjUKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRtZyA9IE1hdGguZmxvb3IoZGFtYWdlKSAqIENvbnN0YW50cy5NVUxUSV9UQVJHRVRfU0NBTEFSOwogICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQudGFrZURhbWFnZShkbWcpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZGFtYWdlRGV0YWlscy5wdXNoKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0Lm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW1hZ2U6IGRtZwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxEYW1hZ2UgKz0gZG1nOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJEYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJhY3Rlci5wbGF5ZXJOdW1iZXIgPT09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoYXJhY3Rlci5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdtYWdlJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjFEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdwcmllc3QnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICAncm9ndWUnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMURhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGNoYXJhY3Rlci5uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd3YXJyaW9yJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEud2Fycmlvci5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdtYWdlJzogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXRlLnBsYXllcjJEYXRhLmNoYXJhY3RlckRhdGEubWFnZS5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgICdwcmllc3QnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5wcmllc3QuZGFtYWdlT3V0ICs9IHRvdGFsRGFtYWdlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICAncm9ndWUnOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUucGxheWVyMkRhdGEuY2hhcmFjdGVyRGF0YS5yb2d1ZS5kYW1hZ2VPdXQgKz0gdG90YWxEYW1hZ2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBhY3Rpb25EZXNjcmlwdGlvbiA9IGBbVGltZSBTdGVwOiAke3RoaXMudGltZVN0ZXB9XSAke2NoYXJhY3Rlci5uYW1lfSBmcm9tIHBsYXllciAke2NoYXJhY3Rlci5wbGF5ZXJOdW1iZXJ9IGlzIHVzaW5nIG11bHRpX21hZ2ljX2F0dGFjaywgZGVhbGluZyBkYW1hZ2UgdG8gJHthbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQubmFtZX0gKCR7ZGFtYWdlRGV0YWlscy5maW5kKGQgPT4gZC50YXJnZXQgPT09IHRhcmdldC5uYW1lKS5kYW1hZ2V9KWApLmpvaW4oJywgJyl9YDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhc2UgJ2hlYWwnOgogICAgICAgICAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIGF2ZXJhZ2UgZGVmZW5zZQogICAgICAgICAgICAgICAgYXZnRGVmID0gKGNoYXJhY3Rlci5zdGF0cy5NYWdpY0RlZmVuc2UgKyBjaGFyYWN0ZXIuc3RhdHMuRGVmZW5zZSkgLyAyOwogICAgICAgICAgICAgICAgLy8gMi4gQ2FsY3VsYXRlIG1pbmltdW0gcG9zc2libGUgaGVhbCBiYXNlZCBvbiBsdWNrCiAgICAgICAgICAgICAgICBtaW5IZWFsID0gYXZnRGVmICogKGNoYXJhY3Rlci5zdGF0cy5MdWNrIC8gMTAwKTsKICAgICAgICAgICAgICAgIC8vIDMuIHJhbmRvbWx5IHBpY2sgKGJhc2VkIG9mZiBvZiBnYW1lIHNlZWQpIGEgdmFsdWUgYmV0d2VlbiBtaW5pbXVtIHBvc3NpYmxlIGhlYWwgYW5kIGF2ZXJhZ2UgZGVmZW5zZSwgdHVuZSBhZ2FpbnN0IHNjYWxhcgogICAgICAgICAgICAgICAgcmF3SGVhbCA9IChtaW5IZWFsICsgdGhpcy5nZXRSYW5kb20oKSAqIChhdmdEZWYgLSBtaW5IZWFsKSkgKiBDb25zdGFudHMuSEVBTF9TQ0FMQVI7CiAgICAgICAgICAgICAgICAvLyA0LiBjbGFtcCB2YWx1ZXMKCiAgICAgICAgICAgICAgICBtaW5DbGFtcCA9IDEwICogQ29uc3RhbnRzLkhFQUxfU0NBTEFSOwogICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSAxMDAgKiBDb25zdGFudHMuSEVBTF9TQ0FMQVI7CgogICAgICAgICAgICAgICAgcmF3SGVhbCA9IE1hdGgubWF4KG1pbkNsYW1wLCBNYXRoLm1pbihtYXhDbGFtcCwgcmF3SGVhbCkpOyAvLyBjbGFtcCBiZXR3ZWVuIDAgYW5kIDgwCiAgICAgICAgICAgICAgICAvLyA1LiBtYXAgdmFsdWVzCiAgICAgICAgICAgICAgICBoZWFsQW1vdW50ID0gVXRpbHMubWFwKHJhd0hlYWwsIG1pbkNsYW1wLCBtYXhDbGFtcCwgbWluSFBDaGFuZ2UsIG1heEhQQ2hhbmdlKTsKICAgICAgICAgICAgICAgIGhlYWxBbW91bnQgPSBNYXRoLmZsb29yKGhlYWxBbW91bnQpOwogICAgICAgICAgICAgICAgdGFyZ2V0c1swXS5oZWFsKGhlYWxBbW91bnQpOwogICAgICAgICAgICAgICAgYWN0aW9uRGVzY3JpcHRpb24gKz0gYCBoZWFsaW5nICR7dGFyZ2V0c1swXS5uYW1lfSBmcm9tIHBsYXllciAke3RhcmdldHNbMF0ucGxheWVyTnVtYmVyfSBmb3IgJHtoZWFsQW1vdW50fSBoZWFsdGhgOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ211bHRpX2hlYWwnOgogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIC8vIDEuIERldGVybWluZSBhdmVyYWdlIGRlZmVuc2UKICAgICAgICAgICAgICAgICAgICBhdmdEZWYgPSAoY2hhcmFjdGVyLnN0YXRzLk1hZ2ljRGVmZW5zZSArIGNoYXJhY3Rlci5zdGF0cy5EZWZlbnNlKSAvIDI7CiAgICAgICAgICAgICAgICAgICAgLy8gMi4gQ2FsY3VsYXRlIG1pbmltdW0gcG9zc2libGUgaGVhbCBiYXNlZCBvbiBsdWNrCiAgICAgICAgICAgICAgICAgICAgbWluSGVhbCA9IGF2Z0RlZiAqIChjaGFyYWN0ZXIuc3RhdHMuTHVjayAvIDEwMCk7CiAgICAgICAgICAgICAgICAgICAgLy8gMy4gcmFuZG9tbHkgcGljayAoYmFzZWQgb2ZmIG9mIGdhbWUgc2VlZCkgYSB2YWx1ZSBiZXR3ZWVuIG1pbmltdW0gcG9zc2libGUgaGVhbCBhbmQgYXZlcmFnZSBkZWZlbnNlCiAgICAgICAgICAgICAgICAgICAgcmF3SGVhbCA9IChtaW5IZWFsICsgdGhpcy5nZXRSYW5kb20oKSAqIChhdmdEZWYgLSBtaW5IZWFsKSkgKiBDb25zdGFudHMuTVVMVElfSEVBTF9TQ0FMQVI7CgogICAgICAgICAgICAgICAgICAgIG1pbkNsYW1wID0gMTAgKiBDb25zdGFudHMuTVVMVElfSEVBTF9TQ0FMQVI7CiAgICAgICAgICAgICAgICAgICAgbWF4Q2xhbXAgPSAxMDAgKiBDb25zdGFudHMuTVVMVElfSEVBTF9TQ0FMQVI7CgogICAgICAgICAgICAgICAgICAgIC8vIDQuIGNsYW1wIHZhbHVlcwogICAgICAgICAgICAgICAgICAgIHJhd0hlYWwgPSBNYXRoLm1heChtaW5DbGFtcCwgTWF0aC5taW4obWF4Q2xhbXAsIHJhd0hlYWwpKTsgLy8gY2xhbXAgYmV0d2VlbiAwIGFuZCA4MAogICAgICAgICAgICAgICAgICAgIC8vIDUuIG1hcCB2YWx1ZXMKICAgICAgICAgICAgICAgICAgICBoZWFsQW1vdW50ID0gVXRpbHMubWFwKHJhd0hlYWwsIG1pbkNsYW1wLCBtYXhDbGFtcCwgbWluSFBDaGFuZ2UsIG1heEhQQ2hhbmdlKTsKICAgICAgICAgICAgICAgICAgICBoZWFsQW1vdW50ID0gTWF0aC5mbG9vcihoZWFsQW1vdW50KTsKCiAgICAgICAgICAgICAgICAgICAgY29uc3QgaGVhbGVkVGFyZ2V0TmFtZXMgPSBhbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQubmFtZX0gZnJvbSBwbGF5ZXIgJHt0YXJnZXQucGxheWVyTnVtYmVyfWApOwogICAgICAgICAgICAgICAgICAgIGFjdGlvbkRlc2NyaXB0aW9uID0gYFtUaW1lIFN0ZXA6ICR7dGhpcy50aW1lU3RlcH1dICR7Y2hhcmFjdGVyLm5hbWV9IGZyb20gcGxheWVyICR7Y2hhcmFjdGVyLnBsYXllck51bWJlcn0gaXMgdXNpbmcgbXVsdGlfaGVhbCwgbXVsdGktaGVhbGluZyAgJHtoZWFsZWRUYXJnZXROYW1lcy5qb2luKCcsICcpfSBmb3IgJHtoZWFsQW1vdW50fSBoZWFsdGggZWFjaGA7CiAgICAgICAgICAgICAgICAgICAgYWxpdmVUYXJnZXRzLmZvckVhY2godGFyZ2V0ID0+IHRhcmdldC5oZWFsKGhlYWxBbW91bnQpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgY2FzZSAnZGVmZW5kJzoKICAgICAgICAgICAgICAgIGNoYXJhY3Rlci5hcHBseURlZmVuc2VCb29zdCgpOwogICAgICAgICAgICAgICAgYWN0aW9uRGVzY3JpcHRpb24gKz0gYCBkZWZlbmRpbmdgOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjb25zb2xlLmxvZyhhY3Rpb25EZXNjcmlwdGlvbik7CgogICAgICAgIC8vIExvZyB0aGUgZXhlY3V0ZWQgYWN0aW9uIGZvciB0aGlzIHN0ZXAKICAgICAgICBjb25zdCBhY3Rpb25EZXRhaWxzID0gewogICAgICAgICAgICBwbGF5ZXI6IGNoYXJhY3Rlci5wbGF5ZXJOdW1iZXIsCiAgICAgICAgICAgIGNoYXJhY3RlcjogY2hhcmFjdGVyLm5hbWUsCiAgICAgICAgICAgIGFjdGlvblR5cGU6IGNob3NlbkFjdGlvbi50eXBlLAogICAgICAgICAgICB0YXJnZXRzOiBhbGl2ZVRhcmdldHMubWFwKHRhcmdldCA9PiBgJHt0YXJnZXQucGxheWVyTnVtYmVyfSAtICR7dGFyZ2V0Lm5hbWV9YCksCiAgICAgICAgICAgIGRhbWFnZURlYWx0OiBkYW1hZ2UsCiAgICAgICAgICAgIGhlYWxBbW91bnQ6IGhlYWxBbW91bnQKICAgICAgICB9OwogICAgICAgIHN0ZXBMb2cuYWN0aW9uc0V4ZWN1dGVkLnB1c2goYWN0aW9uRGV0YWlscyk7CgogICAgICAgIGFsaXZlVGFyZ2V0cy5mb3JFYWNoKHRhcmdldCA9PiB7CiAgICAgICAgICAgIGlmICghdGFyZ2V0LmlzQWxpdmUoKSkgewogICAgICAgICAgICAgICAgZGVmZWF0ZWRDaGFyYWN0ZXJzLnB1c2godGFyZ2V0KTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICBkZWZlYXRlZENoYXJhY3RlcnMuZm9yRWFjaCh0YXJnZXQgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhgJHt0YXJnZXQubmFtZX0gZnJvbSBwbGF5ZXIgJHt0YXJnZXQucGxheWVyTnVtYmVyfSBoYXMgYmVlbiBkZWZlYXRlZCFgKTsKICAgICAgICB9KTsKICAgICAgICBzdGVwTG9nLmFjdGlvbnNFeGVjdXRlZC5wdXNoKGFjdGlvbkRldGFpbHMpOwogICAgfQoKICAgIGdldFRhcmdldHMoY2hhcmFjdGVyLCBjaG9zZW5BY3Rpb24sIG9wcG9uZW50cywgYWxsaWVzKSB7CiAgICAgICAgbGV0IHRhcmdldCA9IG51bGw7CiAgICAgICAgaWYgKGNob3NlbkFjdGlvbi50eXBlID09PSAnaGVhbCcpIHsKICAgICAgICAgICAgLy8gSGVhbCBzaG91bGQgdGFyZ2V0IG9ubHkgb25lIGFsbHksIGluY2x1ZGluZyB0aGUgY2hhcmFjdGVyIGl0c2VsZgogICAgICAgICAgICBsZXQgdmFsaWRIZWFsVGFyZ2V0cyA9IGFsbGllcy5maWx0ZXIoYyA9PiBjLmlzQWxpdmUoKSk7CgogICAgICAgICAgICAvL1RoZSBjaG9vc2VUYXJnZXQgZnVuY3Rpb24gZnJvbSB0aGUgcGxheWVyIEFJIGlzIHVzZWQgdG8gZGV0ZXJtaW5lIHRoZSBiZXN0IHRhcmdldAogICAgICAgICAgICB0YXJnZXQgPSBjaGFyYWN0ZXIucGxheWVyLmNob29zZVRhcmdldChjaG9zZW5BY3Rpb24sIGNoYXJhY3RlciwgW10sIHZhbGlkSGVhbFRhcmdldHMpOwoKICAgICAgICAgICAgaWYgKHRhcmdldCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFt0YXJnZXRdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChjaG9zZW5BY3Rpb24udHlwZSA9PT0gJ211bHRpX2hlYWwnKSB7CiAgICAgICAgICAgIC8vIE11bHRpLWhlYWwgc2hvdWxkIHRhcmdldCBhbGwgYWxsaWVzLCBpbmNsdWRpbmcgdGhlIGNoYXJhY3RlciBpdHNlbGYKICAgICAgICAgICAgcmV0dXJuIGFsbGllcy5maWx0ZXIoYyA9PiBjLmlzQWxpdmUoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gT3RoZXIgYWN0aW9ucyAoYXR0YWNrLCBtYWdpYykgdGFyZ2V0IG9wcG9uZW50cwogICAgICAgICAgICBpZiAoY2hvc2VuQWN0aW9uLm11bHRpVGFyZ2V0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gb3Bwb25lbnRzLmZpbHRlcihjID0+IGMuaXNBbGl2ZSgpKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBhbGl2ZU9wcG9uZW50cyA9IG9wcG9uZW50cy5maWx0ZXIoYyA9PiBjLmlzQWxpdmUoKSk7IC8vIEFEREVEIFRISVMgTElORQogICAgICAgICAgICAgICAgdGFyZ2V0ID0gY2hhcmFjdGVyLnBsYXllci5jaG9vc2VUYXJnZXQoY2hvc2VuQWN0aW9uLCBjaGFyYWN0ZXIsIGFsaXZlT3Bwb25lbnRzLCBhbGxpZXMpOyAvLyBFRElURUQgVEhJUyBMSU5FCiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFt0YXJnZXRdOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZXhlY3V0ZUFJRGlyZWN0b3JBY3Rpb24oYWN0aW9uLCBzdGVwTG9nKSB7CiAgICAgICAgbGV0IHsKICAgICAgICAgICAgdHlwZSwKICAgICAgICAgICAgdGFyZ2V0cywKICAgICAgICAgICAgc3RhdHMsCiAgICAgICAgICAgIGFtb3VudCwKICAgICAgICAgICAgcGxheWVyTnVtCiAgICAgICAgfSA9IGFjdGlvbjsKICAgICAgICBsZXQgYWN0aW9uRGVzY3JpcHRpb24gPSBgW1RpbWUgU3RlcDogJHt0aGlzLnRpbWVTdGVwfV0gQUkgRGlyZWN0b3IgaXMgdXNpbmcgJHt0eXBlfSBvbiAke3RhcmdldHN9IGZyb20gcGxheWVyICR7cGxheWVyTnVtfWA7CgogICAgICAgIGlmICh0eXBlID09PSAnYnVmZicpIHsKICAgICAgICAgICAgZm9yIChsZXQgdGFyZ2V0IG9mIHRhcmdldHMpIHsKICAgICAgICAgICAgICAgIGZvciAobGV0IHN0YXQgb2Ygc3RhdHMpIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuYmFzZVN0YXRzW3N0YXRdICs9IGFtb3VudDsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3RhdHNbc3RhdF0gKz0gYW1vdW50OwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdGF0c1tzdGF0XSA9IE1hdGgubWluKDEwMCwgTWF0aC5tYXgoMTAsIHRhcmdldC5zdGF0c1tzdGF0XSkpOyAvLyBDYXAgU3RhdHMKICAgICAgICAgICAgICAgICAgICBhY3Rpb25EZXNjcmlwdGlvbiArPSBgIGJ1ZmZpbmcgJHtzdGF0fSBieSAke2Ftb3VudH0uIE5ldyB2YWx1ZTogJHt0YXJnZXQuc3RhdHNbc3RhdF19YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ25lcmYnKSB7CiAgICAgICAgICAgIGZvciAobGV0IHRhcmdldCBvZiB0YXJnZXRzKSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBzdGF0IG9mIHN0YXRzKSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmJhc2VTdGF0c1tzdGF0XSAtPSBhbW91bnQ7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnN0YXRzW3N0YXRdIC09IGFtb3VudDsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3RhdHNbc3RhdF0gPSBNYXRoLm1heCgxMCwgTWF0aC5taW4oMTAwLCB0YXJnZXQuc3RhdHNbc3RhdF0pKTsgLy8gRmxvb3Igc3RhdHMKICAgICAgICAgICAgICAgICAgICBhY3Rpb25EZXNjcmlwdGlvbiArPSBgIG5lcmZpbmcgJHtzdGF0fSBieSAke2Ftb3VudH0uIE5ldyB2YWx1ZTogJHt0YXJnZXQuc3RhdHNbc3RhdF19YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ2hlYWwnKSB7CiAgICAgICAgICAgIGZvciAobGV0IHRhcmdldCBvZiB0YXJnZXRzKSB7CiAgICAgICAgICAgICAgICB0YXJnZXQuc3RhdHNbJ2N1cnJlbnRIUCddICs9IGFtb3VudDsKICAgICAgICAgICAgICAgIHRhcmdldC5zdGF0c1snY3VycmVudEhQJ10gPSBNYXRoLm1pbih0YXJnZXQuYmFzZVN0YXRzWydIUCddLCB0YXJnZXQuc3RhdHNbJ2N1cnJlbnRIUCddKTsKICAgICAgICAgICAgICAgIGFjdGlvbkRlc2NyaXB0aW9uICs9IGAgaGVhbGluZyAnY3VycmVudEhQJyBieSAke2Ftb3VudH0uIE5ldyB2YWx1ZTogJHt0YXJnZXQuc3RhdHNbJ2N1cnJlbnRIUCddfWA7CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdkYW1hZ2UnKSB7CiAgICAgICAgICAgIGZvciAobGV0IHRhcmdldCBvZiB0YXJnZXRzKSB7CiAgICAgICAgICAgICAgICB0YXJnZXQuc3RhdHNbJ2N1cnJlbnRIUCddIC09IGFtb3VudDsKICAgICAgICAgICAgICAgIHRhcmdldC5zdGF0c1snY3VycmVudEhQJ10gPSBNYXRoLm1heCgwLCB0YXJnZXQuc3RhdHNbJ2N1cnJlbnRIUCddKTsKICAgICAgICAgICAgICAgIGFjdGlvbkRlc2NyaXB0aW9uICs9IGAgZGFtYWdpbmcgJ2N1cnJlbnRIUCcgYnkgJHthbW91bnR9LiBOZXcgdmFsdWU6ICR7dGFyZ2V0LnN0YXRzWydjdXJyZW50SFAnXX1gOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKGFjdGlvbkRlc2NyaXB0aW9uKTsKCiAgICAgICAgLy8gTG9nIHRoZSBleGVjdXRlZCBhY3Rpb24gZm9yIHRoaXMgc3RlcAogICAgICAgIGNvbnN0IGFjdGlvbkRldGFpbHMgPSB7CiAgICAgICAgICAgIHBsYXllcjogJ0FJIERpcmVjdG9yJywKICAgICAgICAgICAgY2hhcmFjdGVyOiB0YXJnZXRzLAogICAgICAgICAgICBhY3Rpb25UeXBlOiB0eXBlLAogICAgICAgICAgICBwbGF5ZXJOdW06IHBsYXllck51bSwKICAgICAgICAgICAgc3RhdENoYW5nZWQ6IHN0YXRzLAogICAgICAgICAgICBhbW91bnRDaGFuZ2VkOiBhbW91bnQKICAgICAgICB9OwogICAgICAgIHN0ZXBMb2cuYWN0aW9uc0V4ZWN1dGVkLnB1c2goYWN0aW9uRGV0YWlscyk7CiAgICB9CgogICAgcnVuU2ltdWxhdGlvbihtYXhTdGVwcyA9IEluZmluaXR5KSB7CiAgICAgICAgbGV0IHdpbm5lciA9IG51bGw7CiAgICAgICAgd2hpbGUgKCF3aW5uZXIgJiYgdGhpcy50aW1lU3RlcCA8IG1heFN0ZXBzKSB7CiAgICAgICAgICAgIHRoaXMucHJvY2Vzc1R1cm4oKTsKICAgICAgICAgICAgd2lubmVyID0gdGhpcy5jaGVja0dhbWVPdmVyKCk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCJHYW1lIE92ZXIiKTsKICAgICAgICBpZiAod2lubmVyKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBQbGF5ZXIgJHt3aW5uZXJ9IGxvc3QhYCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2coIkdhbWUgZW5kZWQgZHVlIHRvIG1heCBzdGVwcy4iKTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5sb2codGhpcy5nYW1lU3RhdGUudG90YWxQbGF5ZXJBY3Rpb25zKTsKICAgICAgICB0aGlzLm91dHB1dExvZygpOyAvLyBPdXRwdXQgdGhlIGxvZyBhdCB0aGUgZW5kIG9mIHRoZSBzaW11bGF0aW9uCiAgICB9CgogICAgZ2V0UmFuZG9tKCkgewogICAgICAgIHJldHVybiB0aGlzLnJuZy5uZXh0KCk7IC8vIFVzZSB0aGUgc2VlZGVkIFJORyBmb3IgYW55IHJhbmRvbSB2YWx1ZQogICAgfQoKICAgIG91dHB1dExvZygpIHsKICAgICAgICBjb25zb2xlLmxvZygiUEFVU0lORyBMT0dTLi4uIFRPRE8iKTsKICAgICAgICAvLyBjb25zdCBqc29uTG9nID0gSlNPTi5zdHJpbmdpZnkodGhpcy5sb2csIG51bGwsIDIpOwogICAgICAgIC8vIGNvbnN0IGZpbGVOYW1lID0gYHNpbXVsYXRpb25fbG9nXyR7RGF0ZS5ub3coKX0uanNvbmA7CiAgICAgICAgLy8gY29uc3QgZmlsZVBhdGggPSBwYXRoLmpvaW4odGhpcy5sb2dEaXJlY3RvcnksIGZpbGVOYW1lKTsgLy8gVXNlIHRoZSBsb2cgZGlyZWN0b3J5CgogICAgICAgIC8vIGNvbnNvbGUubG9nKGBTYXZpbmcgbG9nIHRvOiAke2ZpbGVQYXRofWApOwoKICAgICAgICAvLyAvLyBTYXZlIHRoZSBsb2cgdG8gYSBmaWxlIHVzaW5nIGZzLndyaXRlRmlsZVN5bmMoZmlsZU5hbWUsIGpzb25Mb2cpOwogICAgICAgIC8vIGZzLndyaXRlRmlsZVN5bmMoZmlsZVBhdGgsIGpzb25Mb2cpOwogICAgfQp9",
					"AQAAAAAAAAABAAAASAEAAAAAAACMuQAAAAAAAAAAAAAAAPC/"
				],
				[
					173,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BgAAAEQBAAAAAAAARQEAAAAAAAAAAAAARQEAAAAAAABGAQAAAAAAAAAAAABGAQAAAAAAAEcBAAAAAAAAAAAAAEcBAAAAAAAASAEAAAAAAAAAAAAASAEAAAAAAABJAQAAAAAAAAAAAABJAQAAAAAAAEoBAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAARAEAAAAAAABEAQAAAAAAAAAAAAAAAPC/"
				],
				[
					174,
					1,
					"insert",
					{
						"characters": " Game"
					},
					"BQAAAEoBAAAAAAAASwEAAAAAAAAAAAAASwEAAAAAAABMAQAAAAAAAAAAAABMAQAAAAAAAE0BAAAAAAAAAAAAAE0BAAAAAAAATgEAAAAAAAAAAAAATgEAAAAAAABPAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAASgEAAAAAAABKAQAAAAAAAAAAAAAAAPC/"
				],
				[
					175,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAE8BAAAAAAAAUAEAAAAAAAAAAAAAUAEAAAAAAABRAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATwEAAAAAAABPAQAAAAAAAAAAAAAAAPC/"
				],
				[
					176,
					1,
					"insert",
					{
						"characters": " require"
					},
					"CAAAAFEBAAAAAAAAUgEAAAAAAAAAAAAAUgEAAAAAAABTAQAAAAAAAAAAAABTAQAAAAAAAFQBAAAAAAAAAAAAAFQBAAAAAAAAVQEAAAAAAAAAAAAAVQEAAAAAAABWAQAAAAAAAAAAAABWAQAAAAAAAFcBAAAAAAAAAAAAAFcBAAAAAAAAWAEAAAAAAAAAAAAAWAEAAAAAAABZAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUQEAAAAAAABRAQAAAAAAAAAAAAAAAPC/"
				],
				[
					177,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFkBAAAAAAAAWwEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWQEAAAAAAABZAQAAAAAAAAAAAAAAAPC/"
				],
				[
					178,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAAFoBAAAAAAAAXAEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWgEAAAAAAABaAQAAAAAAAAAAAAAAAPC/"
				],
				[
					179,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAAFsBAAAAAAAAXAEAAAAAAAAAAAAAXAEAAAAAAABdAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWwEAAAAAAABbAQAAAAAAAAAAAAAAAPC/"
				],
				[
					180,
					1,
					"insert",
					{
						"characters": "core/Game"
					},
					"CQAAAF0BAAAAAAAAXgEAAAAAAAAAAAAAXgEAAAAAAABfAQAAAAAAAAAAAABfAQAAAAAAAGABAAAAAAAAAAAAAGABAAAAAAAAYQEAAAAAAAAAAAAAYQEAAAAAAABiAQAAAAAAAAAAAABiAQAAAAAAAGMBAAAAAAAAAAAAAGMBAAAAAAAAZAEAAAAAAAAAAAAAZAEAAAAAAABlAQAAAAAAAAAAAABlAQAAAAAAAGYBAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAXQEAAAAAAABdAQAAAAAAAAAAAAAAAPC/"
				],
				[
					182,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAGgBAAAAAAAAaQEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAaAEAAAAAAABoAQAAAAAAAAAAAAAAAPC/"
				],
				[
					27,
					1,
					"left_delete",
					null,
					"BgAAAD8YAAAAAAAAPxgAAAAAAAABAAAALD4YAAAAAAAAPhgAAAAAAAABAAAAND0YAAAAAAAAPRgAAAAAAAABAAAAMzwYAAAAAAAAPBgAAAAAAAABAAAAMjsYAAAAAAAAOxgAAAAAAAABAAAAMToYAAAAAAAAOhgAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAQBgAAAAAAABAGAAAAAAAAAAAAAAAAPC/"
				],
				[
					7,
					1,
					"left_delete",
					null,
					"AwAAAG0BAAAAAAAAbQEAAAAAAAABAAAACmwBAAAAAAAAbAEAAAAAAAABAAAACmsBAAAAAAAAawEAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAbgEAAAAAAABuAQAAAAAAAAAAAAAAAPC/"
				],
				[
					17,
					1,
					"left_delete",
					null,
					"AwAAAHMKAAAAAAAAcwoAAAAAAAC3CwAALy9TVEFUIE1JTi9NQVgKLy8gV0FSUklPUl9NSU5fQVRUQUNLCi8vIFdBUlJJT1JfTUFYX0FUVEFDSwovLyBXQVJSSU9SX01JTl9BVFRBQ0sKLy8gV0FSUklPUl9NQVhfQVRUQUNLCi8vIFdBUlJJT1JfTUlOX0FUVEFDSwovLyBXQVJSSU9SX01BWF9BVFRBQ0sKLy8gV0FSUklPUl9NSU5fQVRUQUNLCi8vIFdBUlJJT1JfTUFYX0FUVEFDSwovLyBXQVJSSU9SX01JTl9BVFRBQ0sKLy8gV0FSUklPUl9NQVhfQVRUQUNLCi8vIFdBUlJJT1JfTUlOX0FUVEFDSwovLyBXQVJSSU9SX01BWF9BVFRBQ0sKLy8gV0FSUklPUl9NSU5fQVRUQUNLCi8vIFdBUlJJT1JfTUFYX0FUVEFDSwoKLy8gLS0tIFRlYW0gQ3JlYXRpb24gRnVuY3Rpb24gLS0tCmNvbnN0IGNyZWF0ZVRlYW0gPSAocGxheWVyTnVtYmVyKSA9PiAoewogICAgY2hhcmFjdGVyczogWwogICAgICAgIG5ldyBDaGFyYWN0ZXIocGxheWVyTnVtYmVyLCAid2FycmlvciIsIHsKICAgICAgICAgICAgSFA6IDEwMCwKICAgICAgICAgICAgQXR0YWNrOiA4MCwKICAgICAgICAgICAgRGVmZW5zZTogODAsCiAgICAgICAgICAgIE1hZ2ljQXR0YWNrOiAyMCwKICAgICAgICAgICAgTWFnaWNEZWZlbnNlOiAyMCwKICAgICAgICAgICAgU3BlZWQ6IDUwLAogICAgICAgICAgICBMdWNrOiAzNQogICAgICAgIH0sIFt7CiAgICAgICAgICAgIHR5cGU6ICdhdHRhY2snLAogICAgICAgICAgICBzY2FsYXI6IENvbnN0YW50cy5TSU5HTEVfVEFSR0VUX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IGZhbHNlCiAgICAgICAgfSwgewogICAgICAgICAgICB0eXBlOiAnbXVsdGlfYXR0YWNrJywKICAgICAgICAgICAgc2NhbGFyOiBDb25zdGFudHMuTVVMVElfVEFSR0VUX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgIHR5cGU6ICdkZWZlbmQnLAogICAgICAgICAgICBzY2FsYXI6IDAsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiBmYWxzZQogICAgICAgIH1dKSwKICAgICAgICBuZXcgQ2hhcmFjdGVyKHBsYXllck51bWJlciwgIm1hZ2UiLCB7CiAgICAgICAgICAgIEhQOiAxMDAsCiAgICAgICAgICAgIEF0dGFjazogMjAsCiAgICAgICAgICAgIERlZmVuc2U6IDIwLAogICAgICAgICAgICBNYWdpY0F0dGFjazogODAsCiAgICAgICAgICAgIE1hZ2ljRGVmZW5zZTogODAsCiAgICAgICAgICAgIFNwZWVkOiA1MCwKICAgICAgICAgICAgTHVjazogMzUKICAgICAgICB9LCBbewogICAgICAgICAgICB0eXBlOiAnbWFnaWNfYXR0YWNrJywKICAgICAgICAgICAgc2NhbGFyOiBDb25zdGFudHMuU0lOR0xFX1RBUkdFVF9TQ0FMQVIsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgICAgdHlwZTogJ211bHRpX21hZ2ljX2F0dGFjaycsCiAgICAgICAgICAgIHNjYWxhcjogQ29uc3RhbnRzLk1VTFRJX1RBUkdFVF9TQ0FMQVIsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiB0cnVlCiAgICAgICAgfSwgewogICAgICAgICAgICB0eXBlOiAnZGVmZW5kJywKICAgICAgICAgICAgc2NhbGFyOiAwLAogICAgICAgICAgICBtdWx0aVRhcmdldDogZmFsc2UKICAgICAgICB9XSksCiAgICAgICAgbmV3IENoYXJhY3RlcihwbGF5ZXJOdW1iZXIsICJwcmllc3QiLCB7CiAgICAgICAgICAgIEhQOiA3NSwKICAgICAgICAgICAgQXR0YWNrOiAyMCwKICAgICAgICAgICAgRGVmZW5zZTogODAsCiAgICAgICAgICAgIE1hZ2ljQXR0YWNrOiAyMCwKICAgICAgICAgICAgTWFnaWNEZWZlbnNlOiA4MCwKICAgICAgICAgICAgU3BlZWQ6IDM1LAogICAgICAgICAgICBMdWNrOiAzNQogICAgICAgIH0sIFt7CiAgICAgICAgICAgIHR5cGU6ICdoZWFsJywKICAgICAgICAgICAgc2NhbGFyOiBDb25zdGFudHMuSEVBTF9TQ0FMQVIsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgICAgdHlwZTogJ211bHRpX2hlYWwnLAogICAgICAgICAgICBzY2FsYXI6IENvbnN0YW50cy5NVUxUSV9IRUFMX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgIHR5cGU6ICdhdHRhY2snLAogICAgICAgICAgICBzY2FsYXI6IENvbnN0YW50cy5TSU5HTEVfVEFSR0VUX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IGZhbHNlCiAgICAgICAgfSwgewogICAgICAgICAgICB0eXBlOiAnbWFnaWNfYXR0YWNrJywKICAgICAgICAgICAgc2NhbGFyOiBDb25zdGFudHMuU0lOR0xFX1RBUkdFVF9TQ0FMQVIsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiBmYWxzZQogICAgICAgIH0sIHsKICAgICAgICAgICAgdHlwZTogJ2RlZmVuZCcsCiAgICAgICAgICAgIHNjYWxhcjogMCwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IGZhbHNlCiAgICAgICAgfV0pLAogICAgICAgIG5ldyBDaGFyYWN0ZXIocGxheWVyTnVtYmVyLCAicm9ndWUiLCB7CiAgICAgICAgICAgIEhQOiA1MCwKICAgICAgICAgICAgQXR0YWNrOiAzNSwKICAgICAgICAgICAgRGVmZW5zZTogMzUsCiAgICAgICAgICAgIE1hZ2ljQXR0YWNrOiAzNSwKICAgICAgICAgICAgTWFnaWNEZWZlbnNlOiAzNSwKICAgICAgICAgICAgU3BlZWQ6IDgwLAogICAgICAgICAgICBMdWNrOiA4MAogICAgICAgIH0sIFt7CiAgICAgICAgICAgIHR5cGU6ICdhdHRhY2snLAogICAgICAgICAgICBzY2FsYXI6IENvbnN0YW50cy5TSU5HTEVfVEFSR0VUX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IGZhbHNlCiAgICAgICAgfSwgewogICAgICAgICAgICB0eXBlOiAnbXVsdGlfYXR0YWNrJywKICAgICAgICAgICAgc2NhbGFyOiBDb25zdGFudHMuTVVMVElfVEFSR0VUX1NDQUxBUiwKICAgICAgICAgICAgbXVsdGlUYXJnZXQ6IHRydWUKICAgICAgICB9LCB7CiAgICAgICAgICAgIHR5cGU6ICdkZWZlbmQnLAogICAgICAgICAgICBzY2FsYXI6IDAsCiAgICAgICAgICAgIG11bHRpVGFyZ2V0OiBmYWxzZQogICAgICAgIH1dKQogICAgXQp9KTtyCgAAAAAAAHIKAAAAAAAAAQAAAApxCgAAAAAAAHEKAAAAAAAAAQAAAAo",
					"AQAAAAAAAAABAAAAKhYAAAAAAABzCgAAAAAAAAAAAAAAAPC/"
				],
				[
					18,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAAHEKAAAAAAAAcgoAAAAAAAAAAAAAcgoAAAAAAABzCgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcQoAAAAAAABxCgAAAAAAAAAAAAAAAPC/"
				],
				[
					21,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BgAAAGkBAAAAAAAAagEAAAAAAAAAAAAAagEAAAAAAABrAQAAAAAAAAAAAABrAQAAAAAAAGwBAAAAAAAAAAAAAGwBAAAAAAAAbQEAAAAAAAAAAAAAbQEAAAAAAABuAQAAAAAAAAAAAABuAQAAAAAAAG8BAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAaQEAAAAAAABpAQAAAAAAAAAAAAAAAPC/"
				],
				[
					22,
					1,
					"insert",
					{
						"characters": " TeamFac"
					},
					"CAAAAG8BAAAAAAAAcAEAAAAAAAAAAAAAcAEAAAAAAABxAQAAAAAAAAAAAABxAQAAAAAAAHIBAAAAAAAAAAAAAHIBAAAAAAAAcwEAAAAAAAAAAAAAcwEAAAAAAAB0AQAAAAAAAAAAAAB0AQAAAAAAAHUBAAAAAAAAAAAAAHUBAAAAAAAAdgEAAAAAAAAAAAAAdgEAAAAAAAB3AQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbwEAAAAAAABvAQAAAAAAAAAAAAAAAPC/"
				],
				[
					23,
					1,
					"insert",
					{
						"characters": "tory"
					},
					"BAAAAHcBAAAAAAAAeAEAAAAAAAAAAAAAeAEAAAAAAAB5AQAAAAAAAAAAAAB5AQAAAAAAAHoBAAAAAAAAAAAAAHoBAAAAAAAAewEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdwEAAAAAAAB3AQAAAAAAAAAAAAAAAPC/"
				],
				[
					24,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAHsBAAAAAAAAfAEAAAAAAAAAAAAAfAEAAAAAAAB9AQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAewEAAAAAAAB7AQAAAAAAAAAAAAAAAPC/"
				],
				[
					25,
					1,
					"insert",
					{
						"characters": " require"
					},
					"CAAAAH0BAAAAAAAAfgEAAAAAAAAAAAAAfgEAAAAAAAB/AQAAAAAAAAAAAAB/AQAAAAAAAIABAAAAAAAAAAAAAIABAAAAAAAAgQEAAAAAAAAAAAAAgQEAAAAAAACCAQAAAAAAAAAAAACCAQAAAAAAAIMBAAAAAAAAAAAAAIMBAAAAAAAAhAEAAAAAAAAAAAAAhAEAAAAAAACFAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAfQEAAAAAAAB9AQAAAAAAAAAAAAAAAPC/"
				],
				[
					26,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAIUBAAAAAAAAhwEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhQEAAAAAAACFAQAAAAAAAAAAAAAAAPC/"
				],
				[
					27,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAAIYBAAAAAAAAiAEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhgEAAAAAAACGAQAAAAAAAAAAAAAAAPC/"
				],
				[
					28,
					1,
					"insert",
					{
						"characters": "."
					},
					"AQAAAIcBAAAAAAAAiAEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhwEAAAAAAACHAQAAAAAAAAAAAAAAAPC/"
				],
				[
					29,
					1,
					"insert",
					{
						"characters": "/core/"
					},
					"BgAAAIgBAAAAAAAAiQEAAAAAAAAAAAAAiQEAAAAAAACKAQAAAAAAAAAAAACKAQAAAAAAAIsBAAAAAAAAAAAAAIsBAAAAAAAAjAEAAAAAAAAAAAAAjAEAAAAAAACNAQAAAAAAAAAAAACNAQAAAAAAAI4BAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAiAEAAAAAAACIAQAAAAAAAAAAAAAAAPC/"
				],
				[
					30,
					1,
					"insert",
					{
						"characters": "TeamFactory"
					},
					"CwAAAI4BAAAAAAAAjwEAAAAAAAAAAAAAjwEAAAAAAACQAQAAAAAAAAAAAACQAQAAAAAAAJEBAAAAAAAAAAAAAJEBAAAAAAAAkgEAAAAAAAAAAAAAkgEAAAAAAACTAQAAAAAAAAAAAACTAQAAAAAAAJQBAAAAAAAAAAAAAJQBAAAAAAAAlQEAAAAAAAAAAAAAlQEAAAAAAACWAQAAAAAAAAAAAACWAQAAAAAAAJcBAAAAAAAAAAAAAJcBAAAAAAAAmAEAAAAAAAAAAAAAmAEAAAAAAACZAQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAjgEAAAAAAACOAQAAAAAAAAAAAAAAAPC/"
				],
				[
					32,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAJsBAAAAAAAAnAEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAmwEAAAAAAACbAQAAAAAAAAAAAAAAAPC/"
				],
				[
					35,
					1,
					"insert",
					{
						"characters": "const"
					},
					"BQAAAKYKAAAAAAAApwoAAAAAAAAAAAAApwoAAAAAAACoCgAAAAAAAAAAAACoCgAAAAAAAKkKAAAAAAAAAAAAAKkKAAAAAAAAqgoAAAAAAAAAAAAAqgoAAAAAAACrCgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApgoAAAAAAACmCgAAAAAAAAAAAAAAAPC/"
				],
				[
					36,
					1,
					"insert",
					{
						"characters": " TeamFactory"
					},
					"DAAAAKsKAAAAAAAArAoAAAAAAAAAAAAArAoAAAAAAACtCgAAAAAAAAAAAACtCgAAAAAAAK4KAAAAAAAAAAAAAK4KAAAAAAAArwoAAAAAAAAAAAAArwoAAAAAAACwCgAAAAAAAAAAAACwCgAAAAAAALEKAAAAAAAAAAAAALEKAAAAAAAAsgoAAAAAAAAAAAAAsgoAAAAAAACzCgAAAAAAAAAAAACzCgAAAAAAALQKAAAAAAAAAAAAALQKAAAAAAAAtQoAAAAAAAAAAAAAtQoAAAAAAAC2CgAAAAAAAAAAAAC2CgAAAAAAALcKAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAqwoAAAAAAACrCgAAAAAAAAAAAAAAAPC/"
				],
				[
					37,
					1,
					"left_delete",
					null,
					"CwAAALYKAAAAAAAAtgoAAAAAAAABAAAAebUKAAAAAAAAtQoAAAAAAAABAAAAcrQKAAAAAAAAtAoAAAAAAAABAAAAb7MKAAAAAAAAswoAAAAAAAABAAAAdLIKAAAAAAAAsgoAAAAAAAABAAAAY7EKAAAAAAAAsQoAAAAAAAABAAAAYbAKAAAAAAAAsAoAAAAAAAABAAAARq8KAAAAAAAArwoAAAAAAAABAAAAba4KAAAAAAAArgoAAAAAAAABAAAAYa0KAAAAAAAArQoAAAAAAAABAAAAZawKAAAAAAAArAoAAAAAAAABAAAAVA",
					"AQAAAAAAAAABAAAAtwoAAAAAAAC3CgAAAAAAAAAAAAAAAPC/"
				],
				[
					38,
					1,
					"insert",
					{
						"characters": "teamFactory"
					},
					"CwAAAKwKAAAAAAAArQoAAAAAAAAAAAAArQoAAAAAAACuCgAAAAAAAAAAAACuCgAAAAAAAK8KAAAAAAAAAAAAAK8KAAAAAAAAsAoAAAAAAAAAAAAAsAoAAAAAAACxCgAAAAAAAAAAAACxCgAAAAAAALIKAAAAAAAAAAAAALIKAAAAAAAAswoAAAAAAAAAAAAAswoAAAAAAAC0CgAAAAAAAAAAAAC0CgAAAAAAALUKAAAAAAAAAAAAALUKAAAAAAAAtgoAAAAAAAAAAAAAtgoAAAAAAAC3CgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAArAoAAAAAAACsCgAAAAAAAAAAAAAAAPC/"
				],
				[
					39,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAALcKAAAAAAAAuAoAAAAAAAAAAAAAuAoAAAAAAAC5CgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtwoAAAAAAAC3CgAAAAAAAAAAAAAAAPC/"
				],
				[
					40,
					1,
					"insert",
					{
						"characters": " new"
					},
					"BAAAALkKAAAAAAAAugoAAAAAAAAAAAAAugoAAAAAAAC7CgAAAAAAAAAAAAC7CgAAAAAAALwKAAAAAAAAAAAAALwKAAAAAAAAvQoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAuQoAAAAAAAC5CgAAAAAAAAAAAAAAAPC/"
				],
				[
					41,
					1,
					"insert",
					{
						"characters": " TeamFactory"
					},
					"DAAAAL0KAAAAAAAAvgoAAAAAAAAAAAAAvgoAAAAAAAC/CgAAAAAAAAAAAAC/CgAAAAAAAMAKAAAAAAAAAAAAAMAKAAAAAAAAwQoAAAAAAAAAAAAAwQoAAAAAAADCCgAAAAAAAAAAAADCCgAAAAAAAMMKAAAAAAAAAAAAAMMKAAAAAAAAxAoAAAAAAAAAAAAAxAoAAAAAAADFCgAAAAAAAAAAAADFCgAAAAAAAMYKAAAAAAAAAAAAAMYKAAAAAAAAxwoAAAAAAAAAAAAAxwoAAAAAAADICgAAAAAAAAAAAADICgAAAAAAAMkKAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvQoAAAAAAAC9CgAAAAAAAAAAAAAAAPC/"
				],
				[
					42,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAMkKAAAAAAAAywoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAyQoAAAAAAADJCgAAAAAAAAAAAAAAAPC/"
				],
				[
					44,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAMsKAAAAAAAAzAoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAywoAAAAAAADLCgAAAAAAAAAAAAAAAPC/"
				],
				[
					51,
					1,
					"insert",
					{
						"characters": "\n\nconst"
					},
					"BwAAAMwKAAAAAAAAzQoAAAAAAAAAAAAAzQoAAAAAAADOCgAAAAAAAAAAAADOCgAAAAAAAM8KAAAAAAAAAAAAAM8KAAAAAAAA0AoAAAAAAAAAAAAA0AoAAAAAAADRCgAAAAAAAAAAAADRCgAAAAAAANIKAAAAAAAAAAAAANIKAAAAAAAA0woAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzAoAAAAAAADMCgAAAAAAAAAAAAAAAPC/"
				],
				[
					52,
					1,
					"insert",
					{
						"characters": " team1"
					},
					"BgAAANMKAAAAAAAA1AoAAAAAAAAAAAAA1AoAAAAAAADVCgAAAAAAAAAAAADVCgAAAAAAANYKAAAAAAAAAAAAANYKAAAAAAAA1woAAAAAAAAAAAAA1woAAAAAAADYCgAAAAAAAAAAAADYCgAAAAAAANkKAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0woAAAAAAADTCgAAAAAAAAAAAAAAAPC/"
				],
				[
					53,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAANkKAAAAAAAA2goAAAAAAAAAAAAA2goAAAAAAADbCgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2QoAAAAAAADZCgAAAAAAAAAAAAAAAPC/"
				],
				[
					54,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAANsKAAAAAAAA3AoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2woAAAAAAADbCgAAAAAAAAAAAAAAAPC/"
				],
				[
					55,
					1,
					"insert",
					{
						"characters": "teamFactory."
					},
					"DAAAANwKAAAAAAAA3QoAAAAAAAAAAAAA3QoAAAAAAADeCgAAAAAAAAAAAADeCgAAAAAAAN8KAAAAAAAAAAAAAN8KAAAAAAAA4AoAAAAAAAAAAAAA4AoAAAAAAADhCgAAAAAAAAAAAADhCgAAAAAAAOIKAAAAAAAAAAAAAOIKAAAAAAAA4woAAAAAAAAAAAAA4woAAAAAAADkCgAAAAAAAAAAAADkCgAAAAAAAOUKAAAAAAAAAAAAAOUKAAAAAAAA5goAAAAAAAAAAAAA5goAAAAAAADnCgAAAAAAAAAAAADnCgAAAAAAAOgKAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3AoAAAAAAADcCgAAAAAAAAAAAAAAAPC/"
				],
				[
					56,
					1,
					"insert",
					{
						"characters": "createTeam"
					},
					"CgAAAOgKAAAAAAAA6QoAAAAAAAAAAAAA6QoAAAAAAADqCgAAAAAAAAAAAADqCgAAAAAAAOsKAAAAAAAAAAAAAOsKAAAAAAAA7AoAAAAAAAAAAAAA7AoAAAAAAADtCgAAAAAAAAAAAADtCgAAAAAAAO4KAAAAAAAAAAAAAO4KAAAAAAAA7woAAAAAAAAAAAAA7woAAAAAAADwCgAAAAAAAAAAAADwCgAAAAAAAPEKAAAAAAAAAAAAAPEKAAAAAAAA8goAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA6AoAAAAAAADoCgAAAAAAAAAAAAAAAPC/"
				],
				[
					57,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAPIKAAAAAAAA9AoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA8goAAAAAAADyCgAAAAAAAAAAAAAAAPC/"
				],
				[
					58,
					1,
					"insert",
					{
						"characters": "1"
					},
					"AQAAAPMKAAAAAAAA9AoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA8woAAAAAAADzCgAAAAAAAAAAAAAAAPC/"
				],
				[
					60,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAPUKAAAAAAAA9goAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA9QoAAAAAAAD1CgAAAAAAAAAAAAAAAPC/"
				],
				[
					61,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BgAAAPYKAAAAAAAA9woAAAAAAAAAAAAA9woAAAAAAAD4CgAAAAAAAAAAAAD4CgAAAAAAAPkKAAAAAAAAAAAAAPkKAAAAAAAA+goAAAAAAAAAAAAA+goAAAAAAAD7CgAAAAAAAAAAAAD7CgAAAAAAAPwKAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA9goAAAAAAAD2CgAAAAAAAAAAAAAAAPC/"
				],
				[
					62,
					1,
					"insert",
					{
						"characters": " team2"
					},
					"BgAAAPwKAAAAAAAA/QoAAAAAAAAAAAAA/QoAAAAAAAD+CgAAAAAAAAAAAAD+CgAAAAAAAP8KAAAAAAAAAAAAAP8KAAAAAAAAAAsAAAAAAAAAAAAAAAsAAAAAAAABCwAAAAAAAAAAAAABCwAAAAAAAAILAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA/AoAAAAAAAD8CgAAAAAAAAAAAAAAAPC/"
				],
				[
					63,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAAILAAAAAAAAAwsAAAAAAAAAAAAAAwsAAAAAAAAECwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAAgsAAAAAAAACCwAAAAAAAAAAAAAAAPC/"
				],
				[
					64,
					1,
					"insert",
					{
						"characters": " teamFactory.cr"
					},
					"DwAAAAQLAAAAAAAABQsAAAAAAAAAAAAABQsAAAAAAAAGCwAAAAAAAAAAAAAGCwAAAAAAAAcLAAAAAAAAAAAAAAcLAAAAAAAACAsAAAAAAAAAAAAACAsAAAAAAAAJCwAAAAAAAAAAAAAJCwAAAAAAAAoLAAAAAAAAAAAAAAoLAAAAAAAACwsAAAAAAAAAAAAACwsAAAAAAAAMCwAAAAAAAAAAAAAMCwAAAAAAAA0LAAAAAAAAAAAAAA0LAAAAAAAADgsAAAAAAAAAAAAADgsAAAAAAAAPCwAAAAAAAAAAAAAPCwAAAAAAABALAAAAAAAAAAAAABALAAAAAAAAEQsAAAAAAAAAAAAAEQsAAAAAAAASCwAAAAAAAAAAAAASCwAAAAAAABMLAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAABAsAAAAAAAAECwAAAAAAAAAAAAAAAPC/"
				],
				[
					65,
					1,
					"insert",
					{
						"characters": "eateTeam"
					},
					"CAAAABMLAAAAAAAAFAsAAAAAAAAAAAAAFAsAAAAAAAAVCwAAAAAAAAAAAAAVCwAAAAAAABYLAAAAAAAAAAAAABYLAAAAAAAAFwsAAAAAAAAAAAAAFwsAAAAAAAAYCwAAAAAAAAAAAAAYCwAAAAAAABkLAAAAAAAAAAAAABkLAAAAAAAAGgsAAAAAAAAAAAAAGgsAAAAAAAAbCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAEwsAAAAAAAATCwAAAAAAAAAAAAAAAPC/"
				],
				[
					66,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAABsLAAAAAAAAHQsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGwsAAAAAAAAbCwAAAAAAAAAAAAAAAPC/"
				],
				[
					67,
					1,
					"insert",
					{
						"characters": "2"
					},
					"AQAAABwLAAAAAAAAHQsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHAsAAAAAAAAcCwAAAAAAAAAAAAAAAPC/"
				],
				[
					69,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAB4LAAAAAAAAHwsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHgsAAAAAAAAeCwAAAAAAAAAAAAAAAPC/"
				],
				[
					8,
					1,
					"insert",
					{
						"characters": "team1"
					},
					"BgAAAGYLAAAAAAAAZwsAAAAAAAAAAAAAZwsAAAAAAABnCwAAAAAAABgAAABjcmVhdGVUZWFtKDEpLmNoYXJhY3RlcnNnCwAAAAAAAGgLAAAAAAAAAAAAAGgLAAAAAAAAaQsAAAAAAAAAAAAAaQsAAAAAAABqCwAAAAAAAAAAAABqCwAAAAAAAGsLAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAfgsAAAAAAABmCwAAAAAAAAAAAAAAAPC/"
				],
				[
					12,
					1,
					"left_delete",
					null,
					"GAAAALMLAAAAAAAAswsAAAAAAAABAAAAc7ILAAAAAAAAsgsAAAAAAAABAAAAcrELAAAAAAAAsQsAAAAAAAABAAAAZbALAAAAAAAAsAsAAAAAAAABAAAAdK8LAAAAAAAArwsAAAAAAAABAAAAY64LAAAAAAAArgsAAAAAAAABAAAAYa0LAAAAAAAArQsAAAAAAAABAAAAcqwLAAAAAAAArAsAAAAAAAABAAAAYasLAAAAAAAAqwsAAAAAAAABAAAAaKoLAAAAAAAAqgsAAAAAAAABAAAAY6kLAAAAAAAAqQsAAAAAAAABAAAALqgLAAAAAAAAqAsAAAAAAAABAAAAKacLAAAAAAAApwsAAAAAAAABAAAAMqYLAAAAAAAApgsAAAAAAAABAAAAKKULAAAAAAAApQsAAAAAAAABAAAAbaQLAAAAAAAApAsAAAAAAAABAAAAYaMLAAAAAAAAowsAAAAAAAABAAAAZaILAAAAAAAAogsAAAAAAAABAAAAVKELAAAAAAAAoQsAAAAAAAABAAAAZaALAAAAAAAAoAsAAAAAAAABAAAAdJ8LAAAAAAAAnwsAAAAAAAABAAAAYZ4LAAAAAAAAngsAAAAAAAABAAAAZZ0LAAAAAAAAnQsAAAAAAAABAAAAcpwLAAAAAAAAnAsAAAAAAAABAAAAYw",
					"AQAAAAAAAAABAAAAtAsAAAAAAAC0CwAAAAAAAAAAAAAAAPC/"
				],
				[
					13,
					1,
					"insert",
					{
						"characters": "team2"
					},
					"BQAAAJwLAAAAAAAAnQsAAAAAAAAAAAAAnQsAAAAAAACeCwAAAAAAAAAAAACeCwAAAAAAAJ8LAAAAAAAAAAAAAJ8LAAAAAAAAoAsAAAAAAAAAAAAAoAsAAAAAAAChCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAnAsAAAAAAACcCwAAAAAAAAAAAAAAAPC/"
				],
				[
					16,
					1,
					"left_delete",
					null,
					"BQAAAFILAAAAAAAAUgsAAAAAAAABAAAAMVELAAAAAAAAUQsAAAAAAAABAAAAbVALAAAAAAAAUAsAAAAAAAABAAAAYU8LAAAAAAAATwsAAAAAAAABAAAAZU4LAAAAAAAATgsAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAAUwsAAAAAAABTCwAAAAAAAAAAAAAAAPC/"
				],
				[
					17,
					1,
					"insert",
					{
						"characters": "Ag"
					},
					"AgAAAE4LAAAAAAAATwsAAAAAAAAAAAAATwsAAAAAAABQCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATgsAAAAAAABOCwAAAAAAAAAAAAAAAPC/"
				],
				[
					18,
					1,
					"left_delete",
					null,
					"AgAAAE8LAAAAAAAATwsAAAAAAAABAAAAZ04LAAAAAAAATgsAAAAAAAABAAAAQQ",
					"AQAAAAAAAAABAAAAUAsAAAAAAABQCwAAAAAAAAAAAAAAAPC/"
				],
				[
					19,
					1,
					"insert",
					{
						"characters": "agent1"
					},
					"BgAAAE4LAAAAAAAATwsAAAAAAAAAAAAATwsAAAAAAABQCwAAAAAAAAAAAABQCwAAAAAAAFELAAAAAAAAAAAAAFELAAAAAAAAUgsAAAAAAAAAAAAAUgsAAAAAAABTCwAAAAAAAAAAAABTCwAAAAAAAFQLAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATgsAAAAAAABOCwAAAAAAAAAAAAAAAPC/"
				],
				[
					22,
					1,
					"left_delete",
					null,
					"BAAAAIgLAAAAAAAAiAsAAAAAAAABAAAAbYcLAAAAAAAAhwsAAAAAAAABAAAAYYYLAAAAAAAAhgsAAAAAAAABAAAAZYULAAAAAAAAhQsAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAAiQsAAAAAAACJCwAAAAAAAAAAAAAAAPC/"
				],
				[
					23,
					1,
					"insert",
					{
						"characters": "agent"
					},
					"BQAAAIULAAAAAAAAhgsAAAAAAAAAAAAAhgsAAAAAAACHCwAAAAAAAAAAAACHCwAAAAAAAIgLAAAAAAAAAAAAAIgLAAAAAAAAiQsAAAAAAAAAAAAAiQsAAAAAAACKCwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhQsAAAAAAACFCwAAAAAAAAAAAAAAAPC/"
				],
				[
					26,
					1,
					"left_delete",
					null,
					"BQAAAOAMAAAAAAAA4AwAAAAAAAABAAAAMd8MAAAAAAAA3wwAAAAAAAABAAAAbd4MAAAAAAAA3gwAAAAAAAABAAAAYd0MAAAAAAAA3QwAAAAAAAABAAAAZdwMAAAAAAAA3AwAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAA4QwAAAAAAADhDAAAAAAAAAAAAAAAAPC/"
				],
				[
					27,
					1,
					"insert",
					{
						"characters": "agent1"
					},
					"BgAAANwMAAAAAAAA3QwAAAAAAAAAAAAA3QwAAAAAAADeDAAAAAAAAAAAAADeDAAAAAAAAN8MAAAAAAAAAAAAAN8MAAAAAAAA4AwAAAAAAAAAAAAA4AwAAAAAAADhDAAAAAAAAAAAAADhDAAAAAAAAOIMAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3AwAAAAAAADcDAAAAAAAAAAAAAAAAPC/"
				],
				[
					29,
					1,
					"right_delete",
					null,
					"BAAAAOQMAAAAAAAA5AwAAAAAAAABAAAAdOQMAAAAAAAA5AwAAAAAAAABAAAAZeQMAAAAAAAA5AwAAAAAAAABAAAAYeQMAAAAAAAA5AwAAAAAAAABAAAAbQ",
					"AQAAAAAAAAABAAAA5AwAAAAAAADkDAAAAAAAAAAAAAAAAPC/"
				],
				[
					30,
					1,
					"insert",
					{
						"characters": "agent"
					},
					"BQAAAOQMAAAAAAAA5QwAAAAAAAAAAAAA5QwAAAAAAADmDAAAAAAAAAAAAADmDAAAAAAAAOcMAAAAAAAAAAAAAOcMAAAAAAAA6AwAAAAAAAAAAAAA6AwAAAAAAADpDAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA5AwAAAAAAADkDAAAAAAAAAAAAAAAAPC/"
				],
				[
					9,
					1,
					"insert",
					{
						"characters": "agent1"
					},
					"BwAAAPALAAAAAAAA8QsAAAAAAAAAAAAA8QsAAAAAAADxCwAAAAAAAAUAAAB0ZWFtMfELAAAAAAAA8gsAAAAAAAAAAAAA8gsAAAAAAADzCwAAAAAAAAAAAADzCwAAAAAAAPQLAAAAAAAAAAAAAPQLAAAAAAAA9QsAAAAAAAAAAAAA9QsAAAAAAAD2CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA8AsAAAAAAAD1CwAAAAAAAAAAAAAAAPC/"
				],
				[
					14,
					1,
					"insert",
					{
						"characters": "agent2"
					},
					"BwAAADIMAAAAAAAAMwwAAAAAAAAAAAAAMwwAAAAAAAAzDAAAAAAAAAUAAAB0ZWFtMjMMAAAAAAAANAwAAAAAAAAAAAAANAwAAAAAAAA1DAAAAAAAAAAAAAA1DAAAAAAAADYMAAAAAAAAAAAAADYMAAAAAAAANwwAAAAAAAAAAAAANwwAAAAAAAA4DAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMgwAAAAAAAA3DAAAAAAAAAAAAAAAAPC/"
				],
				[
					24,
					1,
					"insert",
					{
						"characters": "agent1"
					},
					"BwAAALcLAAAAAAAAuAsAAAAAAAAAAAAAuAsAAAAAAAC4CwAAAAAAAAUAAAB0ZWFtMbgLAAAAAAAAuQsAAAAAAAAAAAAAuQsAAAAAAAC6CwAAAAAAAAAAAAC6CwAAAAAAALsLAAAAAAAAAAAAALsLAAAAAAAAvAsAAAAAAAAAAAAAvAsAAAAAAAC9CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtwsAAAAAAAC8CwAAAAAAAAAAAAAAAPC/"
				],
				[
					29,
					1,
					"insert",
					{
						"characters": "agent1"
					},
					"BwAAAPoLAAAAAAAA+wsAAAAAAAAAAAAA+wsAAAAAAAD7CwAAAAAAAAUAAAB0ZWFtMvsLAAAAAAAA/AsAAAAAAAAAAAAA/AsAAAAAAAD9CwAAAAAAAAAAAAD9CwAAAAAAAP4LAAAAAAAAAAAAAP4LAAAAAAAA/wsAAAAAAAAAAAAA/wsAAAAAAAAADAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA+gsAAAAAAAD/CwAAAAAAAAAAAAAAAPC/"
				],
				[
					30,
					1,
					"left_delete",
					null,
					"AQAAAP8LAAAAAAAA/wsAAAAAAAABAAAAMQ",
					"AQAAAAAAAAABAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAPC/"
				],
				[
					31,
					1,
					"insert",
					{
						"characters": "2"
					},
					"AQAAAP8LAAAAAAAAAAwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA/wsAAAAAAAD/CwAAAAAAAAAAAAAAAPC/"
				],
				[
					38,
					1,
					"insert",
					{
						"characters": ".characters"
					},
					"CwAAAGwLAAAAAAAAbQsAAAAAAAAAAAAAbQsAAAAAAABuCwAAAAAAAAAAAABuCwAAAAAAAG8LAAAAAAAAAAAAAG8LAAAAAAAAcAsAAAAAAAAAAAAAcAsAAAAAAABxCwAAAAAAAAAAAABxCwAAAAAAAHILAAAAAAAAAAAAAHILAAAAAAAAcwsAAAAAAAAAAAAAcwsAAAAAAAB0CwAAAAAAAAAAAAB0CwAAAAAAAHULAAAAAAAAAAAAAHULAAAAAAAAdgsAAAAAAAAAAAAAdgsAAAAAAAB3CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbAsAAAAAAABsCwAAAAAAAAAAAAAAAPC/"
				],
				[
					42,
					1,
					"insert",
					{
						"characters": ".characters"
					},
					"CwAAAK4LAAAAAAAArwsAAAAAAAAAAAAArwsAAAAAAACwCwAAAAAAAAAAAACwCwAAAAAAALELAAAAAAAAAAAAALELAAAAAAAAsgsAAAAAAAAAAAAAsgsAAAAAAACzCwAAAAAAAAAAAACzCwAAAAAAALQLAAAAAAAAAAAAALQLAAAAAAAAtQsAAAAAAAAAAAAAtQsAAAAAAAC2CwAAAAAAAAAAAAC2CwAAAAAAALcLAAAAAAAAAAAAALcLAAAAAAAAuAsAAAAAAAAAAAAAuAsAAAAAAAC5CwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAArgsAAAAAAACuCwAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "agents/AIPlayer.js",
			"settings":
			{
				"buffer_size": 7897,
				"line_ending": "Windows"
			}
		},
		{
			"file": "core/Game.js",
			"settings":
			{
				"buffer_size": 47243,
				"line_ending": "Windows"
			}
		},
		{
			"file": "agents/AIDirector.js",
			"settings":
			{
				"buffer_size": 19990,
				"line_ending": "Windows"
			}
		},
		{
			"contents": "const Character = require('Character'); // Assuming Character is in a separate file\nconst Constants = require('../utils/Constants');   // Assuming Constants is in a separate file\n\nclass TeamFactory {\n  /**\n   * Creates a team of characters.\n   * @param {number} playerNumber The player number for the team.\n   * @returns {object} An object containing the team's characters.\n   */\n  createTeam(playerNumber) {\n    return {\n      characters: [\n        new Character(playerNumber, \"warrior\", {\n          HP: 100,\n          Attack: 80,\n          Defense: 80,\n          MagicAttack: 20,\n          MagicDefense: 20,\n          Speed: 50,\n          Luck: 35\n        }, [{\n          type: 'attack',\n          scalar: Constants.SINGLE_TARGET_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'multi_attack',\n          scalar: Constants.MULTI_TARGET_SCALAR,\n          multiTarget: true\n        }, {\n          type: 'defend',\n          scalar: 0,\n          multiTarget: false\n        }]),\n        new Character(playerNumber, \"mage\", {\n          HP: 100,\n          Attack: 20,\n          Defense: 20,\n          MagicAttack: 80,\n          MagicDefense: 80,\n          Speed: 50,\n          Luck: 35\n        }, [{\n          type: 'magic_attack',\n          scalar: Constants.SINGLE_TARGET_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'multi_magic_attack',\n          scalar: Constants.MULTI_TARGET_SCALAR,\n          multiTarget: true\n        }, {\n          type: 'defend',\n          scalar: 0,\n          multiTarget: false\n        }]),\n        new Character(playerNumber, \"priest\", {\n          HP: 75,\n          Attack: 20,\n          Defense: 80,\n          MagicAttack: 20,\n          MagicDefense: 80,\n          Speed: 35,\n          Luck: 35\n        }, [{\n          type: 'heal',\n          scalar: Constants.HEAL_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'multi_heal',\n          scalar: Constants.MULTI_HEAL_SCALAR,\n          multiTarget: true\n        }, {\n          type: 'attack',\n          scalar: Constants.SINGLE_TARGET_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'magic_attack',\n          scalar: Constants.SINGLE_TARGET_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'defend',\n          scalar: 0,\n          multiTarget: false\n        }]),\n        new Character(playerNumber, \"rogue\", {\n          HP: 50,\n          Attack: 35,\n          Defense: 35,\n          MagicAttack: 35,\n          MagicDefense: 35,\n          Speed: 80,\n          Luck: 80\n        }, [{\n          type: 'attack',\n          scalar: Constants.SINGLE_TARGET_SCALAR,\n          multiTarget: false\n        }, {\n          type: 'multi_attack',\n          scalar: Constants.MULTI_TARGET_SCALAR,\n          multiTarget: true\n        }, {\n          type: 'defend',\n          scalar: 0,\n          multiTarget: false\n        }])\n      ]\n    };\n  }\n}\n\nmodule.exports = TeamFactory; // Optionally export the class",
			"file": "core/TeamFactory.js",
			"file_size": 3069,
			"file_write_time": 133868126003631283,
			"redo_stack":
			[
				[
					5,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAAKQDAAAAAAAApAMAAAAAAAAKAAAAICAgICAgICAgIKMDAAAAAAAAowMAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAArgMAAAAAAACuAwAAAAAAAAAAAAAAAPC/"
				],
				[
					71,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAABwAAAAAAAAAHAAAAAAAAAABAAAALxsAAAAAAAAAGwAAAAAAAAABAAAALg",
					"AQAAAAAAAAABAAAAHQAAAAAAAAAdAAAAAAAAAAAAAAAAAPC/"
				]
			],
			"settings":
			{
				"buffer_size": 2958,
				"encoding": "UTF-8",
				"line_ending": "Windows",
				"name": "import { Character } from './Character'; // Assumi"
			},
			"undo_stack":
			[
				[
					5,
					1,
					"paste",
					null,
					"AQAAAAAAAAAAAAAAhgsAAAAAAAAAAAAA",
					"AwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwvw"
				],
				[
					8,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAAHIAAAAAAAAAcwAAAAAAAAAAAAAAcwAAAAAAAAB0AAAAAAAAAAAAAAA",
					"AwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8AAAAAAQAAAHIAAAAAAAAAcgAAAAAAAAAAAAAAAADwvw"
				],
				[
					9,
					1,
					"insert",
					{
						"characters": "U"
					},
					"AQAAAHQAAAAAAAAAdQAAAAAAAAAAAAAA",
					"AwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8AAAAAAQAAAHQAAAAAAAAAdAAAAAAAAAAAAAAAAADwvw"
				],
				[
					10,
					1,
					"left_delete",
					null,
					"AQAAAHQAAAAAAAAAdAAAAAAAAAABAAAAVQ",
					"AwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8AAAAAAQAAAHUAAAAAAAAAdQAAAAAAAAAAAAAAAADwvw"
				],
				[
					11,
					1,
					"insert",
					{
						"characters": "utils"
					},
					"BQAAAHQAAAAAAAAAdQAAAAAAAAAAAAAAdQAAAAAAAAB2AAAAAAAAAAAAAAB2AAAAAAAAAHcAAAAAAAAAAAAAAHcAAAAAAAAAeAAAAAAAAAAAAAAAeAAAAAAAAAB5AAAAAAAAAAAAAAA",
					"AwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8AAAAAAQAAAHQAAAAAAAAAdAAAAAAAAAAAAAAAAADwvw"
				],
				[
					5,
					2,
					"left_delete",
					null,
					"AgAAAFoLAAAAAAAAWgsAAAAAAAAHAAAAZGVmYXVsdFkLAAAAAAAAWQsAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABaCwAAAAAAAGELAAAAAAAAAAAAAAAA8L8"
				],
				[
					6,
					1,
					"insert",
					{
						"characters": "."
					},
					"AQAAAFkLAAAAAAAAWgsAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABZCwAAAAAAAFkLAAAAAAAAAAAAAAAA8L8"
				],
				[
					7,
					7,
					"left_delete",
					null,
					"BwAAAFkLAAAAAAAAWQsAAAAAAAABAAAALlgLAAAAAAAAWAsAAAAAAAABAAAAdFcLAAAAAAAAVwsAAAAAAAABAAAAclYLAAAAAAAAVgsAAAAAAAABAAAAb1ULAAAAAAAAVQsAAAAAAAABAAAAcFQLAAAAAAAAVAsAAAAAAAABAAAAeFMLAAAAAAAAUwsAAAAAAAABAAAAZQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABaCwAAAAAAAFoLAAAAAAAAAAAAAAAA8L8"
				],
				[
					8,
					1,
					"insert",
					{
						"characters": "module.export"
					},
					"DQAAAFMLAAAAAAAAVAsAAAAAAAAAAAAAVAsAAAAAAABVCwAAAAAAAAAAAABVCwAAAAAAAFYLAAAAAAAAAAAAAFYLAAAAAAAAVwsAAAAAAAAAAAAAVwsAAAAAAABYCwAAAAAAAAAAAABYCwAAAAAAAFkLAAAAAAAAAAAAAFkLAAAAAAAAWgsAAAAAAAAAAAAAWgsAAAAAAABbCwAAAAAAAAAAAABbCwAAAAAAAFwLAAAAAAAAAAAAAFwLAAAAAAAAXQsAAAAAAAAAAAAAXQsAAAAAAABeCwAAAAAAAAAAAABeCwAAAAAAAF8LAAAAAAAAAAAAAF8LAAAAAAAAYAsAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABTCwAAAAAAAFMLAAAAAAAAAAAAAAAA8L8"
				],
				[
					9,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAAGALAAAAAAAAYQsAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABgCwAAAAAAAGALAAAAAAAAAAAAAAAA8L8"
				],
				[
					10,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAGELAAAAAAAAYgsAAAAAAAAAAAAAYgsAAAAAAABjCwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABhCwAAAAAAAGELAAAAAAAAAAAAAAAA8L8"
				],
				[
					13,
					2,
					"left_delete",
					null,
					"AgAAABwAAAAAAAAAHAAAAAAAAAABAAAALxsAAAAAAAAAGwAAAAAAAAABAAAALg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAdAAAAAAAAAB0AAAAAAAAAAAAAAAAA8L8"
				],
				[
					16,
					2,
					"left_delete",
					null,
					"AgAAAAgAAAAAAAAACAAAAAAAAAABAAAAIAcAAAAAAAAABwAAAAAAAAABAAAAew",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAJAAAAAAAAAAkAAAAAAAAAAAAAAAAA8L8"
				],
				[
					18,
					2,
					"left_delete",
					null,
					"AgAAABEAAAAAAAAAEQAAAAAAAAABAAAAfRAAAAAAAAAAEAAAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAASAAAAAAAAABIAAAAAAAAAAAAAAAAA8L8"
				],
				[
					22,
					1,
					"insert",
					{
						"characters": "./"
					},
					"AgAAABcAAAAAAAAAGAAAAAAAAAAAAAAAGAAAAAAAAAAZAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAXAAAAAAAAABcAAAAAAAAAAAAAAAAA8L8"
				],
				[
					24,
					4,
					"left_delete",
					null,
					"BAAAABQAAAAAAAAAFAAAAAAAAAABAAAAbRMAAAAAAAAAEwAAAAAAAAABAAAAbxIAAAAAAAAAEgAAAAAAAAABAAAAchEAAAAAAAAAEQAAAAAAAAABAAAAZg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAVAAAAAAAAABUAAAAAAAAAAAAAAAAA8L8"
				],
				[
					25,
					1,
					"insert",
					{
						"characters": "=re"
					},
					"AwAAABEAAAAAAAAAEgAAAAAAAAAAAAAAEgAAAAAAAAATAAAAAAAAAAAAAAATAAAAAAAAABQAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAARAAAAAAAAABEAAAAAAAAAAAAAAAAA8L8"
				],
				[
					26,
					2,
					"left_delete",
					null,
					"AgAAABMAAAAAAAAAEwAAAAAAAAABAAAAZRIAAAAAAAAAEgAAAAAAAAABAAAAcg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAA8L8"
				],
				[
					27,
					1,
					"insert",
					{
						"characters": " require"
					},
					"CAAAABIAAAAAAAAAEwAAAAAAAAAAAAAAEwAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAABUAAAAAAAAAAAAAABUAAAAAAAAAFgAAAAAAAAAAAAAAFgAAAAAAAAAXAAAAAAAAAAAAAAAXAAAAAAAAABgAAAAAAAAAAAAAABgAAAAAAAAAGQAAAAAAAAAAAAAAGQAAAAAAAAAaAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAASAAAAAAAAABIAAAAAAAAAAAAAAAAA8L8"
				],
				[
					28,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAABoAAAAAAAAAHAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAaAAAAAAAAABoAAAAAAAAAAAAAAAAA8L8"
				],
				[
					30,
					1,
					"left_delete",
					null,
					"AQAAABsAAAAAAAAAGwAAAAAAAAABAAAAKQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAcAAAAAAAAABwAAAAAAAAAAAAAAAAA8L8"
				],
				[
					32,
					1,
					"left_delete",
					null,
					"AQAAABsAAAAAAAAAGwAAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAcAAAAAAAAABwAAAAAAAAAAAAAAAAA8L8"
				],
				[
					41,
					1,
					"insert",
					{
						"characters": "const"
					},
					"BgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAYAAABpbXBvcnQBAAAAAAAAAAIAAAAAAAAAAAAAAAIAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAUAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAAA8L8"
				],
				[
					46,
					11,
					"left_delete",
					null,
					"CwAAAF8AAAAAAAAAXwAAAAAAAAABAAAAc14AAAAAAAAAXgAAAAAAAAABAAAAYV0AAAAAAAAAXQAAAAAAAAABAAAAIFwAAAAAAAAAXAAAAAAAAAABAAAAKlsAAAAAAAAAWwAAAAAAAAABAAAAIFoAAAAAAAAAWgAAAAAAAAABAAAAdFkAAAAAAAAAWQAAAAAAAAABAAAAclgAAAAAAAAAWAAAAAAAAAABAAAAb1cAAAAAAAAAVwAAAAAAAAABAAAAcFYAAAAAAAAAVgAAAAAAAAABAAAAbVUAAAAAAAAAVQAAAAAAAAABAAAAaQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAA8L8"
				],
				[
					47,
					1,
					"insert",
					{
						"characters": "const"
					},
					"BQAAAFUAAAAAAAAAVgAAAAAAAAAAAAAAVgAAAAAAAABXAAAAAAAAAAAAAABXAAAAAAAAAFgAAAAAAAAAAAAAAFgAAAAAAAAAWQAAAAAAAAAAAAAAWQAAAAAAAABaAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABVAAAAAAAAAFUAAAAAAAAAAAAAAAAA8L8"
				],
				[
					50,
					4,
					"left_delete",
					null,
					"BAAAAGgAAAAAAAAAaAAAAAAAAAABAAAAbWcAAAAAAAAAZwAAAAAAAAABAAAAb2YAAAAAAAAAZgAAAAAAAAABAAAAcmUAAAAAAAAAZQAAAAAAAAABAAAAZg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABpAAAAAAAAAGkAAAAAAAAAAAAAAAAA8L8"
				],
				[
					51,
					1,
					"insert",
					{
						"characters": "="
					},
					"AQAAAGUAAAAAAAAAZgAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABlAAAAAAAAAGUAAAAAAAAAAAAAAAAA8L8"
				],
				[
					52,
					1,
					"insert",
					{
						"characters": " rquire"
					},
					"BwAAAGYAAAAAAAAAZwAAAAAAAAAAAAAAZwAAAAAAAABoAAAAAAAAAAAAAABoAAAAAAAAAGkAAAAAAAAAAAAAAGkAAAAAAAAAagAAAAAAAAAAAAAAagAAAAAAAABrAAAAAAAAAAAAAABrAAAAAAAAAGwAAAAAAAAAAAAAAGwAAAAAAAAAbQAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABmAAAAAAAAAGYAAAAAAAAAAAAAAAAA8L8"
				],
				[
					53,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAG0AAAAAAAAAbwAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABtAAAAAAAAAG0AAAAAAAAAAAAAAAAA8L8"
				],
				[
					55,
					1,
					"left_delete",
					null,
					"AQAAAG4AAAAAAAAAbgAAAAAAAAABAAAAKQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABvAAAAAAAAAG8AAAAAAAAAAAAAAAAA8L8"
				],
				[
					57,
					1,
					"left_delete",
					null,
					"AQAAAG4AAAAAAAAAbgAAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABvAAAAAAAAAG8AAAAAAAAAAAAAAAAA8L8"
				],
				[
					60,
					1,
					"insert",
					{
						"characters": ")"
					},
					"AQAAAIIAAAAAAAAAgwAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACCAAAAAAAAAIIAAAAAAAAAAAAAAAAA8L8"
				],
				[
					63,
					1,
					"insert",
					{
						"characters": ")"
					},
					"AQAAACcAAAAAAAAAKAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAnAAAAAAAAACcAAAAAAAAAAAAAAAAA8L8"
				],
				[
					66,
					1,
					"insert",
					{
						"characters": "e"
					},
					"AQAAAGkAAAAAAAAAagAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABpAAAAAAAAAGkAAAAAAAAAAAAAAAAA8L8"
				],
				[
					70,
					2,
					"left_delete",
					null,
					"AgAAABwAAAAAAAAAHAAAAAAAAAABAAAALxsAAAAAAAAAGwAAAAAAAAABAAAALg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAdAAAAAAAAAB0AAAAAAAAAAAAAAAAA8L8"
				]
			]
		}
	],
	"build_system": "",
	"build_system_choices":
	[
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"Package Control: instal",
				"Package Control: Install Package"
			],
			[
				"Package Control: install",
				"Package Control: Install Package"
			],
			[
				"Package Control: inst",
				"Package Control: Install Package"
			],
			[
				"Package Control: ins",
				"Package Control: Install Package"
			],
			[
				"Package Control: insta",
				"Package Control: Install Package"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 0.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/C/Users/samue/Documents/Github/FighterDDA",
		"/C/Users/samue/Documents/Github/FighterDDA/agents",
		"/C/Users/samue/Documents/Github/FighterDDA/core"
	],
	"file_history":
	[
		"/C/Users/samue/Documents/Github/FighterDDA/utils/Constants.js",
		"/C/Users/samue/Documents/Github/FighterDDA/utils/RNG.js",
		"/C/Users/samue/Documents/Github/FighterDDA/agents/AIPlayer.js",
		"/C/Users/samue/Documents/Github/FighterDDA/core/Character.js",
		"/C/Users/samue/Documents/Github/FighterDDA/core/Game.js",
		"/C/Users/samue/Documents/Github/FighterDDA/agents/AIDirector.js",
		"/C/Users/samue/Documents/Github/FighterDDA/utils/Utils.js",
		"/C/Users/samue/Documents/Github/FighterDDA/RNG.js",
		"/C/Users/samue/OneDrive/Desktop/fighterAGB_design_doc.txt",
		"/C/Users/samue/OneDrive/Desktop/simulation_log_1741831124061.json",
		"/C/Users/samue/OneDrive/Desktop/simulation_log_1741832116942.json",
		"/C/Users/samue/OneDrive/Desktop/simulation_log_1741833540357.json",
		"/C/Users/samue/OneDrive/Desktop/simulation_log_1741833605175.json",
		"/C/Users/samue/OneDrive/Documents/ToG/Structured_One_Shot_Prompt.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Unstructured_Multi_Shot_Prompt.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Unstructured_Zero_Shot_Prompt.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Output_Format.txt",
		"/C/Users/samue/AppData/Roaming/Sublime Text/Packages/User/JavaScript.sublime-build",
		"/C/Users/samue/OneDrive/Desktop/simulation_log_1741828944346.json",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/color_mapping.json",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/sankey_data.csv",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/sankey_data.json",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/convert_sankey_data.py",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/balance_sankey.py",
		"/C/Users/samue/OneDrive/Documents/GitHub/BalanceTaxonomy/balance_taxonomy_data.json",
		"/C/Users/samue/OneDrive/Documents/ToG/Structured_One_Shot_Output.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Unstructured_Multi_Shot_Output.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Unstructured_Zero_Shot_Output.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Academical_2.0_Output.txt",
		"/C/Users/samue/OneDrive/Documents/ToG/Academical_2.0_Prompt.txt",
		"/C/Users/samue/OneDrive/Documents/GitHub/TermCountUtility/terms.txt",
		"/C/Users/samue/OneDrive/Documents/GitHub/TermCountUtility/CountTermFrequency.py",
		"/C/Users/samue/OneDrive/Desktop/IntoTheBlue",
		"/C/Users/samue/OneDrive/Documents/ToG/Human_Authored_Tree.txt",
		"/C/Users/samue/OneDrive/Documents/GitHub/LLMInteractiveNarrative/SemanticCorrectRunningAvg"
	],
	"find":
	{
		"height": 39.3333333333
	},
	"find_in_files":
	{
		"height": 102.0,
		"where_history":
		[
			"<current file>",
			""
		]
	},
	"find_state":
	{
		"case_sensitive": false,
		"find_history":
		[
			"Math.random()",
			"Math.Rand",
			"getRandom",
			"RNG",
			"seed",
			"RNG.next",
			"RNG",
			"AI_Director",
			"Math.random()",
			"HEAL_SCALAR",
			"MULTI_HEAL_SCALAR",
			"MULTI_TARGET_SCALAR",
			"SINGLE_TARGET_SCALAR",
			"HEAL_SCALAR",
			"MULTI_HEAL_SCALAR",
			"SPEED_SCALAR",
			"heal_scalar",
			"single_target_Scalar",
			"multi_target_Scalar",
			"SINGLE_TARGET_SCALAR",
			"MULTI_TARGET_SCALAR",
			"SPEED_SCALAR",
			"MULTI_Constants.HEAL_SCALAR",
			"MULTI_HEAL_SCALAR",
			"HEAL_SCALAR",
			"SINGLE_TARGET_SCALAR",
			"MULTI_TARGET_SCALAR",
			"this.safeDivide(",
			"this.map(",
			";\n",
			"heal",
			"\"queueLength\":",
			"24",
			"multi",
			"ff7f0e",
			"]",
			"[",
			"relationship_threshold:",
			"relationship_stat_current:",
			"relationship_symbol:",
			"relationship_stat_change:",
			"relationship_stat_current:",
			"relationship_stat:",
			"character2:",
			"character1:",
			"attribute_change:",
			"attribute:",
			"character:",
			"relationship_symbol",
			"relationship_stat_change",
			"relationship_stat_change:",
			"relationship_stat_current:",
			"relationship_threshold:",
			"relationship_stat_current:",
			"relationship_symbol:",
			"relationship_stat:",
			"character2:",
			"character1:",
			"attribute_change:",
			"attribute:",
			"character:",
			"id:",
			"\"stat_changes\" {",
			"preconditions:",
			"next_id:",
			"choice_content:",
			"choices:",
			"attributes:",
			"relationships:",
			"stat_changes {",
			"stat_changes:",
			"dialogue:",
			"dialogue_summary:",
			"player_character:",
			"speaking_character:",
			"prev_id:",
			"\"prev_id\"",
			"22"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": false,
		"replace_history":
		[
			"RNG.next()",
			"AIDirector",
			"RNG.next()",
			"Constants.MULTI_TARGET_SCALAR",
			"Constants.SINGLE_TARGET_SCALAR",
			"Constants.HEAL_SCALAR",
			"Constants.MULTI_HEAL_SCALAR",
			"Constants.SPEED_SCALAR",
			"Constants.SINGLE_TARGET_SCALAR",
			"Constants.MULTI_TARGET_SCALAR",
			"Constants.SPEED_SCALAR",
			"Constants.MULTI_HEAL_SCALAR",
			"Constants.HEAL_SCALAR",
			"Constants.HEAL_TARGET_SCALAR",
			"Constants.HEAL_SCALAR",
			"Constants.SINGLE_TARGET_SCALAR",
			"Constants.MULTI_TARGET_SCALAR",
			"Utils.safeDivide(",
			"Utils.map(",
			"],",
			"",
			"\"relationship_threshold\":",
			"\"relationship_stat_current\":",
			"\"relationship_symbol\":",
			"\"relationship_stat_change\":",
			"\"relationship_stat_current\":",
			"\"relationship_stat\":",
			"\"character2\":",
			"\"character1\":",
			"\"attribute_change\":",
			"\"attribute\":",
			"\"character\":",
			"\"relationship_stat_change\":",
			"\"relationship_threshold\":",
			"\"relationship_stat_current\":",
			"\"relationship_symbol\":",
			"\"relationship_stat\":",
			"\"character2\":",
			"\"character1\":",
			"\"attribute_change\":",
			"\"attribute\":",
			"\"character\":",
			"\"id\":",
			"\"stat_changes\": {",
			"\"preconditions\":",
			"\"next_id\":",
			"\"choice_content\":",
			"\"choices\":",
			"\"attributes\":",
			"\"relationships\":",
			"\"stat_changes\" {",
			"\"stat_changes\":",
			"\"dialogue\":",
			"\"dialogue_summary\":",
			"\"player_character\":",
			"\"speaking_character\":",
			"\"prev_id\":"
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"file": "fighterAGB_headless_sim.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 3499,
						"regions":
						{
						},
						"selection":
						[
							[
								795,
								795
							]
						],
						"settings":
						{
							"syntax": "Packages/JavaScript/JavaScript.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 14.0,
						"zoom_level": 1.0
					},
					"stack_index": 3,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 1,
					"file": "agents/AIPlayer.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 7897,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"syntax": "Packages/JavaScript/JavaScript.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 2,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 2,
					"file": "core/Game.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 47243,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"syntax": "Packages/JavaScript/JavaScript.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 3,
					"file": "agents/AIDirector.js",
					"selected": true,
					"semi_transient": true,
					"settings":
					{
						"buffer_size": 19990,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"syntax": "Packages/JavaScript/JavaScript.sublime-syntax",
							"tab_size": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		},
		{
			"sheets":
			[
				{
					"buffer": 4,
					"file": "core/TeamFactory.js",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 2958,
						"regions":
						{
						},
						"selection":
						[
							[
								27,
								27
							]
						],
						"settings":
						{
							"auto_name": "import { Character } from './Character'; // Assumi",
							"syntax": "Packages/JavaScript/JavaScript.sublime-syntax",
							"tab_size": 2,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 27.3333333333
	},
	"input":
	{
		"height": 39.3333333333
	},
	"layout":
	{
		"cells":
		[
			[
				0,
				0,
				1,
				1
			],
			[
				1,
				0,
				2,
				1
			]
		],
		"cols":
		[
			0.0,
			0.543072132849,
			1.0
		],
		"rows":
		[
			0.0,
			1.0
		]
	},
	"menu_visible": true,
	"output.exec":
	{
		"height": 545.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"output.nodejs":
	{
		"height": 132.0
	},
	"pinned_build_system": "Packages/Nodejs/Nodejs.sublime-build",
	"project": "FighterAGB_Headless_Sim.sublime-project",
	"replace":
	{
		"height": 50.6666666667
	},
	"save_all_on_build": true,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"select_symbol":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
		],
		"width": 0.0
	},
	"selected_group": 1,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 316.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
